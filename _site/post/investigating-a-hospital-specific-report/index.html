<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Alex Zajichek">
<meta name="dcterms.date" content="2025-12-26">
<meta name="description" content="Analysis strategies to gain insight into HRRP program results">

<title>Investigating a Hospital-Specific Report (HSR) – Zajichek Stats</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-30fa53df0fffa09c950be6b35001b9c1.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-9MW3W3RQD9"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-9MW3W3RQD9', { 'anonymize_ip': true});
</script>
<script src="../../site_libs/core-js-2.5.3/shim.min.js"></script>
<script src="../../site_libs/react-18.2.0/react.min.js"></script>
<script src="../../site_libs/react-18.2.0/react-dom.min.js"></script>
<script src="../../site_libs/reactwidget-2.0.0/react-tools.umd.cjs"></script>
<link href="../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="../../site_libs/reactable-0.4.4/reactable.css" rel="stylesheet">
<script src="../../site_libs/reactable-binding-0.4.4/reactable.js"></script>


<meta property="og:title" content="Investigating a Hospital-Specific Report (HSR) – Zajichek Stats">
<meta property="og:description" content="Analysis strategies to gain insight into HRRP program results">
<meta property="og:image" content="https://www.zajichekstats.com/post/investigating-a-hospital-specific-report/feature.png">
<meta property="og:site_name" content="Zajichek Stats">
<meta property="og:image:height" content="1254">
<meta property="og:image:width" content="1778">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../logo.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../presentations.html"> 
<span class="menu-text">Projects &amp; Presentations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../publications.html"> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.centralstatz.com/"> 
<span class="menu-text">Consultancy</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://dashboard.mailerlite.com/forms/1517199/154300987644839168/share"> 
<span class="menu-text">Subscribe</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:alex@centralstatz.com"> <i class="bi bi-envelope" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/alexzajichek"> <i class="bi bi-linkedin" role="img" aria-label="LinkedIn">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/zajichek"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.youtube.com/@centralstatz"> <i class="bi bi-youtube" role="img" aria-label="YouTube">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-toolbox" id="toc-the-toolbox" class="nav-link active" data-scroll-target="#the-toolbox">The Toolbox</a>
  <ul class="collapse">
  <li><a href="#mock-reports" id="toc-mock-reports" class="nav-link" data-scroll-target="#mock-reports">0. Mock Reports</a></li>
  <li><a href="#programsummary" id="toc-programsummary" class="nav-link" data-scroll-target="#programsummary">1. Program Summary</a></li>
  <li><a href="#cohortsummary" id="toc-cohortsummary" class="nav-link" data-scroll-target="#cohortsummary">2. Cohort Summary</a></li>
  <li><a href="#discharges" id="toc-discharges" class="nav-link" data-scroll-target="#discharges">3. Discharges</a>
  <ul class="collapse">
  <li><a href="#eligible-cases" id="toc-eligible-cases" class="nav-link" data-scroll-target="#eligible-cases">Eligible Cases</a></li>
  <li><a href="#risk-factors" id="toc-risk-factors" class="nav-link" data-scroll-target="#risk-factors">Risk Factors</a></li>
  </ul></li>
  <li><a href="#modelcoefficients" id="toc-modelcoefficients" class="nav-link" data-scroll-target="#modelcoefficients">4. Model Coefficients</a>
  <ul class="collapse">
  <li><a href="#intercept-terms" id="toc-intercept-terms" class="nav-link" data-scroll-target="#intercept-terms">Intercept Terms</a></li>
  </ul></li>
  <li><a href="#readmission-risks" id="toc-readmission-risks" class="nav-link" data-scroll-target="#readmission-risks">5. Readmission Risks</a></li>
  <li><a href="#dual-stays" id="toc-dual-stays" class="nav-link" data-scroll-target="#dual-stays">6. Dual Stays</a></li>
  </ul></li>
  <li><a href="#analysisstrategies" id="toc-analysisstrategies" class="nav-link" data-scroll-target="#analysisstrategies">Analysis Strategies</a>
  <ul class="collapse">
  <li><a href="#validating-the-penalty-calculation" id="toc-validating-the-penalty-calculation" class="nav-link" data-scroll-target="#validating-the-penalty-calculation">1. Validating the Penalty Calculation</a>
  <ul class="collapse">
  <li><a href="#i.-extract-discharges" id="toc-i.-extract-discharges" class="nav-link" data-scroll-target="#i.-extract-discharges">i. Extract Discharges</a></li>
  <li><a href="#riskfactors" id="toc-riskfactors" class="nav-link" data-scroll-target="#riskfactors">ii. Extract Risk Factors</a></li>
  <li><a href="#individualreadmissionrisk" id="toc-individualreadmissionrisk" class="nav-link" data-scroll-target="#individualreadmissionrisk">iii. Compute Individual Readmission Risks</a></li>
  <li><a href="#iv.-compute-cohort-level-results" id="toc-iv.-compute-cohort-level-results" class="nav-link" data-scroll-target="#iv.-compute-cohort-level-results">iv. Compute Cohort-Level Results</a></li>
  <li><a href="#v.-aggregate-to-the-program-result" id="toc-v.-aggregate-to-the-program-result" class="nav-link" data-scroll-target="#v.-aggregate-to-the-program-result">v. Aggregate to the Program Result</a></li>
  <li><a href="#key-observations" id="toc-key-observations" class="nav-link" data-scroll-target="#key-observations">Key Observations</a></li>
  </ul></li>
  <li><a href="#understanding-model-weights" id="toc-understanding-model-weights" class="nav-link" data-scroll-target="#understanding-model-weights">2. Understanding Model Weights</a>
  <ul class="collapse">
  <li><a href="#what-do-they-mean" id="toc-what-do-they-mean" class="nav-link" data-scroll-target="#what-do-they-mean">What Do They Mean?</a></li>
  <li><a href="#risk-factor-prevalence" id="toc-risk-factor-prevalence" class="nav-link" data-scroll-target="#risk-factor-prevalence">Risk Factor Prevalence</a></li>
  <li><a href="#net-factor-influence" id="toc-net-factor-influence" class="nav-link" data-scroll-target="#net-factor-influence">Net Factor Influence</a></li>
  </ul></li>
  <li><a href="#other-analyses" id="toc-other-analyses" class="nav-link" data-scroll-target="#other-analyses">3. Other Analyses</a>
  <ul class="collapse">
  <li><a href="#diagnosis-comparison" id="toc-diagnosis-comparison" class="nav-link" data-scroll-target="#diagnosis-comparison">Diagnosis Comparison</a></li>
  <li><a href="#outside-hospital-readmissions" id="toc-outside-hospital-readmissions" class="nav-link" data-scroll-target="#outside-hospital-readmissions">Outside Hospital Readmissions</a></li>
  <li><a href="#benchmarking-with-other-hospitals" id="toc-benchmarking-with-other-hospitals" class="nav-link" data-scroll-target="#benchmarking-with-other-hospitals">Benchmarking With Other Hospitals</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Investigating a Hospital-Specific Report (HSR)</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">Software Development</div>
    <div class="quarto-category">Healthcare</div>
  </div>
  </div>

<div>
  <div class="description">
    Analysis strategies to gain insight into HRRP program results
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Alex Zajichek </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 26, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><em>This article is a copy of the <a href="https://centralstatz.github.io/readmit/index.html"><code>readmit</code></a> package tutorial. See it on the package website <a href="https://centralstatz.github.io/readmit/articles/investigating-an-hsr.html">here</a>.</em></p>
<p><em><strong>Note</strong>: CMS changed the format of Hospital-Specific Reports (HSRs) for FY2026 (see <a href="https://qualitynet.cms.gov/inpatient/hrrp/reports#tab2">here</a>). The current HSR functions support Excel-based formats through FY2025. However, analysis strategies are still relevant.</em></p>
<p>As part of the <a href="https://www.cms.gov/medicare/payment/prospective-payment-systems/acute-inpatient-pps/hospital-readmissions-reduction-program-hrrp">Hospital Readmissions Reduction Program (HRRP)</a>, the <a href="https://www.cms.gov/">Centers for Medicare &amp; Medicaid Services (CMS)</a> provides a detailed, annual program summary report (called the <a href="https://qualitynet.cms.gov/inpatient/hrrp/reports">Hospital-Specific Report (HSR)</a>) to hospitals that includes details on the penalty calculation for the upcoming fiscal year, such as discharge-level data, dually-eligible discharge lists, cohort-level rollup, and the penalty amount. There is a defined <a href="https://qualitynet.cms.gov/inpatient/hrrp/resources#tab1:~:text=FY%202026%20Hospital%20Readmissions%20Reduction%20Program%20Key%20Dates%20(08/11/25)">review and correction period</a> in which hospitals can use these reports to ensure the penalty being enforced by CMS is accurate. It occurs approximately 1 month before the new fiscal year, thus it is a time-critical event (see historical date ranges below for reference with the built-in package datasets):</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract date ranges</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>readmit<span class="sc">::</span>hrrp_keydates <span class="sc">|&gt;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    ProgramYear,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">matches</span>(<span class="st">"^(Payment|Review)"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 5
  ProgramYear PaymentStartDate PaymentEndDate ReviewStartDate ReviewEndDate
        &lt;dbl&gt; &lt;date&gt;           &lt;date&gt;         &lt;chr&gt;           &lt;chr&gt;        
1        2027 2026-10-01       2027-09-30     &lt;NA&gt;            &lt;NA&gt;         
2        2026 2025-10-01       2026-09-30     2025-08-12      2025-09-10   
3        2025 2024-10-01       2025-09-30     2024-08-12      2024-09-10   
4        2024 2023-10-01       2024-09-30     2023-08-08      2023-09-07   
5        2023 2022-10-01       2023-09-30     2022-08-08      2022-09-07   
6        2022 2021-10-01       2022-09-30     2021-08-09      2021-09-08   
7        2021 2020-10-01       2021-09-30     2020-08-10      2020-09-09   
8        2020 2019-10-01       2020-09-30     2019-08-09      2019-09-09   
9        2019 2018-10-01       2019-09-30     2018-08-06      2018-09-05   </code></pre>
</div>
</div>
<p>The report file itself (through FY2025) is a large, multi-tab Microsoft Excel document where the structured part of the data is ambiguously placed throughout, thus we need tools to parse it out into a usable format. That is what some functions in the <code>readmit</code> package are for. In this article, we go through the tools that are available, what they do, and then provide some strategies/approaches for how hospitals can use these tools to analyze their own HSR’s to gain deeper insight into HRRP results and readmissions more broadly.</p>
<section id="the-toolbox" class="level1">
<h1>The Toolbox</h1>
<p>First, we’ll start by taking a look at what relevant functions are available to us, what they do, and how to use them. For our purposes, these are all of the functions prefixed like <code>hsr_*</code>. We’ll do this roughly in order of how the report is laid out, and how the HRRP results roll up.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readmit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="mock-reports" class="level2">
<h2 class="anchored" data-anchor-id="mock-reports">0. Mock Reports</h2>
<p>As the developer of this package, I don’t have access to hospitals’ actual HSR’s, as they contain senstivie patient information (i.e., <a href="https://cphs.berkeley.edu/hipaa/hipaa18.html">PHI</a>) and thus are not publicly available. So what we have to work with are <em>mock</em> reports that <a href="https://qualitynet.cms.gov/inpatient/hrrp/reports#tab3">CMS provides</a> to the public that are meant to mimick the format a hospital can expect their report to be in. It just includes fake data.</p>
<p><em><strong>Note</strong>: CMS changed the format of Hospital-Specific Reports (HSRs) for FY2026 (see <a href="https://qualitynet.cms.gov/inpatient/hrrp/reports#tab2">here</a>). The current HSR functions support Excel-based formats through FY2025.</em></p>
<p>Nevertheless, these provide a useful playground to analyze the mechanics of the program. We’ll start by finding a report with the <code>hsr_mock_reports()</code> function:</p>
<ul>
<li>Using no arguments lists the various mock files included in the package</li>
</ul>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hsr_mock_reports</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "FY2019_HRRP_MockHSR.xlsx" "FY2020_HRRP_MockHSR.xlsx"
[3] "FY2021_HRRP_MockHSR.xlsx" "FY2022_HRRP_MockHSR.xlsx"
[5] "FY2023_HRRP_MockHSR.xlsx" "FY2024_HRRP_MockHSR.xlsx"
[7] "FY2025_HRRP_MockHSR.xlsx"</code></pre>
</div>
</div>
<ul>
<li>Entering one of the listed file names will return the complete path to the file in the packages location on your computer</li>
</ul>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>my_report <span class="ot">&lt;-</span> <span class="fu">hsr_mock_reports</span>(<span class="st">"FY2025_HRRP_MockHSR.xlsx"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>my_report</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "/Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library/readmit/extdata/FY2025_HRRP_MockHSR.xlsx"</code></pre>
</div>
</div>
<p>Now we can use that HSR path with other package functions. Of course, you would just point to your own HSR when analyzing your hospital’s reports.</p>
</section>
<section id="programsummary" class="level2">
<h2 class="anchored" data-anchor-id="programsummary">1. Program Summary</h2>
<p>We’ll start with high level program results. Ultimately, all of the moving parts in the HRRP roll up into a single number: the penalty amount applied to your hospital. This is typically the first table in your report. We can parse it out of the report with the <code>hsr_payment_summary()</code> function:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>my_payment_summary <span class="ot">&lt;-</span> <span class="fu">hsr_payment_summary</span>(my_report)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>my_payment_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  Number of Dually Eligible Stays…¹ Total Number of Stay…² `Dual Proportion [c]`
                              &lt;dbl&gt;                  &lt;dbl&gt;                 &lt;dbl&gt;
1                               186                    856                 0.217
# ℹ abbreviated names: ¹​`Number of Dually Eligible Stays (Numerator) [a]`,
#   ²​`Total Number of Stays(Denominator) [b]`
# ℹ 4 more variables: `Peer Group Assignment [d]` &lt;dbl&gt;,
#   `Neutrality Modifier [e]` &lt;dbl&gt;, `Payment Reduction Percentage [f]` &lt;dbl&gt;,
#   `Payment Adjustment Factor [g]` &lt;dbl&gt;</code></pre>
</div>
</div>
<p>We now have this information in a data frame that we can manipulate as needed:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>my_payment_summary <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(dplyr<span class="sc">::</span><span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
  name                                               value
  &lt;chr&gt;                                              &lt;dbl&gt;
1 Number of Dually Eligible Stays (Numerator) [a] 186     
2 Total Number of Stays(Denominator) [b]          856     
3 Dual Proportion [c]                               0.217 
4 Peer Group Assignment [d]                         3     
5 Neutrality Modifier [e]                           0.965 
6 Payment Reduction Percentage [f]                  0.0007
7 Payment Adjustment Factor [g]                     0.999 </code></pre>
</div>
</div>
<p>There are also helper functions to extract specific components from this table.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hsr_payment_penalty</span>(my_report)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7e-04</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hsr_dual_proportion</span>(my_report)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2172897</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hsr_peer_group</span>(my_report)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
<p>See <code>?hsr_payment_summary</code> for all of them.</p>
</section>
<section id="cohortsummary" class="level2">
<h2 class="anchored" data-anchor-id="cohortsummary">2. Cohort Summary</h2>
<p>The overall payment penalty a hospital receives is a weighted average of penalities applied to the individual cohorts. These details are typically in the second table (tab) of the HSR, which we can import with <code>hsr_cohort_summary()</code>:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>cohort_summary <span class="ot">&lt;-</span> <span class="fu">hsr_cohort_summary</span>(my_report)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>cohort_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  `Measure [a]` `Number of Eligible Discharges [b]` Number of Readmissions Amo…¹
  &lt;chr&gt;                                       &lt;dbl&gt;                        &lt;dbl&gt;
1 AMI                                             2                            0
2 COPD                                           18                            3
3 HF                                             25                            2
4 Pneumonia                                      32                            5
5 CABG                                           NA                           NA
6 THA/TKA                                        45                            0
# ℹ abbreviated name: ¹​`Number of Readmissions Among Eligible Discharges [c]`
# ℹ 7 more variables: `Predicted Readmission Rate [d]` &lt;dbl&gt;,
#   `Expected Readmission Rate [e]` &lt;dbl&gt;,
#   `Excess Readmission Ratio (ERR) [f]` &lt;dbl&gt;,
#   `Peer Group Median ERR [g]` &lt;dbl&gt;, `Penalty Indicator (Yes/No) [h]` &lt;chr&gt;,
#   `Ratio of DRG Payments Per Measure to Total Payments [i]` &lt;dbl&gt;,
#   `National Observed Readmission Rate [j]` &lt;dbl&gt;</code></pre>
</div>
</div>
<p>We can then, for example, reconcile the overall penalty amount based on what is in this table:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>cohort_summary <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter to cohorts with a penalty</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="st">`</span><span class="at">Penalty Indicator (Yes/No) [h]</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">|&gt;</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute the contribution of each penalized cohort</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Contribution =</span> </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Ratio of DRG Payments Per Measure to Total Payments [i]</span><span class="st">`</span> <span class="sc">*</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Excess Readmission Ratio (ERR) [f]</span><span class="st">`</span> <span class="sc">-</span> </span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>          <span class="st">`</span><span class="at">Peer Group Median ERR [g]</span><span class="st">`</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Roll up into final calculation</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">Penalty =</span> <span class="fu">sum</span>(Contribution) <span class="sc">*</span> <span class="fu">hsr_neutrality_modifier</span>(my_report)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
   Penalty
     &lt;dbl&gt;
1 0.000746</code></pre>
</div>
</div>
<p>What we did here was:</p>
<ol type="1">
<li>Find cohorts who received a penalty <em>who were eligible</em>
<ul>
<li>A cohort must have at least 25 discharges to be eligible</li>
<li>Then, the excess readmission ratio (ERR) must be greater than the assigned peer group’s median ERR</li>
</ul></li>
<li>Find the difference between the hospital’s ERR compared to the peer group median ERR</li>
<li>Multiply that by the ratio of DRG payments for that cohort
<ul>
<li>This is a measure of the volume of patients with this condition are treated at the hospital</li>
</ul></li>
<li>Sum those contributions over each cohort</li>
<li>Multiply that by the neutrality modifier in the <code>hsr_payment_summary()</code> table</li>
</ol>
<p>That’s how the penalty is computed, from cohort summary level.</p>
</section>
<section id="discharges" class="level2">
<h2 class="anchored" data-anchor-id="discharges">3. Discharges</h2>
<p><em>Note: Because we are using mock reports, the dates in these files are erroneous and thus R doesn’t interpret them as dates. However, your hospital report has real dates and thus R should automatically parse them as such.</em></p>
<p>The HSR also contains discharge-level data on the individual patients that actually contributed to the program. There is a separate table/tab for each of the cohorts. We can use the <code>hsr_discharges()</code> function to import them for a specified cohort:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hsr_discharges</span>(my_report, <span class="st">"COPD"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 21 × 17
   `ID Number` MBI         `Medical Record Number` `Beneficiary DOB`
         &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;                   &lt;chr&gt;            
 1           1 9AA9AA9AA99 99999A                  99/99/9999       
 2           2 9AA9AA9AA99 99999A                  99/99/9999       
 3           3 9AA9AA9AA99 99999A                  99/99/9999       
 4           4 9AA9AA9AA99 99999A                  99/99/9999       
 5           5 9AA9AA9AA99 99999A                  99/99/9999       
 6           6 9AA9AA9AA99 99999A                  99/99/9999       
 7           7 9AA9AA9AA99 99999A                  99/99/9999       
 8           8 9AA9AA9AA99 99999A                  99/99/9999       
 9           9 9AA9AA9AA99 99999A                  99/99/9999       
10          10 9AA9AA9AA99 99999A                  99/99/9999       
# ℹ 11 more rows
# ℹ 13 more variables: `Admission Date of Index Stay` &lt;chr&gt;,
#   `Discharge Date of Index Stay` &lt;chr&gt;,
#   `Cohort Inclusion/Exclusion Indicator` &lt;chr&gt;, `Index Stay (Yes/No)` &lt;chr&gt;,
#   `Principal Discharge Diagnosis of Index Stay` &lt;chr&gt;,
#   `Discharge Destination` &lt;chr&gt;,
#   `Unplanned Readmission within 30 Days (Yes/No) [a]` &lt;chr&gt;, …</code></pre>
</div>
</div>
<p>We get some patient identifying information, including the specific dates associated with the index and readmission hospitalizations, whether or not the readmission occurred at the same hospital, diagnosis codes, etc., which is all very valuable information that we can explore to gain insights from (and what we’ll do <a href="#analysisstrategies">later</a>).</p>
<p>There are also options available in the function to refine the result:</p>
<section id="eligible-cases" class="level3">
<h3 class="anchored" data-anchor-id="eligible-cases">Eligible Cases</h3>
<p>The <code>eligible_only</code> argument can be used to only included discharges that were actually included in HRRP evaluation:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hsr_discharges</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> my_report, </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cohort =</span> <span class="st">"COPD"</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">eligible_only =</span> <span class="cn">TRUE</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 17
   `ID Number` MBI         `Medical Record Number` `Beneficiary DOB`
         &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;                   &lt;chr&gt;            
 1           1 9AA9AA9AA99 99999A                  99/99/9999       
 2           2 9AA9AA9AA99 99999A                  99/99/9999       
 3           3 9AA9AA9AA99 99999A                  99/99/9999       
 4           4 9AA9AA9AA99 99999A                  99/99/9999       
 5           5 9AA9AA9AA99 99999A                  99/99/9999       
 6           6 9AA9AA9AA99 99999A                  99/99/9999       
 7           7 9AA9AA9AA99 99999A                  99/99/9999       
 8           8 9AA9AA9AA99 99999A                  99/99/9999       
 9           9 9AA9AA9AA99 99999A                  99/99/9999       
10          10 9AA9AA9AA99 99999A                  99/99/9999       
11          11 9AA9AA9AA99 99999A                  99/99/9999       
12          12 9AA9AA9AA99 99999A                  99/99/9999       
13          13 9AA9AA9AA99 99999A                  99/99/9999       
14          14 9AA9AA9AA99 99999A                  99/99/9999       
15          15 9AA9AA9AA99 99999A                  99/99/9999       
16          16 9AA9AA9AA99 99999A                  99/99/9999       
17          17 9AA9AA9AA99 99999A                  99/99/9999       
18          18 9AA9AA9AA99 99999A                  99/99/9999       
# ℹ 13 more variables: `Admission Date of Index Stay` &lt;chr&gt;,
#   `Discharge Date of Index Stay` &lt;chr&gt;,
#   `Cohort Inclusion/Exclusion Indicator` &lt;chr&gt;, `Index Stay (Yes/No)` &lt;chr&gt;,
#   `Principal Discharge Diagnosis of Index Stay` &lt;chr&gt;,
#   `Discharge Destination` &lt;chr&gt;,
#   `Unplanned Readmission within 30 Days (Yes/No) [a]` &lt;chr&gt;,
#   `Planned Readmission within 30 Days (Yes/No)` &lt;chr&gt;, …</code></pre>
</div>
</div>
<p>Notice that this row count matches what was reported as the COPD denominator in the <code>cohort_summary</code>:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>cohort_summary <span class="sc">|&gt;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="st">`</span><span class="at">Measure [a]</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"COPD"</span>) <span class="sc">|&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="st">`</span><span class="at">Number of Eligible Discharges [b]</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 18</code></pre>
</div>
</div>
</section>
<section id="risk-factors" class="level3">
<h3 class="anchored" data-anchor-id="risk-factors">Risk Factors</h3>
<p>Also included in these tables are the indicators of risk factors that are used in the statistical models to estimate individual adjusted readmission risks. We can use the <code>risk_factors</code> argument to extract those for each patient:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hsr_discharges</span>(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> my_report, </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cohort =</span> <span class="st">"COPD"</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">eligible_only =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk_factors =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">discharge_phi =</span> <span class="cn">FALSE</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 42
   `ID Number` `Years Over 65 (continuous)` `History of Mechanical Ventilation`
         &lt;int&gt;                        &lt;dbl&gt;                               &lt;dbl&gt;
 1           1                            5                                   1
 2           2                            8                                   1
 3           3                           23                                   0
 4           4                           15                                   0
 5           5                            7                                   0
 6           6                            1                                   0
 7           7                           12                                   0
 8           8                           18                                   0
 9           9                            6                                   0
10          10                           11                                   0
11          11                           15                                   0
12          12                           13                                   0
13          13                            5                                   0
14          14                           12                                   0
15          15                           12                                   0
16          16                           24                                   0
17          17                           12                                   0
18          18                           11                                   0
# ℹ 39 more variables: `Sleep-Disordered Breathing` &lt;dbl&gt;,
#   `History of COVID-19` &lt;dbl&gt;,
#   `Severe Infection; Other Infectious Diseases` &lt;dbl&gt;,
#   `Metastatic Cancer and Acute Leukemia` &lt;dbl&gt;,
#   `Lung and Other Severe Cancers` &lt;dbl&gt;,
#   `Lymphatic, Head and Neck, Brain, and Other Major Cancers; Breast, Colorectal and Other Cancers and Tumors; Other Respiratory and Heart Neoplasms` &lt;dbl&gt;,
#   `Other Digestive and Urinary Neoplasms` &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>This data can then be explored further to understand risk factor prevalence and how that relates to model weights, etc. (again, covered <a href="#analysisstrategies">later</a>). Notice the <code>discharge_phi</code> argument was used to prevent the date information from being returned.</p>
</section>
</section>
<section id="modelcoefficients" class="level2">
<h2 class="anchored" data-anchor-id="modelcoefficients">4. Model Coefficients</h2>
<p>The ERR is calculated based on an aggregated roll up of individual adjusted readmission risks derived from a random-intercept logistic regression model. The first row in the discharge table contains the coefficients for this model. We can use the <code>hsr_coefficients()</code> function to extract them:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>copd_model <span class="ot">&lt;-</span> <span class="fu">hsr_coefficients</span>(my_report, <span class="st">"COPD"</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>copd_model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 43 × 2
   Factor                                                                  Value
   &lt;chr&gt;                                                                   &lt;dbl&gt;
 1 Years Over 65 (continuous)                                           -0.00550
 2 History of Mechanical Ventilation                                     0.293  
 3 Sleep-Disordered Breathing                                           -0.0339 
 4 History of COVID-19                                                  -0.0200 
 5 Severe Infection; Other Infectious Diseases                           0.0381 
 6 Metastatic Cancer and Acute Leukemia                                  0.201  
 7 Lung and Other Severe Cancers                                         0.156  
 8 Lymphatic, Head and Neck, Brain, and Other Major Cancers; Breast, C… -0.00343
 9 Other Digestive and Urinary Neoplasms                                -0.0792 
10 Diabetes Mellitus (DM) or DM Complications                            0.0891 
# ℹ 33 more rows</code></pre>
</div>
</div>
<p>This allows us to do things like assess the relative contribution of risk factors to the estimated readmission rates or use the risk factor dataset above to compute individual level readmission risks.</p>
<section id="intercept-terms" class="level3">
<h3 class="anchored" data-anchor-id="intercept-terms">Intercept Terms</h3>
<p>The <em>predicted</em> and <em>expected</em> readmission rates only differ in the intercept terms applied to the prediction (thus it is a constant shift for all patients). We can see these at the end of this data frame:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>copd_model <span class="sc">|&gt;</span> <span class="fu">tail</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  Factor                                           Value
  &lt;chr&gt;                                            &lt;dbl&gt;
1 Renal Failure                                   0.160 
2 Decubitus Ulcer or Chronic Skin Ulcer           0.0729
3 Cellulitis, Local Skin Infection                0.0412
4 Vertebral Fractures Without Spinal Cord Injury  0.0822
5 HOSP_EFFECT                                    -2.53  
6 AVG_EFFECT                                     -2.53  </code></pre>
</div>
</div>
</section>
</section>
<section id="readmission-risks" class="level2">
<h2 class="anchored" data-anchor-id="readmission-risks">5. Readmission Risks</h2>
<p>We could take the risk factor output from <code>hsr_discharges()</code> combined with the coefficients from <code>hsr_coefficients()</code> and reconcile each patient’s <em>predicted</em> and <em>expected</em> readmission risk. But the <code>hsr_readmission_risks()</code> function can do all of that for us:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>risks <span class="ot">&lt;-</span> <span class="fu">hsr_readmission_risks</span>(my_report, <span class="st">"COPD"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>risks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 3
   `ID Number` Predicted Expected
         &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1           1    0.260    0.260 
 2           2    0.266    0.266 
 3           3    0.227    0.227 
 4           4    0.0990   0.0989
 5           5    0.0935   0.0935
 6           6    0.130    0.130 
 7           7    0.156    0.156 
 8           8    0.190    0.190 
 9           9    0.0842   0.0842
10          10    0.100    0.100 
11          11    0.129    0.129 
12          12    0.111    0.111 
13          13    0.350    0.349 
14          14    0.127    0.127 
15          15    0.158    0.158 
16          16    0.168    0.168 
17          17    0.118    0.118 
18          18    0.210    0.210 </code></pre>
</div>
</div>
<p>This just takes a weighted-sum of the risk factors and coefficients, adds the corresponding intercept, and then maps it to a probability through the logistic function.</p>
<p>The cohort-level <em>predicted</em> and <em>expected</em> readmission rates are just the averages of these columns across all eligible patients:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>risks <span class="sc">|&gt;</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Discharges =</span> dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Predicted =</span> <span class="fu">mean</span>(Predicted),</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Expected =</span> <span class="fu">mean</span>(Expected),</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">ERR =</span> Predicted <span class="sc">/</span> Expected</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  Discharges Predicted Expected   ERR
       &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;
1         18     0.165    0.165  1.00</code></pre>
</div>
</div>
<p>Again, looking at our cohort summary, we can see these match:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>cohort_summary <span class="sc">|&gt;</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Measure [a]</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"COPD"</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Discharges =</span> <span class="st">`</span><span class="at">Number of Eligible Discharges [b]</span><span class="st">`</span>,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Predicted =</span> <span class="st">`</span><span class="at">Predicted Readmission Rate [d]</span><span class="st">`</span>,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Expected =</span> <span class="st">`</span><span class="at">Expected Readmission Rate [e]</span><span class="st">`</span>,</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ERR =</span> <span class="st">`</span><span class="at">Excess Readmission Ratio (ERR) [f]</span><span class="st">`</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  Discharges Predicted Expected   ERR
       &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;
1         18     0.165    0.165  1.00</code></pre>
</div>
</div>
</section>
<section id="dual-stays" class="level2">
<h2 class="anchored" data-anchor-id="dual-stays">6. Dual Stays</h2>
<p>CMS puts hospitals into peer groups based on the relative proportion of Medicare patients who are also eligible for Medicaid. This is a measure of socioeconomic status for the hospital population so hospitals are being compared only against other hospitals that are similar (in this regard). These aggregated quantities were found in <code>hsr_payment_summary()</code> result:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>my_payment_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  Number of Dually Eligible Stays…¹ Total Number of Stay…² `Dual Proportion [c]`
                              &lt;dbl&gt;                  &lt;dbl&gt;                 &lt;dbl&gt;
1                               186                    856                 0.217
# ℹ abbreviated names: ¹​`Number of Dually Eligible Stays (Numerator) [a]`,
#   ²​`Total Number of Stays(Denominator) [b]`
# ℹ 4 more variables: `Peer Group Assignment [d]` &lt;dbl&gt;,
#   `Neutrality Modifier [e]` &lt;dbl&gt;, `Payment Reduction Percentage [f]` &lt;dbl&gt;,
#   `Payment Adjustment Factor [g]` &lt;dbl&gt;</code></pre>
</div>
</div>
<p>The <code>hsr_dual_stays()</code> function extracts the discharge-level data corresponding to the numerator of the ratio:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hsr_dual_stays</span>(my_report)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 186 × 6
   `ID Number` MBI         `Beneficiary DOB` `Admission Date` `Discharge&nbsp;Date`
         &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;             &lt;chr&gt;            &lt;chr&gt;           
 1           1 9AA9AA9AA99 99/99/9999        99/99/9999       99/99/9999      
 2           2 9AA9AA9AA99 99/99/9999        99/99/9999       99/99/9999      
 3           3 9AA9AA9AA99 99/99/9999        99/99/9999       99/99/9999      
 4           4 9AA9AA9AA99 99/99/9999        99/99/9999       99/99/9999      
 5           5 9AA9AA9AA99 99/99/9999        99/99/9999       99/99/9999      
 6           6 9AA9AA9AA99 99/99/9999        99/99/9999       99/99/9999      
 7           7 9AA9AA9AA99 99/99/9999        99/99/9999       99/99/9999      
 8           8 9AA9AA9AA99 99/99/9999        99/99/9999       99/99/9999      
 9           9 9AA9AA9AA99 99/99/9999        99/99/9999       99/99/9999      
10          10 9AA9AA9AA99 99/99/9999        99/99/9999       99/99/9999      
# ℹ 176 more rows
# ℹ 1 more variable: `Claim Type` &lt;chr&gt;</code></pre>
</div>
</div>
<p>We can see that the row count of this discharge level data matches the first number in the preceding table.</p>
</section>
</section>
<section id="analysisstrategies" class="level1">
<h1>Analysis Strategies</h1>
<p>In this section we’ll go through a collection data analyses that can be conducted, using functions in <code>readmit</code> as support, to validate HSR calculations and/or to gain deeper insights into HRRP results.</p>
<section id="validating-the-penalty-calculation" class="level2">
<h2 class="anchored" data-anchor-id="validating-the-penalty-calculation">1. Validating the Penalty Calculation</h2>
<p>We <a href="#cohortsummary">previously calculated</a> the payment penalty starting from the cohort-level results. However, as an initial validation step, it is important to go through the mechanics of reconciling the penalty calculation from the discharge-level data to ensure comprehension of how it works.</p>
<p><em>Note: We’ll go the slower, more tedious way to do this in the steps below in order to capture all intermediate details for understanding, but will callout where certain steps can be more efficient.</em></p>
<p>Let’s extract the <code>cohort</code> strings we need to plug into various function arguments:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>cohorts <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">names</span>(hrrp_cohort_inclusion), <span class="st">"ProgramYear"</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>cohorts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AMI"  "COPD" "HF"   "PN"   "CABG" "HK"  </code></pre>
</div>
</div>
<section id="i.-extract-discharges" class="level3">
<h3 class="anchored" data-anchor-id="i.-extract-discharges">i. Extract Discharges</h3>
<p>The first thing we need to is extract the set of discharges (i.e., the <em>denominator</em>) that contribute to program for each cohort. To do this, we’ll iterate through the different cohorts and sequentially use the <code>hsr_discharges()</code> function to get the row identifiers that should be included:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>eligible_discharges <span class="ot">&lt;-</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setdiff</span>(cohorts, <span class="st">"CABG"</span>) <span class="sc">|&gt;</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Iterate each cohort</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">map_df</span>(</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Import eligible discharges</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span><span class="fu">hsr_discharges</span>(</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">file =</span> my_report,</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">cohort =</span> .x,</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">eligible_only =</span> <span class="cn">TRUE</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Keep the row identifiers</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">`</span><span class="at">ID Number</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Add cohort identifier</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>      tibble<span class="sc">::</span><span class="fu">add_column</span>(<span class="at">Cohort =</span> .x)</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>eligible_discharges</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 122 × 2
   `ID Number` Cohort
         &lt;int&gt; &lt;chr&gt; 
 1           1 AMI   
 2           2 AMI   
 3           1 COPD  
 4           2 COPD  
 5           3 COPD  
 6           4 COPD  
 7           5 COPD  
 8           6 COPD  
 9           7 COPD  
10           8 COPD  
# ℹ 112 more rows</code></pre>
</div>
</div>
<p>We can check the counts of these:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(eligible_discharges<span class="sc">$</span>Cohort)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
 AMI COPD   HF   HK   PN 
   2   18   25   45   32 </code></pre>
</div>
</div>
<p>You can validate that we obtained the correct counts by looking at the <a href="#cohortsummary">cohort summary</a> we previously created.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>cohort_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  `Measure [a]` `Number of Eligible Discharges [b]` Number of Readmissions Amo…¹
  &lt;chr&gt;                                       &lt;dbl&gt;                        &lt;dbl&gt;
1 AMI                                             2                            0
2 COPD                                           18                            3
3 HF                                             25                            2
4 Pneumonia                                      32                            5
5 CABG                                           NA                           NA
6 THA/TKA                                        45                            0
# ℹ abbreviated name: ¹​`Number of Readmissions Among Eligible Discharges [c]`
# ℹ 7 more variables: `Predicted Readmission Rate [d]` &lt;dbl&gt;,
#   `Expected Readmission Rate [e]` &lt;dbl&gt;,
#   `Excess Readmission Ratio (ERR) [f]` &lt;dbl&gt;,
#   `Peer Group Median ERR [g]` &lt;dbl&gt;, `Penalty Indicator (Yes/No) [h]` &lt;chr&gt;,
#   `Ratio of DRG Payments Per Measure to Total Payments [i]` &lt;dbl&gt;,
#   `National Observed Readmission Rate [j]` &lt;dbl&gt;</code></pre>
</div>
</div>
<p>One caveat was that we already knew there weren’t any <code>CABG</code> discharges (via the <code>NA</code> in the <code>cohort_summary</code> table), so we pre-excluded this from our cohort list we iterated through (as it would have caused an error otherwise).</p>
</section>
<section id="riskfactors" class="level3">
<h3 class="anchored" data-anchor-id="riskfactors">ii. Extract Risk Factors</h3>
<p>Next we need to extract the sets of risk factors for each cohort that go into the readmission risk model. We can again do this by iterating through the <code>cohort</code> list with <code>hsr_discharges</code>, but extracting the risk factors as well with <code>risk_factors=TRUE</code>:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setdiff</span>(cohorts, <span class="st">"CABG"</span>) <span class="sc">|&gt;</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Iterate each cohort</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">map</span>(</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Import eligible discharges</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span><span class="fu">hsr_discharges</span>(</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">file =</span> my_report,</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">cohort =</span> .x,</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">risk_factors =</span> <span class="cn">TRUE</span>,</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">discharge_phi =</span> <span class="cn">FALSE</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 2 × 33
  `ID Number` `Years Over 65 (continuous)`  Male Anterior Myocardial Infarctio…¹
        &lt;int&gt;                        &lt;dbl&gt; &lt;dbl&gt;                           &lt;dbl&gt;
1           1                           31     1                               0
2           2                           27     1                               0
# ℹ abbreviated name: ¹​`Anterior Myocardial Infarction `
# ℹ 29 more variables: `Non-Anterior Location of Myocardial Infarction` &lt;dbl&gt;,
#   `History of Coronary Artery Bypass Graft (CABG) Surgery` &lt;dbl&gt;,
#   `History of Percutaneous Transluminal Coronary Angioplasty (PTCA)` &lt;dbl&gt;,
#   `History of COVID-19` &lt;dbl&gt;,
#   `Severe Infection; Other Infectious Diseases` &lt;dbl&gt;,
#   `Metastatic Cancer and Acute Leukemia` &lt;dbl&gt;, Cancer &lt;dbl&gt;, …

[[2]]
# A tibble: 21 × 42
   `ID Number` `Years Over 65 (continuous)` `History of Mechanical Ventilation`
         &lt;int&gt;                        &lt;dbl&gt;                               &lt;dbl&gt;
 1           1                            5                                   1
 2           2                            8                                   1
 3           3                           23                                   0
 4           4                           15                                   0
 5           5                            7                                   0
 6           6                            1                                   0
 7           7                           12                                   0
 8           8                           18                                   0
 9           9                            6                                   0
10          10                           11                                   0
# ℹ 11 more rows
# ℹ 39 more variables: `Sleep-Disordered Breathing` &lt;dbl&gt;,
#   `History of COVID-19` &lt;dbl&gt;,
#   `Severe Infection; Other Infectious Diseases` &lt;dbl&gt;,
#   `Metastatic Cancer and Acute Leukemia` &lt;dbl&gt;,
#   `Lung and Other Severe Cancers` &lt;dbl&gt;,
#   `Lymphatic, Head and Neck, Brain, and Other Major Cancers; Breast, Colorectal and Other Cancers and Tumors; Other Respiratory and Heart Neoplasms` &lt;dbl&gt;, …

[[3]]
# A tibble: 30 × 39
   `ID Number` `Years Over 65 (continuous)`  Male History of Coronary Artery B…¹
         &lt;int&gt;                        &lt;dbl&gt; &lt;dbl&gt;                          &lt;dbl&gt;
 1           1                            8     1                              0
 2           2                           25     1                              1
 3           3                            9     0                              0
 4           4                            9     0                              0
 5           5                           30     0                              0
 6           6                           13     0                              0
 7           7                           12     1                              1
 8           8                            7     1                              1
 9           9                           25     1                              0
10          10                           22     0                              0
# ℹ 20 more rows
# ℹ abbreviated name: ¹​`History of Coronary Artery Bypass Graft (CABG) Surgery`
# ℹ 35 more variables: `History of COVID-19` &lt;dbl&gt;,
#   `Metastatic Cancer and Acute Leukemia` &lt;dbl&gt;, Cancer &lt;dbl&gt;,
#   `Diabetes Mellitus (DM) or DM Complications` &lt;dbl&gt;,
#   `Protein-Calorie Malnutrition` &lt;dbl&gt;,
#   `Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance` &lt;dbl&gt;, …

[[4]]
# A tibble: 45 × 43
   `ID Number` `Years Over 65 (continuous)`  Male History of Coronary Artery B…¹
         &lt;int&gt;                        &lt;dbl&gt; &lt;dbl&gt;                          &lt;dbl&gt;
 1           1                           13     0                              0
 2           2                           16     1                              0
 3           3                            6     1                              0
 4           4                           14     1                              0
 5           5                           16     1                              0
 6           6                           18     1                              0
 7           7                           15     1                              0
 8           8                           13     0                              0
 9           9                            9     0                              0
10          10                            4     0                              0
# ℹ 35 more rows
# ℹ abbreviated name: ¹​`History of Coronary Artery Bypass Graft (CABG) Surgery`
# ℹ 39 more variables: `History of COVID-19` &lt;dbl&gt;,
#   `Severe Infection; Other Infectious Diseases` &lt;dbl&gt;,
#   `Septicemia, Sepsis, Systemic Inflammatory Response Syndrome/Shock` &lt;dbl&gt;,
#   `Metastatic Cancer and Acute Leukemia` &lt;dbl&gt;,
#   `Lung and Other Severe Cancers` &lt;dbl&gt;, `Lymphoma; Other Cancers` &lt;dbl&gt;, …

[[5]]
# A tibble: 51 × 35
   `ID Number` `Years Over 65 (continuous)`  Male Index Admissions with an Ele…¹
         &lt;int&gt;                        &lt;dbl&gt; &lt;dbl&gt;                          &lt;dbl&gt;
 1           1                            1     1                              0
 2           2                            7     1                              1
 3           3                            1     0                              0
 4           4                            6     1                              0
 5           5                            1     1                              0
 6           6                           11     1                              0
 7           7                           14     0                              0
 8           8                           16     0                              0
 9           9                            1     0                              0
10          10                           16     0                              1
# ℹ 41 more rows
# ℹ abbreviated name: ¹​`Index Admissions with an Elective THA Procedure`
# ℹ 31 more variables: `Number of Procedures (two vs. one)` &lt;dbl&gt;,
#   `Other Congenital Deformity of Hip (Joint)` &lt;dbl&gt;,
#   `Post Traumatic Osteoarthritis` &lt;dbl&gt;, `History of COVID-19` &lt;dbl&gt;,
#   `Severe Infection; Other Infectious Diseases` &lt;dbl&gt;,
#   `Metastatic Cancer and Acute Leukemia` &lt;dbl&gt;, Cancer &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>Notice that we get the risk factors for each cohort, but all of the columns are different since each cohort has a different model. So one thing we can do is pivot the data with <code>tidyr::pivot_longer()</code> to make a long and narrow data frame so that it can all be binded together.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>risk_factors <span class="ot">&lt;-</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setdiff</span>(cohorts, <span class="st">"CABG"</span>) <span class="sc">|&gt;</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Iterate each cohort</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>      purrr<span class="sc">::</span><span class="fu">map_df</span>(</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Import eligible discharges</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span><span class="fu">hsr_discharges</span>(</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">file =</span> my_report,</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">cohort =</span> .x,</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">risk_factors =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">discharge_phi =</span> <span class="cn">FALSE</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Send risk factors down the rows</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>        tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">cols =</span> <span class="sc">-</span><span class="st">`</span><span class="at">ID Number</span><span class="st">`</span>,</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">names_to =</span> <span class="st">"Factor"</span>,</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">values_to =</span> <span class="st">"Value"</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Indicate cohort</span></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>        tibble<span class="sc">::</span><span class="fu">add_column</span>(<span class="at">Cohort =</span> .x)</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>risk_factors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5,689 × 4
   `ID Number` Factor                                               Value Cohort
         &lt;int&gt; &lt;chr&gt;                                                &lt;dbl&gt; &lt;chr&gt; 
 1           1 "Years Over 65 (continuous)"                            31 AMI   
 2           1 "Male"                                                   1 AMI   
 3           1 "Anterior Myocardial Infarction "                        0 AMI   
 4           1 "Non-Anterior Location of Myocardial Infarction"         0 AMI   
 5           1 "History of Coronary Artery Bypass Graft (CABG) Sur…     1 AMI   
 6           1 "History of Percutaneous Transluminal Coronary Angi…     0 AMI   
 7           1 "History of COVID-19"                                    0 AMI   
 8           1 "Severe Infection; Other Infectious Diseases"            1 AMI   
 9           1 "Metastatic Cancer and Acute Leukemia"                   0 AMI   
10           1 "Cancer"                                                 0 AMI   
# ℹ 5,679 more rows</code></pre>
</div>
</div>
<p>We can then merge these (using <code>dplyr::inner_join()</code>) with the eligilble discharges we previously identified to get the set of risk factors for each eligible discharge:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>risk_factors <span class="ot">&lt;-</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  risk_factors <span class="sc">|&gt;</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Join to get eligible only</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> eligible_discharges,</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">by =</span> </span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>          <span class="st">"ID Number"</span>,</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Cohort"</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>risk_factors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,626 × 4
   `ID Number` Factor                                               Value Cohort
         &lt;int&gt; &lt;chr&gt;                                                &lt;dbl&gt; &lt;chr&gt; 
 1           1 "Years Over 65 (continuous)"                            31 AMI   
 2           1 "Male"                                                   1 AMI   
 3           1 "Anterior Myocardial Infarction "                        0 AMI   
 4           1 "Non-Anterior Location of Myocardial Infarction"         0 AMI   
 5           1 "History of Coronary Artery Bypass Graft (CABG) Sur…     1 AMI   
 6           1 "History of Percutaneous Transluminal Coronary Angi…     0 AMI   
 7           1 "History of COVID-19"                                    0 AMI   
 8           1 "Severe Infection; Other Infectious Diseases"            1 AMI   
 9           1 "Metastatic Cancer and Acute Leukemia"                   0 AMI   
10           1 "Cancer"                                                 0 AMI   
# ℹ 4,616 more rows</code></pre>
</div>
</div>
<p>Of course, we didn’t <em>have</em> to do this step separately from step (i), as we could have just used the <code>eligible_only</code> argument simultaneously, and ended up in the same place.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>risk_factors <span class="ot">&lt;-</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setdiff</span>(cohorts, <span class="st">"CABG"</span>) <span class="sc">|&gt;</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Iterate each cohort</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>      purrr<span class="sc">::</span><span class="fu">map_df</span>(</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Import eligible discharges</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span><span class="fu">hsr_discharges</span>(</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">file =</span> my_report,</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">cohort =</span> .x,</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">risk_factors =</span> <span class="cn">TRUE</span>,</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">discharge_phi =</span> <span class="cn">FALSE</span>,</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">eligible_only =</span> <span class="cn">TRUE</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Send risk factors down the rows</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>        tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">cols =</span> <span class="sc">-</span><span class="st">`</span><span class="at">ID Number</span><span class="st">`</span>,</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">names_to =</span> <span class="st">"Factor"</span>,</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">values_to =</span> <span class="st">"Value"</span></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Indicate cohort</span></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>        tibble<span class="sc">::</span><span class="fu">add_column</span>(<span class="at">Cohort =</span> .x)</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>risk_factors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,626 × 4
   `ID Number` Factor                                               Value Cohort
         &lt;int&gt; &lt;chr&gt;                                                &lt;dbl&gt; &lt;chr&gt; 
 1           1 "Years Over 65 (continuous)"                            31 AMI   
 2           1 "Male"                                                   1 AMI   
 3           1 "Anterior Myocardial Infarction "                        0 AMI   
 4           1 "Non-Anterior Location of Myocardial Infarction"         0 AMI   
 5           1 "History of Coronary Artery Bypass Graft (CABG) Sur…     1 AMI   
 6           1 "History of Percutaneous Transluminal Coronary Angi…     0 AMI   
 7           1 "History of COVID-19"                                    0 AMI   
 8           1 "Severe Infection; Other Infectious Diseases"            1 AMI   
 9           1 "Metastatic Cancer and Acute Leukemia"                   0 AMI   
10           1 "Cancer"                                                 0 AMI   
# ℹ 4,616 more rows</code></pre>
</div>
</div>
</section>
<section id="individualreadmissionrisk" class="level3">
<h3 class="anchored" data-anchor-id="individualreadmissionrisk">iii. Compute Individual Readmission Risks</h3>
<p>The <em>predicted</em> and <em>expected</em> readmission rates are computed for each discharge by plugging in each patient’s set of risk factors into risk models developed by CMS. We can use the <code>hsr_coefficients()</code> function to extract these:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>model_weights <span class="ot">&lt;-</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  cohorts <span class="sc">|&gt;</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Iterate each cohort</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map_df</span>(</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Import eligible discharges</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span><span class="fu">hsr_coefficients</span>(</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> my_report,</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">cohort =</span> .x</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Indicate cohort</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">add_column</span>(<span class="at">Cohort =</span> .x)</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>model_weights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 225 × 3
   Factor                                                           Value Cohort
   &lt;chr&gt;                                                            &lt;dbl&gt; &lt;chr&gt; 
 1 "Years Over 65 (continuous)"                                   0.00765 AMI   
 2 "Male"                                                        -0.134   AMI   
 3 "Anterior Myocardial Infarction "                              0.271   AMI   
 4 "Non-Anterior Location of Myocardial Infarction"               0.0712  AMI   
 5 "History of Coronary Artery Bypass Graft (CABG) Surgery"       0.0233  AMI   
 6 "History of Percutaneous Transluminal Coronary Angioplasty (… -0.0218  AMI   
 7 "History of COVID-19"                                         -0.0676  AMI   
 8 "Severe Infection; Other Infectious Diseases"                  0.0832  AMI   
 9 "Metastatic Cancer and Acute Leukemia"                         0.226   AMI   
10 "Cancer"                                                       0.0440  AMI   
# ℹ 215 more rows</code></pre>
</div>
</div>
<p>To use these in our calculations, we need to attach the model weights for each cohort to our current <code>risk_factors</code> dataset using <code>dplyr::inner_join()</code>:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>risk_factors <span class="ot">&lt;-</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  risk_factors <span class="sc">|&gt;</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Join to get weights</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> </span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>        model_weights <span class="sc">|&gt;</span> </span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Rename the column</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">rename</span>(</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">Weight =</span> Value</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">by =</span> </span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Cohort"</span>,</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Factor"</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>risk_factors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,626 × 5
   `ID Number` Factor                                      Value Cohort   Weight
         &lt;int&gt; &lt;chr&gt;                                       &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
 1           1 "Years Over 65 (continuous)"                   31 AMI     0.00765
 2           1 "Male"                                          1 AMI    -0.134  
 3           1 "Anterior Myocardial Infarction "               0 AMI     0.271  
 4           1 "Non-Anterior Location of Myocardial Infar…     0 AMI     0.0712 
 5           1 "History of Coronary Artery Bypass Graft (…     1 AMI     0.0233 
 6           1 "History of Percutaneous Transluminal Coro…     0 AMI    -0.0218 
 7           1 "History of COVID-19"                           0 AMI    -0.0676 
 8           1 "Severe Infection; Other Infectious Diseas…     1 AMI     0.0832 
 9           1 "Metastatic Cancer and Acute Leukemia"          0 AMI     0.226  
10           1 "Cancer"                                        0 AMI     0.0440 
# ℹ 4,616 more rows</code></pre>
</div>
</div>
<section id="linearpredictor" class="level4">
<h4 class="anchored" data-anchor-id="linearpredictor">Compute the Linear Predictor</h4>
<p>These are <a href="https://en.wikipedia.org/wiki/Logistic_regression">logistic regression</a> models, so to convert to a risk estimate, we need to take the <em>weighted-sum</em> of each factor weight with the risk factor value for each discharge.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>linear_predictors <span class="ot">&lt;-</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  risk_factors <span class="sc">|&gt;</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute weighted sum</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarize</span>(</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">LP =</span> <span class="fu">sum</span>(Weight <span class="sc">*</span> Value),</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">.by =</span> </span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>          Cohort,</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>          <span class="st">`</span><span class="at">ID Number</span><span class="st">`</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>linear_predictors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 122 × 3
   Cohort `ID Number`    LP
   &lt;chr&gt;        &lt;int&gt; &lt;dbl&gt;
 1 AMI              1 1.92 
 2 AMI              2 0.749
 3 COPD             1 1.49 
 4 COPD             2 1.52 
 5 COPD             3 1.31 
 6 COPD             4 0.321
 7 COPD             5 0.258
 8 COPD             6 0.633
 9 COPD             7 0.841
10 COPD             8 1.08 
# ℹ 112 more rows</code></pre>
</div>
</div>
<p>You can think of this as the “risk-adjustment” part, where we’ve adjusted each patient’s readmission risk based on their own clinical history. These are on the <a href="https://en.wikipedia.org/wiki/Logit">logit</a> scale (so not yet probability/risk estimates), but it is what we assume to be linearly related to the outcome, thus we call it the “linear predictor”. However, we are still missing something: <strong>the intercept terms</strong>.</p>
</section>
<section id="add-in-the-intercepts" class="level4">
<h4 class="anchored" data-anchor-id="add-in-the-intercepts">Add In the Intercepts</h4>
<p>The <em>predicted</em> and <em>expected</em> readmission risks are derived from the same risk-adjusted model, the only difference being in the intercept term that is added to complete the linear predictor. We can see those in our model weight list:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>model_weights <span class="sc">|&gt;</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    stringr<span class="sc">::</span><span class="fu">str_detect</span>(</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>      Factor,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">pattern =</span> <span class="st">"EFFECT$"</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 3
   Factor      Value Cohort
   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt; 
 1 HOSP_EFFECT -2.96 AMI   
 2 AVG_EFFECT  -2.95 AMI   
 3 HOSP_EFFECT -2.53 COPD  
 4 AVG_EFFECT  -2.53 COPD  
 5 HOSP_EFFECT -2.46 HF    
 6 AVG_EFFECT  -2.42 HF    
 7 HOSP_EFFECT -2.51 PN    
 8 AVG_EFFECT  -2.51 PN    
 9 AVG_EFFECT  -2.70 CABG  
10 HOSP_EFFECT -4.41 HK    
11 AVG_EFFECT  -4.28 HK    </code></pre>
</div>
</div>
<ul>
<li>The <code>AVG_EFFECT</code> corresponds to the risk-shift (intercept) associated with being treated at the “average” hospital</li>
<li>The <code>HOSP_EFFECT</code> corresponds to the risk-shift (intercept) associated with being treated at <em>your</em> hospital</li>
</ul>
<p>These are estimated by CMS using your discharge lists. They are done so <em>after</em> accounting for all of the risk factors, so by comparing them we get a measure of how much more or less likely a patient is to be readmitted at your hospital versus the average hospital, after risk-adjustment.</p>
<p>We can add each one into our current <code>linear_predictors</code> to get the complete linear predictors for the predicted and expected readmission rates:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>linear_predictors <span class="ot">&lt;-</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  linear_predictors <span class="sc">|&gt;</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Join to get intercepts</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> </span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>        model_weights <span class="sc">|&gt;</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Filter to intercepts</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>          stringr<span class="sc">::</span><span class="fu">str_detect</span>(</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>            Factor,</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">pattern =</span> <span class="st">"_EFFECT$"</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Send over columns</span></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>        tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">names_from =</span> Factor,</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">values_from =</span> Value</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">by =</span> <span class="st">"Cohort"</span></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Finish LP's</span></span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">LP_Predicted =</span> LP <span class="sc">+</span> HOSP_EFFECT,</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">LP_Expected =</span> LP <span class="sc">+</span> AVG_EFFECT</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>linear_predictors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 122 × 7
   Cohort `ID Number`    LP HOSP_EFFECT AVG_EFFECT LP_Predicted LP_Expected
   &lt;chr&gt;        &lt;int&gt; &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
 1 AMI              1 1.92        -2.96      -2.95        -1.03       -1.03
 2 AMI              2 0.749       -2.96      -2.95        -2.21       -2.20
 3 COPD             1 1.49        -2.53      -2.53        -1.04       -1.04
 4 COPD             2 1.52        -2.53      -2.53        -1.01       -1.01
 5 COPD             3 1.31        -2.53      -2.53        -1.22       -1.22
 6 COPD             4 0.321       -2.53      -2.53        -2.21       -2.21
 7 COPD             5 0.258       -2.53      -2.53        -2.27       -2.27
 8 COPD             6 0.633       -2.53      -2.53        -1.90       -1.90
 9 COPD             7 0.841       -2.53      -2.53        -1.69       -1.69
10 COPD             8 1.08        -2.53      -2.53        -1.45       -1.45
# ℹ 112 more rows</code></pre>
</div>
</div>
</section>
<section id="transform-to-probability-scale" class="level4">
<h4 class="anchored" data-anchor-id="transform-to-probability-scale">Transform to Probability Scale</h4>
<p>The last thing we need to do is transform the linear predictors to the probabilty scale using the <a href="https://en.wikipedia.org/wiki/Logistic_function">logistic function</a> in order for our result to be a risk (i.e., a percentage between 0%-100%).</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>readmission_risks <span class="ot">&lt;-</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  linear_predictors <span class="sc">|&gt;</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Transform LP's</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(LP_Predicted, LP_Expected),</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>        \(x) <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>x))</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep a few columns</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">ID Number</span><span class="st">`</span>,</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">Predicted =</span> LP_Predicted,</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">Expected =</span> LP_Expected,</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>      Cohort</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>readmission_risks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 122 × 4
   `ID Number` Predicted Expected Cohort
         &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt; 
 1           1    0.262    0.264  AMI   
 2           2    0.0991   0.100  AMI   
 3           1    0.260    0.260  COPD  
 4           2    0.266    0.266  COPD  
 5           3    0.227    0.227  COPD  
 6           4    0.0990   0.0989 COPD  
 7           5    0.0935   0.0935 COPD  
 8           6    0.130    0.130  COPD  
 9           7    0.156    0.156  COPD  
10           8    0.190    0.190  COPD  
# ℹ 112 more rows</code></pre>
</div>
</div>
<p>Now we have the <em>predicted</em> and <em>expected</em> readmission risk for each discharge.</p>
</section>
<section id="readmissionrisks" class="level4">
<h4 class="anchored" data-anchor-id="readmissionrisks">Doing it Easier</h4>
<p>We went through those computations to see how deriving the readmission risks works starting with the discharges. However, we can get this automatically by using the <code>hsr_readmission_risks()</code> function:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>readmission_risks <span class="ot">&lt;-</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setdiff</span>(cohorts, <span class="st">"CABG"</span>) <span class="sc">|&gt;</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Iterate each cohort</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">map_df</span>(</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Import eligible discharges</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span><span class="fu">hsr_readmission_risks</span>(</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">file =</span> my_report,</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">cohort =</span> .x</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Indicate cohort</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>      tibble<span class="sc">::</span><span class="fu">add_column</span>(<span class="at">Cohort =</span> .x)</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>readmission_risks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 122 × 4
   `ID Number` Predicted Expected Cohort
         &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt; 
 1           1    0.262    0.264  AMI   
 2           2    0.0991   0.100  AMI   
 3           1    0.260    0.260  COPD  
 4           2    0.266    0.266  COPD  
 5           3    0.227    0.227  COPD  
 6           4    0.0990   0.0989 COPD  
 7           5    0.0935   0.0935 COPD  
 8           6    0.130    0.130  COPD  
 9           7    0.156    0.156  COPD  
10           8    0.190    0.190  COPD  
# ℹ 112 more rows</code></pre>
</div>
</div>
<p>This function extracts eligible discharges and computes the readmission risk, so it captures everything we just did up to this point.</p>
</section>
</section>
<section id="iv.-compute-cohort-level-results" class="level3">
<h3 class="anchored" data-anchor-id="iv.-compute-cohort-level-results">iv. Compute Cohort-Level Results</h3>
<p>Now that we have <a href="#readmissionrisks">individual level readmission risks</a>, we can roll these up to get cohort-level results. The main calculation we need to do is compute the cohort-level predicted and expected readmission rates, which is just the <em>average</em> of the individual ones.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>cohort_rates <span class="ot">&lt;-</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  readmission_risks <span class="sc">|&gt;</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute cohort-level stats</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarize</span>(</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">Discharges =</span> dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">Predicted =</span> <span class="fu">mean</span>(Predicted),</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">Expected =</span> <span class="fu">mean</span>(Expected),</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">.by =</span> Cohort</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>cohort_rates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  Cohort Discharges Predicted Expected
  &lt;chr&gt;       &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 AMI             2    0.181    0.182 
2 COPD           18    0.165    0.165 
3 HF             25    0.159    0.164 
4 PN             32    0.142    0.141 
5 HK             45    0.0350   0.0397</code></pre>
</div>
</div>
<p>We can compare this to our <a href="#cohortsummary">previous cohort summary</a> and see that it matches what was already in the table:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>cohort_summary <span class="sc">|&gt;</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">Cohort =</span> <span class="st">`</span><span class="at">Measure [a]</span><span class="st">`</span>,</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">Discharges =</span> <span class="st">`</span><span class="at">Number of Eligible Discharges [b]</span><span class="st">`</span>,</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">Predicted =</span> <span class="st">`</span><span class="at">Predicted Readmission Rate [d]</span><span class="st">`</span>,</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">Expected =</span> <span class="st">`</span><span class="at">Expected Readmission Rate [e]</span><span class="st">`</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  Cohort    Discharges Predicted Expected
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 AMI                2    0.181    0.182 
2 COPD              18    0.165    0.165 
3 HF                25    0.159    0.164 
4 Pneumonia         32    0.142    0.141 
5 CABG              NA   NA       NA     
6 THA/TKA           45    0.0350   0.0397</code></pre>
</div>
</div>
<section id="cohortcontributions" class="level4">
<h4 class="anchored" data-anchor-id="cohortcontributions">Pulling in Additional Info</h4>
<p>Recall <a href="#cohortsummary">earlier</a> how we calculated the payment penalty from the cohort-level data. It was done by computing the:</p>
<ol type="1">
<li>Excess readmission ratio (ERR) for each cohort</li>
<li>Difference between (1) and the peer group median ERR for each cohort</li>
<li>Sum (2) across cohorts, weighted by DRG ratios</li>
</ol>
<p>We can do (1) right away with our current <code>cohort_rates</code> dataset:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>cohort_rates <span class="ot">&lt;-</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  cohort_rates <span class="sc">|&gt;</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute the ERR</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">ERR =</span> Predicted <span class="sc">/</span> Expected</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>cohort_rates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  Cohort Discharges Predicted Expected   ERR
  &lt;chr&gt;       &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;
1 AMI             2    0.181    0.182  0.993
2 COPD           18    0.165    0.165  1.00 
3 HF             25    0.159    0.164  0.971
4 PN             32    0.142    0.141  1.01 
5 HK             45    0.0350   0.0397 0.882</code></pre>
</div>
</div>
<p>For the rest, we need to add the peer group medians and DRG ratios to our <code>cohort_rates</code> dataset, which we can get from our existing <code>cohort_summary</code> dataset that we <a href="#cohortsummary">extracted earlier</a>:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>cohort_rates <span class="ot">&lt;-</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  cohort_rates <span class="sc">|&gt;</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Join to get reference info</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> </span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>        cohort_summary <span class="sc">|&gt;</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Make matching names</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">Cohort =</span> <span class="st">`</span><span class="at">Measure [a]</span><span class="st">`</span>,</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">Cohort =</span> </span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>              Cohort <span class="sc">==</span> <span class="st">"Pneumonia"</span> <span class="sc">~</span> <span class="st">"PN"</span>,</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>              Cohort <span class="sc">==</span> <span class="st">"THA/TKA"</span> <span class="sc">~</span> <span class="st">"HK"</span>,</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>              <span class="cn">TRUE</span> <span class="sc">~</span> Cohort</span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span></span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Keep a few columns</span></span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>          Cohort,</span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">PeerGroupERR =</span> <span class="st">`</span><span class="at">Peer Group Median ERR [g]</span><span class="st">`</span>,</span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">DRGRatio =</span> <span class="st">`</span><span class="at">Ratio of DRG Payments Per Measure to Total Payments [i]</span><span class="st">`</span></span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">by =</span> <span class="st">"Cohort"</span></span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a>cohort_rates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 7
  Cohort Discharges Predicted Expected   ERR PeerGroupERR DRGRatio
  &lt;chr&gt;       &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;
1 AMI             2    0.181    0.182  0.993        0.996  0.00273
2 COPD           18    0.165    0.165  1.00         0.992  0.0226 
3 HF             25    0.159    0.164  0.971        0.996  0.0322 
4 PN             32    0.142    0.141  1.01         0.991  0.0494 
5 HK             45    0.0350   0.0397 0.882        0.996  0.104  </code></pre>
</div>
</div>
<p>Finally, we can indicate which cohorts received penalty and how much they contributed. Recall, a cohort is only eligible to receive penalty if:</p>
<ol type="1">
<li>They have at least 25 discharges</li>
<li>The ERR is greater than the peer group median ERR</li>
</ol>
<p>Thus, we can see, for example, that the COPD group had an ERR greater than the peer group median, but won’t actually contribute penalty because there were too few cases. Let’s compute the actual contribution for each cohort:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>cohort_rates <span class="ot">&lt;-</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  cohort_rates <span class="sc">|&gt;</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute penalty contribution</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">IsPenalized =</span> <span class="fu">as.numeric</span>(ERR <span class="sc">&gt;</span> PeerGroupERR <span class="sc">&amp;</span> Discharges <span class="sc">&gt;=</span> <span class="dv">25</span>),</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">PenaltyContribution =</span> (ERR <span class="sc">-</span> PeerGroupERR) <span class="sc">*</span> DRGRatio,</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">PenaltyContribution =</span> IsPenalized <span class="sc">*</span> PenaltyContribution</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>cohort_rates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 9
  Cohort Discharges Predicted Expected   ERR PeerGroupERR DRGRatio IsPenalized
  &lt;chr&gt;       &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;
1 AMI             2    0.181    0.182  0.993        0.996  0.00273           0
2 COPD           18    0.165    0.165  1.00         0.992  0.0226            0
3 HF             25    0.159    0.164  0.971        0.996  0.0322            0
4 PN             32    0.142    0.141  1.01         0.991  0.0494            1
5 HK             45    0.0350   0.0397 0.882        0.996  0.104             0
# ℹ 1 more variable: PenaltyContribution &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Ultimately, based on these criteria, this hospital is only penalized in the Pneumonia cohort.</p>
</section>
</section>
<section id="v.-aggregate-to-the-program-result" class="level3">
<h3 class="anchored" data-anchor-id="v.-aggregate-to-the-program-result">v. Aggregate to the Program Result</h3>
<p>Now that we have the <a href="#cohortcontributions">contributions of each cohort</a>, we can aggregate them into our final penalty amount. We’ll do this step by step:</p>
<ol type="1">
<li>Add up the cohort contributions</li>
</ol>
<p>We just computed these in the prior step.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>temp_penalty <span class="ot">&lt;-</span> <span class="fu">sum</span>(cohort_rates<span class="sc">$</span>PenaltyContribution)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>temp_penalty</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0007729462</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Multiply (1) by the neutrality modifier</li>
</ol>
<p>The neutrality modifier was found in our <a href="#programsummary">program summary</a> earlier. We can just extract from there.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>penalty <span class="ot">&lt;-</span> temp_penalty <span class="sc">*</span> my_payment_summary<span class="sc">$</span><span class="st">`</span><span class="at">Neutrality Modifier [e]</span><span class="st">`</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>penalty</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0007460787</code></pre>
</div>
</div>
<p>We can see that matches what was reported in the <a href="#programsummary">program summary</a>:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>my_payment_summary<span class="sc">$</span><span class="st">`</span><span class="at">Payment Reduction Percentage [f]</span><span class="st">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7e-04</code></pre>
</div>
</div>
<p>This is the final penalty amount.</p>
<section id="implication" class="level4">
<h4 class="anchored" data-anchor-id="implication">Implication</h4>
<p>Recall that the (mock) report we’ve been working with is from FY2025.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>my_report</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "/Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library/readmit/extdata/FY2025_HRRP_MockHSR.xlsx"</code></pre>
</div>
</div>
<p>Let’s remind ourselves of the payment period for this program year:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>my_payment_period <span class="ot">&lt;-</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  hrrp_payment_periods <span class="sc">|&gt;</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(ProgramYear <span class="sc">==</span> <span class="dv">2025</span>)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>my_payment_period</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  ProgramYear StartDate  EndDate   
        &lt;int&gt; &lt;date&gt;     &lt;date&gt;    
1        2025 2024-10-01 2025-09-30</code></pre>
</div>
</div>
<p>So from 10/01/2024 through 09/30/2025, all Medicare payments for this hospital were reduced by 0.075%.</p>
</section>
</section>
<section id="key-observations" class="level3">
<h3 class="anchored" data-anchor-id="key-observations">Key Observations</h3>
<p>Some important things to note about the penalty calculation:</p>
<section id="readmissions-themselves-dont-compute-penalty" class="level4">
<h4 class="anchored" data-anchor-id="readmissions-themselves-dont-compute-penalty">Readmissions Themselves Don’t Compute Penalty</h4>
<p>Notice that in the calculation of the penalty, we never explicity used or pulled out the actual discharges that readmitted, or used an “observed” readmission rate (i.e., the simple fraction of discharges that were readmitted). Instead, <em>all</em> discharges were fed into a statistical model to compute the predicted and expected readmission rates for the whole group, and then were aggregated. The actual readmission cases at your hospital were used upstream to fit that statistical model, in a pool along with data from all other hospitals. Thus, the readmissions from your hospital only contribute in an indirect way: they inform the resulting <em>hospital effect</em> estimated from the statistical model, after adjusting for clinical history, which in turn is built into the calculated <em>predicted</em> readmission rate that is computed on each discharge and used downstream in the penalty calculation.</p>
</section>
<section id="cohorts-arent-weighted-equally" class="level4">
<h4 class="anchored" data-anchor-id="cohorts-arent-weighted-equally">Cohorts Aren’t Weighted Equally</h4>
<p>First, remember that even if a cohort has excessive readmissions, they may not contribute to the penalty if there aren’t enough discharges. But beyond that point: the cohort-level contribution to the penalty is not necessarily proportional to how many readmissions they had. It also has to do with how many of those patients are seen at the hospital. Recall that we took the penalty contribution amount and multiplied it by the ratio of DRG’s relevant to that cohort out of all payments. This means that it is possible that a cohort with a slight excess in readmissions can contribute much more to the overall penalty amount than another cohort with huge excess, if the former is a much more high-volume diagnosis at your hospital. So you must consider the full picture.</p>
</section>
<section id="statistical-models-arent-perfect" class="level4">
<h4 class="anchored" data-anchor-id="statistical-models-arent-perfect">Statistical Models Aren’t Perfect</h4>
<p>Recall that CMS fits random-intercept logistic regression models on a combined dataset from all participating hospitals for each cohort. There are tons of assumptions and nuances that go into these models that make them far from perfect arbitors of truth. For example, each risk factor is added to the model as an independent factor, so no interactions between them are assumed. Additionally, effects are estimated on a combined dataset for all hospitals, which therefore assumes the effect of each clinical factor for risk adjustment is the same for all hospitals. On top of that, each of these risk factors is defined by claims documentation, and, specifically, groupings of ICD codes that may be inconsistent across hospitals. Then, these models are used to estimate individual level readmission risks, leading to group-level excess readmission ratios, that are then compared to a peer group <em>median</em> value to indicate penalty–so by definition, half of hospitals are getting flagged no matter what, even if everyone is doing well. We could keep going down the list of nuances, but it’s important to at least acknowledge and understand the mechanics of how these things work.</p>
</section>
</section>
</section>
<section id="understanding-model-weights" class="level2">
<h2 class="anchored" data-anchor-id="understanding-model-weights">2. Understanding Model Weights</h2>
<p>As described <a href="#modelcoefficients">previously</a>, the <em>predicted</em> and <em>expected</em> readmission rates are based on risk models developed by CMS that estimate hospital-level effects so that individual hospitals can be compared to an “average” hospital for penalty determination. Additionally, these models <em>risk-adjust</em> for individual patient clinical history as to tease out impacts due to the <em>hospital</em> itself instead of the overall morbidity of the population it serves. Thus, each model contains a long list of covariates (risk factors) which can be explored to gain further insight into the mechanics of the program. You can find more details about the model methodology <a href="https://qualitynet.cms.gov/inpatient/measures/readmission/methodology">here</a>.</p>
<section id="what-do-they-mean" class="level3">
<h3 class="anchored" data-anchor-id="what-do-they-mean">What Do They Mean?</h3>
<p>The first thing worth understanding are what the model estimates mean and how to interpret them. Recall from <a href="#modelcoefficients">above</a> that we can extract the model coefficients, which are found in the first row of the discharge-level data for each cohort, from the HSR with the <code>hsr_coefficients()</code> function, which we previously extracted <a href="#individualreadmissionrisk">above</a>:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>model_weights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 225 × 3
   Factor                                                           Value Cohort
   &lt;chr&gt;                                                            &lt;dbl&gt; &lt;chr&gt; 
 1 "Years Over 65 (continuous)"                                   0.00765 AMI   
 2 "Male"                                                        -0.134   AMI   
 3 "Anterior Myocardial Infarction "                              0.271   AMI   
 4 "Non-Anterior Location of Myocardial Infarction"               0.0712  AMI   
 5 "History of Coronary Artery Bypass Graft (CABG) Surgery"       0.0233  AMI   
 6 "History of Percutaneous Transluminal Coronary Angioplasty (… -0.0218  AMI   
 7 "History of COVID-19"                                         -0.0676  AMI   
 8 "Severe Infection; Other Infectious Diseases"                  0.0832  AMI   
 9 "Metastatic Cancer and Acute Leukemia"                         0.226   AMI   
10 "Cancer"                                                       0.0440  AMI   
# ℹ 215 more rows</code></pre>
</div>
</div>
<p>These are the weights (coefficients) of the regression equation that we use to weight individual patient risk factors. Remember that these are currently on the scale of the <a href="#linearpredictor">linear predictor</a>. To make them intuitive and interpretable. we can <em>exponentiate</em> them to put them on the <em><a href="https://en.wikipedia.org/wiki/Odds_ratio">odds ratio</a></em> scale.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>model_weights <span class="sc">|&gt;</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">OR =</span> <span class="fu">exp</span>(Value)</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 225 × 4
   Factor                                                     Value Cohort    OR
   &lt;chr&gt;                                                      &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
 1 "Years Over 65 (continuous)"                             0.00765 AMI    1.01 
 2 "Male"                                                  -0.134   AMI    0.875
 3 "Anterior Myocardial Infarction "                        0.271   AMI    1.31 
 4 "Non-Anterior Location of Myocardial Infarction"         0.0712  AMI    1.07 
 5 "History of Coronary Artery Bypass Graft (CABG) Surger…  0.0233  AMI    1.02 
 6 "History of Percutaneous Transluminal Coronary Angiopl… -0.0218  AMI    0.978
 7 "History of COVID-19"                                   -0.0676  AMI    0.935
 8 "Severe Infection; Other Infectious Diseases"            0.0832  AMI    1.09 
 9 "Metastatic Cancer and Acute Leukemia"                   0.226   AMI    1.25 
10 "Cancer"                                                 0.0440  AMI    1.04 
# ℹ 215 more rows</code></pre>
</div>
</div>
<p>For example, according to these estimates, the odds of a readmission for males are 12.5% lower than females on average for the AMI cohort. So one thing we can do is assess these across all factors to better understand how each risk factor is weighted, by which direction, and how much.</p>
<section id="relative-importance" class="level4">
<h4 class="anchored" data-anchor-id="relative-importance">Relative Importance</h4>
<p>A more tractable way to organize them for understanding is to rank them by the magnitude of their effects to get a sense of which factors have the most impact on the readmission risk calculation. Here we’ll make a plot of the top five (5) most heavily-weighted factors for each cohort:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>model_weights <span class="sc">|&gt;</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove intercepts</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>stringr<span class="sc">::</span><span class="fu">str_detect</span>(Factor, <span class="st">"_EFFECT$"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rank by group</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rank =</span> <span class="fu">order</span>(<span class="fu">order</span>(<span class="fu">abs</span>(Value), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="st">"Cohort"</span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter to top 10</span></span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Rank <span class="sc">&lt;=</span> <span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make a plot</span></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(</span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> stringr<span class="sc">::</span><span class="fu">str_sub</span>(Factor, <span class="dv">1</span>, <span class="dv">20</span>),</span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> <span class="dv">1</span>,</span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> <span class="fu">exp</span>(Value),</span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> stringr<span class="sc">::</span><span class="fu">str_sub</span>(Factor, <span class="dv">1</span>, <span class="dv">20</span>)</span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb98-27"><a href="#cb98-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb98-28"><a href="#cb98-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb98-29"><a href="#cb98-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Cohort, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">nrow =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb98-30"><a href="#cb98-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb98-31"><a href="#cb98-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb98-32"><a href="#cb98-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Risk Factor"</span>) <span class="sc">+</span></span>
<span id="cb98-33"><a href="#cb98-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Odds Ratio"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can see, for example, that <em>Dialysis Status</em> is an important factor that shows up across multiple cohort models, thus having heavy impact on program results.</p>
<p>We can create the full listing in a table format:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reactable)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>model_weights <span class="sc">|&gt;</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove intercepts</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>stringr<span class="sc">::</span><span class="fu">str_detect</span>(Factor, <span class="st">"_EFFECT$"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rank by group</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rank =</span> <span class="fu">order</span>(<span class="fu">order</span>(<span class="fu">abs</span>(Value), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="st">"Cohort"</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute odds ratio</span></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">OR =</span> <span class="fu">exp</span>(Value)</span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rearrange</span></span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>    Cohort,</span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>    Factor,</span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a>    Rank,</span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a>    Value,</span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a>    OR</span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(</span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a>    Cohort,</span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a>    Rank</span>
<span id="cb99-29"><a href="#cb99-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb99-30"><a href="#cb99-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb99-31"><a href="#cb99-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make a table</span></span>
<span id="cb99-32"><a href="#cb99-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reactable</span>(</span>
<span id="cb99-33"><a href="#cb99-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">groupBy =</span> <span class="st">"Cohort"</span>,</span>
<span id="cb99-34"><a href="#cb99-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> </span>
<span id="cb99-35"><a href="#cb99-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb99-36"><a href="#cb99-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">Factor =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Risk Factor"</span>),</span>
<span id="cb99-37"><a href="#cb99-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">Value =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Coefficient"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">2</span>)),</span>
<span id="cb99-38"><a href="#cb99-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">OR =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Odds-Ratio"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">2</span>))</span>
<span id="cb99-39"><a href="#cb99-39" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb99-40"><a href="#cb99-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">searchable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-41"><a href="#cb99-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-42"><a href="#cb99-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">filterable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-43"><a href="#cb99-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">resizable =</span> <span class="cn">TRUE</span></span>
<span id="cb99-44"><a href="#cb99-44" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-c96991d5e32e477db25c" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c96991d5e32e477db25c">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Cohort":["AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN"],"Factor":["Congestive Heart Failure","Anterior Myocardial Infarction ","Renal Failure","Dialysis Status","Metastatic Cancer and Acute Leukemia","Iron Deficiency or Other/Unspecified Anemias and Blood Disease","Chronic Obstructive Pulmonary Disease (COPD)","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Diabetes Mellitus (DM) or DM Complications","Pneumonia","Protein-Calorie Malnutrition","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Male","Specified Arrhythmias and Other Heart Rhythm Disorders","Decubitus Ulcer or Chronic Skin Ulcer","Coronary Atherosclerosis/ Other Chronic Ischemic Heart Disease","Valvular and Rheumatic Heart Disease","Vascular or Circulatory Disease","Severe Infection; Other Infectious Diseases","Other Urinary Tract Disorders","Non-Anterior Location of Myocardial Infarction","History of COVID-19","Cerebrovascular Disease","Stroke","Cancer","Acute Coronary Syndrome","Angina Pectoris","History of Coronary Artery Bypass Graft (CABG) Surgery","History of Percutaneous Transluminal Coronary Angioplasty (PTCA)","Asthma","Years Over 65 (continuous)","Dementia or Other Specified Brain Disorders","Dialysis Status","Renal Failure","Male","Congestive Heart Failure","Decubitus Ulcer or Chronic Skin Ulcer","Chronic Obstructive Pulmonary Disease (COPD)","Protein-Calorie Malnutrition","Severe Hematological Disorders","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Diabetes Mellitus (DM) or DM Complications","Pneumonia","Dementia or Other Specified Brain Disorders","Polyneuropathy; Other Neuropathies","Cardiogenic Shock","Other Respiratory Disorders","Morbid Obesity; Other Endocrine/Metabolic/Nutritional Disorders","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Vascular or Circulatory Disease","Specified Arrhythmias and Other Heart Rhythm Disorders","Major Psychiatric Disorders","Stroke","History of COVID-19","Years Over 65 (continuous)","Cerebrovascular Disease","Fibrosis of Lung or Other Chronic Lung Disorders","History of Coronary Artery Bypass Graft (CABG) or Valve Surgery","Cancer; Metastatic Cancer and Acute Leukemia","History of Mechanical Ventilation","Congestive Heart Failure","Cardio-respiratory Failure and Shock","Metastatic Cancer and Acute Leukemia","Iron Deficiency or Other/Unspecified Anemias and Blood Disease","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Drug/Alcohol Psychosis or Dependence","Specified Arrhythmias and Other Heart Rhythm Disorders","Renal Failure","Lung and Other Severe Cancers","Severe Hematological Disorders","Protein-Calorie Malnutrition","Fibrosis of Lung or Other Chronic Lung Disorders","Other Psychiatric Disorders","Diabetes Mellitus (DM) or DM Complications","Peptic Ulcer, Hemorrhage, Other Specified Gastrointestinal Disorders","Acute Coronary Syndrome","Anxiety Disorders","Other Gastrointestinal Disorders","Vertebral Fractures Without Spinal Cord Injury","Pneumonia","Other Digestive and Urinary Neoplasms","Decubitus Ulcer or Chronic Skin Ulcer","Other and Unspecified Heart Disease","Chronic Pancreatitis","Vascular or Circulatory Disease","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Coronary Atherosclerosis or Angina","Major Psychiatric Disorders","Cellulitis, Local Skin Infection","Severe Infection; Other Infectious Diseases","Sleep-Disordered Breathing","Polyneuropathy; Other Neuropathies","Morbid Obesity; Other Endocrine/ Metabolic/ Nutritional Disorders","Depression","History of COVID-19","Dementia or Other Specified Brain Disorders","Respirator Dependence/Respiratory Failure","Stroke","Years Over 65 (continuous)","Lymphatic, Head and Neck, Brain, and Other Major Cancers; Breast, Colorectal and Other Cancers and Tumors; Other Respiratory and Heart Neoplasms","Renal Failure","Severe Hematological Disorders","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Chronic Obstructive Pulmonary Disease (COPD)","Iron Deficiency or Other/Unspecified Anemias and Blood Disease","Dialysis Status","Metastatic Cancer and Acute Leukemia","Pneumonia","Decubitus Ulcer or Chronic Skin Ulcer","Congestive Heart Failure","Acute Coronary Syndrome","Specified Arrhythmias and Other Heart Rhythm Disorders","Diabetes Mellitus (DM) or DM Complications","Drug/Alcohol Abuse/ Dependence/Psychosis","Liver or Biliary Disease","Protein-Calorie Malnutrition","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Peptic Ulcer, Hemorrhage, Other Specified Gastrointestinal Disorders","Vascular or Circulatory Disease","Valvular and Rheumatic Heart Disease","Other Psychiatric Disorders","Coronary Atherosclerosis or Angina","Cardio-Respiratory Failure and Shock","Other Gastrointestinal Disorders","Fibrosis of Lung or Other Chronic Lung Disorders","Nephritis","Other Urinary Tract Disorders","Other and Unspecified Heart Disease","Male","Stroke","Major Psychiatric Disorders","History of Coronary Artery Bypass Graft (CABG) Surgery","Depression","Cancer","Dementia or Other Specified Brain Disorders","Years Over 65 (continuous)","Asthma","History of COVID-19","Dialysis Status","Severe Hematological Disorders","Other Congenital Deformity of Hip (Joint)","Congestive Heart Failure","Chronic Obstructive Pulmonary Disease (COPD)","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Major Psychiatric Disorders","Renal Failure","Morbid Obesity","Decubitus Ulcer or Chronic Skin Ulcer","Specified Arrhythmias and Other Heart Rhythm Disorders","Index Admissions with an Elective THA Procedure","Dementia or Other Specified Brain Disorders","Male","Pneumonia","Hypertension","Other Injuries","Cellulitis, Local Skin Infection","Rheumatoid Arthritis and Inflammatory Connective Tissue Disease","Protein-Calorie Malnutrition","Coronary Atherosclerosis or Angina","Number of Procedures (two vs. one)","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Diabetes Mellitus (DM) or DM Complications","Vascular or Circulatory Disease","Major Symptoms, Abnormalities","Stroke","Polyneuropathy; Other Neuropathies","Metastatic Cancer and Acute Leukemia","Severe Infection; Other Infectious Diseases","Years Over 65 (continuous)","History of COVID-19","Cancer","Post Traumatic Osteoarthritis","Severe Hematological Disorders","Dialysis Status","Congestive Heart Failure","Iron Deficiency or Other/Unspecified Anemias and Blood Disease","Metastatic Cancer and Acute Leukemia","Respirator Dependence/Tracheostomy Status","Pleural Effusion/Pneumothorax","Chronic Obstructive Pulmonary Disease (COPD)","Renal Failure","Lung and Other Severe Cancers","Protein-Calorie Malnutrition","Septicemia, Sepsis, Systemic Inflammatory Response Syndrome/Shock","Decubitus Ulcer or Chronic Skin Ulcer","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Fibrosis of Lung or Other Chronic Lung Disorders","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Pneumonia","Specified Arrhythmias and Other Heart Rhythm Disorders","Diabetes Mellitus (DM) or DM Complications","History of COVID-19","Acute Coronary Syndrome","Other Gastrointestinal Disorders","Drug/Alcohol Abuse/Dependence/Psychosis","Other Psychiatric Disorders","Respiratory Arrest; Cardio-Respiratory Failure and Shock","Urinary Tract Infection","Vascular or Circulatory Disease","Valvular and Rheumatic Heart Disease","Other Urinary Tract Disorders","Vertebral Fractures Without Spinal Cord Injury","Coronary Atherosclerosis or Angina","Severe Infection; Other Infectious Diseases","History of Coronary Artery Bypass Graft (CABG) Surgery","Stroke","Lymphoma; Other Cancers","Male","Other Respiratory Disorders","Major Psychiatric Disorders","Other Injuries","Years Over 65 (continuous)","Asthma","Dementia or Other Specified Brain Disorders"],"Rank":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42],"Value":[0.33957243074671,0.27100275921083,0.26177130895785,0.25127110061188,0.22634890641462,0.22465852292459,0.20889600190574,0.18728702112007,0.18363519022453,0.16362948864226,0.14477909636915,0.14174229352292,-0.13377094797325,0.12834192882491,0.11440519285484,0.10175224371917,0.09968987228144,0.09943077750067,0.08324200070107,0.07545016852382,0.07120286291483,-0.0676429056577,0.05614466547329,0.04570363659622,0.04401442147305,0.0297614483081,0.02729795306472,0.02331580008699,-0.02178937903037,0.01695937962873,0.00765330879237,0.00703750490067,0.35818303029402,0.29143239275745,-0.28332728852419,0.2800446325316,0.27300580017862,0.26484564483108,0.26370785697943,0.26154055665819,0.19114552705245,0.15786295143238,0.1511681537206,0.14566619001395,0.13107528477562,0.12957699458811,0.12184220387001,-0.11691556053706,0.10490316401824,0.10464292366885,0.09889417588161,0.08747730777201,0.07037263002522,-0.04492223071892,0.02767499869282,-0.02389210984846,0.01718013343108,0.00902984145127,-0.00332420831438,0.29280807156464,0.2439415793327,0.22038178999048,0.20104445264549,0.18328054402919,0.17681007960757,0.16445038235307,0.16108300640596,0.16003937693966,0.15641571251929,0.14811373057356,0.14281362472359,0.09533030999425,0.09114373098859,0.0890658422646,0.08820129638075,0.08369753436147,0.08328503809818,0.08250218578877,0.08224193320365,0.07955108252904,-0.07920807606545,0.07294989023911,0.07153773924385,0.06293681682419,0.06087761722765,0.05564420968061,0.04904567748974,0.04427640612473,0.04118173223991,0.03808035282907,-0.03389473810138,0.03215598707713,-0.02388404741238,0.02313345493758,-0.02003981846797,0.01206184755198,0.01120929463448,-0.00864104299739,-0.00550489429206,-0.0034296550888,0.25467622994391,0.23762950955586,0.16255670466746,0.15927075502566,0.15184667522785,0.15063453076202,0.14874300720604,0.11689320548651,0.11392662096829,0.1016609291805,0.09790277908018,0.09682630620285,0.09677714822051,0.09145549141705,0.08650221507101,0.08560777795158,0.0742789500502,0.0723520680848,0.07185907371904,0.07058646898766,0.06772100095278,0.06340647519094,0.06051633638107,0.05653031652753,0.05413448733244,0.05285914464513,0.04461504793124,0.03603726506083,-0.03586725467682,0.03184030056073,0.02511695897923,0.01986402655318,0.01541403711219,0.01262653085985,0.00975548315292,-0.0058876745155,0.00404853256189,-0.00239294251728,0.5978782174907,0.29881994243779,0.28564566526498,0.2723238654975,0.25480313855337,0.24543227729109,0.23494388360546,0.22799144692474,0.22298546250043,0.20960556510495,0.17376971474725,0.16317044297896,0.15538492166378,0.14771744300593,0.14606104955108,0.14328115783213,0.14248311993964,0.13988994687991,0.13935558883477,0.13277839169882,0.13100204057882,0.1286610446364,0.1224436188646,0.11981420121191,0.10992796636631,0.09528675586484,0.08923188109521,0.08487023427136,0.0799645208149,0.04508274963675,0.03857725723824,-0.02583679305955,-0.021371850181,-1.52018641e-05,0.26359064734308,0.24009331029806,0.19422199453265,0.18194701681503,0.17827066953589,0.17600014087344,0.1606016141625,0.13139244938143,0.12708573624157,0.12270154741653,0.12196238167798,0.11855382669326,0.11631820787447,0.11023929530957,0.10848046835409,0.1072630978906,0.10709471281501,0.09977928562087,0.09004469255696,-0.0767024905464,0.07105773620641,0.06175525419797,0.06078806879643,0.05806411686367,0.05240883963648,0.05229959267784,0.05191332162581,0.04899146976652,0.04270544546113,0.03936136215198,0.03285307899265,0.03053426003874,-0.02980557296489,0.02877533874591,0.02813765867189,0.02436651587802,0.02356441710246,0.0184252173479,0.00894405564906,-0.00890555581122,-0.00763712593242,-0.00405389134248],"OR":[1.40434700657616,1.31127868847395,1.29922938632986,1.28565857991806,1.25401312218034,1.2518951496995,1.23231683326371,1.20597337520888,1.20157739594988,1.17777785416899,1.15578422513392,1.15227966033888,0.874790414174569,1.13694168937752,1.12120633765287,1.10710914450208,1.10482822708194,1.10454200893507,1.08680478424652,1.0783694896356,1.07379903777738,0.934594152280405,1.05775069267337,1.04676414239889,1.04499742518198,1.03020874659868,1.02767395575626,1.02358973823982,0.978446294657523,1.01710400634375,1.00768267021632,1.0070623263311,1.43072746298482,1.33834314874191,0.753273209833681,1.3231888682885,1.31390786570295,1.30322979999659,1.30174784419777,1.2989296207483,1.21063561949572,1.17100569905634,1.1631922367401,1.1568099688729,1.14005360676125,1.13834675462822,1.1295758450197,0.889660312430832,1.11060305881081,1.11031407268731,1.10394946889795,1.09141749746726,1.07290790447466,0.956071831961017,1.02806150878639,0.976391047053408,1.01732856070524,1.0090707334597,0.99668131074888,1.34018554603127,1.27626976777999,1.24655256103836,1.22267912193687,1.20115133665262,1.19340441976714,1.17874508154332,1.17478247923821,1.17355708116837,1.16931219978582,1.15964477592895,1.15351479499191,1.10002214343179,1.09542644066927,1.09315262960155,1.09220795741027,1.08729997318708,1.08685155850211,1.08600104720536,1.08571844940038,1.08280087032362,0.923847673855356,1.07567663366527,1.07415868787304,1.06495954957909,1.06276884163083,1.05722146764992,1.05026832326495,1.04527123433375,1.04204146086774,1.03881470122512,0.966673253144263,1.0326785772551,0.976398919175548,1.02340310863209,0.980159644074325,1.01213488499526,1.01127235417498,0.991396183512194,0.994510229873486,0.996576219460403,1.29004387567186,1.26823923525535,1.17651503045079,1.17265540604647,1.16398175551224,1.16257169623939,1.16037474293993,1.12399938631304,1.1206698881957,1.10700805395688,1.10285555926439,1.10166900392913,1.10161484943477,1.09576800452604,1.09035378292616,1.08937896605059,1.07710722270742,1.07503376252324,1.0745039075538,1.07313735851998,1.07006671923253,1.06545983421404,1.062384952954,1.05815869401114,1.05562656100928,1.05428113351708,1.04562526681456,1.03669447825391,0.964768353470128,1.0323526260044,1.02543504734744,1.02006262916481,1.01553344611831,1.01270658206884,1.00980322299415,0.994129623874354,1.0040567389407,0.997609918287297,1.81825675924455,1.34826683597601,1.3306208865114,1.31301217179861,1.2902076037353,1.2781737192729,1.26483778860496,1.25607458208597,1.249802404602,1.23319155023515,1.18978154512627,1.17723732442611,1.16810750446418,1.15918531416689,1.15726683651509,1.1540542274412,1.15313361582805,1.15014721460233,1.14953278836153,1.14199689429525,1.13997010750847,1.13730456334368,1.13025539319517,1.12728738349084,1.11619766378927,1.09997423396834,1.09333415045518,1.08857579770109,1.08324863421437,1.04611442191559,1.03933102110065,0.974494120834844,0.97885490951141,0.999984798251448,1.30159527574775,1.27136777649297,1.21436583561166,1.1995506361829,1.19514876782156,1.19243822663353,1.17421708416427,1.14041524876104,1.13551436834238,1.13054695593161,1.12971160312608,1.1258674741942,1.12335327512397,1.11654522252815,1.11458313868254,1.11322710365637,1.11303966860744,1.10492701787976,1.09422318624449,0.926165355571123,1.07364321216502,1.06370197627399,1.06267367660932,1.05978294349047,1.05380649231681,1.05369137345083,1.05328444157356,1.05021139215344,1.04363044348821,1.04014628524584,1.03339870010939,1.03100521172221,0.97063423273985,1.02919334863171,1.02853726174997,1.02466580536269,1.02384425170249,1.01859600901031,1.00898417323021,0.991133981197538,0.992391962815253,0.99595431458264]},"columns":[{"id":"Cohort","name":"Cohort","type":"character"},{"id":"Factor","name":"Risk Factor","type":"character"},{"id":"Rank","name":"Rank","type":"numeric"},{"id":"Value","name":"Coefficient","type":"numeric","format":{"cell":{"digits":2},"aggregated":{"digits":2}}},{"id":"OR","name":"Odds-Ratio","type":"numeric","format":{"cell":{"digits":2},"aggregated":{"digits":2}}}],"groupBy":["Cohort"],"resizable":true,"filterable":true,"searchable":true,"dataKey":"e0d7afee0d1a9a6a7d3cb81f7787c7e0"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="risk-factor-prevalence" class="level3">
<h3 class="anchored" data-anchor-id="risk-factor-prevalence">Risk Factor Prevalence</h3>
<p>We now understand the model output, but how can we incorporate the risk factors in our discharge datasets to gain additional insight?</p>
<p>Recall, the way we calculated the readmission risks was by taking a weighted-sum of the risk factors in our dataset with the model weights (and then doing some transformations to turn it into a probability). We just established that different factors yield different effects (weight) on the readmission risks from the model side and how that can be useful for understanding how CMS weights different clinical history factors.</p>
<p>The next thing we can seek to understand is how prevalent each of the risk factors are for your cohort. This is useful for a few reasons:</p>
<ol type="1">
<li>You can compare to see if the rates of various risk factors are similar for your hospital versus peer group hospitals</li>
<li>It gives insight into the difference between model importance for readmission risk vs.&nbsp;how prevalent the risk factor is</li>
<li>We can use the combination of model weights and prevalence of risk factors to understand overall impact. For example, a risk factor that has an average impact in terms of odds-ratio but has very high prevalence at your hospital may have more overall net impact on your HRRP readmission metrics than the most important factor according to the model but has very few patients with it at your hospital.</li>
</ol>
<p>The first step get at this analysis is to compute these from your datasets. We can do this by manipulating the output of <code>hsr_discharges()</code> after using the <code>risk_factors=TRUE</code> argument. Here is an example of how we’d do this for AMI:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hsr_discharges</span>(</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> my_report,</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cohort =</span> <span class="st">"AMI"</span>,</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">discharge_phi =</span> <span class="cn">FALSE</span>,</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk_factors =</span> <span class="cn">TRUE</span>,</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">eligible_only =</span> <span class="cn">TRUE</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 33
  `ID Number` `Years Over 65 (continuous)`  Male Anterior Myocardial Infarctio…¹
        &lt;int&gt;                        &lt;dbl&gt; &lt;dbl&gt;                           &lt;dbl&gt;
1           1                           31     1                               0
2           2                           27     1                               0
# ℹ abbreviated name: ¹​`Anterior Myocardial Infarction `
# ℹ 29 more variables: `Non-Anterior Location of Myocardial Infarction` &lt;dbl&gt;,
#   `History of Coronary Artery Bypass Graft (CABG) Surgery` &lt;dbl&gt;,
#   `History of Percutaneous Transluminal Coronary Angioplasty (PTCA)` &lt;dbl&gt;,
#   `History of COVID-19` &lt;dbl&gt;,
#   `Severe Infection; Other Infectious Diseases` &lt;dbl&gt;,
#   `Metastatic Cancer and Acute Leukemia` &lt;dbl&gt;, Cancer &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>However, we’ve already <a href="#riskfactors">done this earlier</a> in our exercises, so we’ll use that <code>risk_factors</code> dataset:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>risk_factors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,626 × 5
   `ID Number` Factor                                      Value Cohort   Weight
         &lt;int&gt; &lt;chr&gt;                                       &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
 1           1 "Years Over 65 (continuous)"                   31 AMI     0.00765
 2           1 "Male"                                          1 AMI    -0.134  
 3           1 "Anterior Myocardial Infarction "               0 AMI     0.271  
 4           1 "Non-Anterior Location of Myocardial Infar…     0 AMI     0.0712 
 5           1 "History of Coronary Artery Bypass Graft (…     1 AMI     0.0233 
 6           1 "History of Percutaneous Transluminal Coro…     0 AMI    -0.0218 
 7           1 "History of COVID-19"                           0 AMI    -0.0676 
 8           1 "Severe Infection; Other Infectious Diseas…     1 AMI     0.0832 
 9           1 "Metastatic Cancer and Acute Leukemia"          0 AMI     0.226  
10           1 "Cancer"                                        0 AMI     0.0440 
# ℹ 4,616 more rows</code></pre>
</div>
</div>
<p>Now we can compute the prevalence for each risk factor (in each cohort) by simply taking the average <code>Value</code>, because all of these are binary factors (except for Age):</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>prevalence <span class="ot">&lt;-</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  risk_factors <span class="sc">|&gt;</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove age (for demo purposes)</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>stringr<span class="sc">::</span><span class="fu">str_detect</span>(Factor, <span class="st">"^Years"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute average</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarize</span>(</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">N =</span> dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">Count =</span> <span class="fu">sum</span>(Value),</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">Rate =</span> Count <span class="sc">/</span> N,</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">.by =</span> </span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>          Cohort,</span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>          Factor</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>prevalence</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 182 × 5
   Cohort Factor                                                   N Count  Rate
   &lt;chr&gt;  &lt;chr&gt;                                                &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 AMI    "Male"                                                   2     2   1  
 2 AMI    "Anterior Myocardial Infarction "                        2     0   0  
 3 AMI    "Non-Anterior Location of Myocardial Infarction"         2     0   0  
 4 AMI    "History of Coronary Artery Bypass Graft (CABG) Sur…     2     1   0.5
 5 AMI    "History of Percutaneous Transluminal Coronary Angi…     2     1   0.5
 6 AMI    "History of COVID-19"                                    2     0   0  
 7 AMI    "Severe Infection; Other Infectious Diseases"            2     1   0.5
 8 AMI    "Metastatic Cancer and Acute Leukemia"                   2     0   0  
 9 AMI    "Cancer"                                                 2     0   0  
10 AMI    "Diabetes Mellitus (DM) or DM Complications"             2     1   0.5
# ℹ 172 more rows</code></pre>
</div>
</div>
<p>Then we could put all of these into a navigatable table:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>prevalence <span class="sc">|&gt;</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Arrange</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(Cohort, <span class="fu">desc</span>(Rate)) <span class="sc">|&gt;</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make a table</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">reactable</span>(</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">groupBy =</span> <span class="st">"Cohort"</span>,</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> </span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">Factor =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Risk Factor"</span>),</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">N =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Discharge Count"</span>),</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">Count =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Count"</span>),</span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">Rate =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Percent"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">1</span>, <span class="at">percent =</span> <span class="cn">TRUE</span>))</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">columnGroups =</span> </span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(</span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a>          <span class="fu">colGroup</span>(</span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">name =</span> <span class="st">"Risk Factor Prevalence"</span>,</span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Count"</span>, <span class="st">"Rate"</span>)</span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb106-23"><a href="#cb106-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">searchable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb106-24"><a href="#cb106-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb106-25"><a href="#cb106-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">filterable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb106-26"><a href="#cb106-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">resizable =</span> <span class="cn">TRUE</span></span>
<span id="cb106-27"><a href="#cb106-27" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-13411291f937cdc3f40b" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-13411291f937cdc3f40b">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Cohort":["AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN"],"Factor":["Male","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Iron Deficiency or Other/Unspecified Anemias and Blood Disease","Renal Failure","History of Coronary Artery Bypass Graft (CABG) Surgery","History of Percutaneous Transluminal Coronary Angioplasty (PTCA)","Severe Infection; Other Infectious Diseases","Diabetes Mellitus (DM) or DM Complications","Dementia or Other Specified Brain Disorders","Congestive Heart Failure","Coronary Atherosclerosis/ Other Chronic Ischemic Heart Disease","Specified Arrhythmias and Other Heart Rhythm Disorders","Chronic Obstructive Pulmonary Disease (COPD)","Asthma","Other Urinary Tract Disorders","Anterior Myocardial Infarction ","Non-Anterior Location of Myocardial Infarction","History of COVID-19","Metastatic Cancer and Acute Leukemia","Cancer","Protein-Calorie Malnutrition","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Acute Coronary Syndrome","Angina Pectoris","Valvular and Rheumatic Heart Disease","Stroke","Cerebrovascular Disease","Vascular or Circulatory Disease","Pneumonia","Dialysis Status","Decubitus Ulcer or Chronic Skin Ulcer","Cardio-respiratory Failure and Shock","Morbid Obesity; Other Endocrine/ Metabolic/ Nutritional Disorders","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Other Gastrointestinal Disorders","Iron Deficiency or Other/Unspecified Anemias and Blood Disease","Congestive Heart Failure","Diabetes Mellitus (DM) or DM Complications","Polyneuropathy; Other Neuropathies","Vascular or Circulatory Disease","Renal Failure","Depression","Specified Arrhythmias and Other Heart Rhythm Disorders","Pneumonia","Other Psychiatric Disorders","Sleep-Disordered Breathing","Lymphatic, Head and Neck, Brain, and Other Major Cancers; Breast, Colorectal and Other Cancers and Tumors; Other Respiratory and Heart Neoplasms","Severe Infection; Other Infectious Diseases","Anxiety Disorders","History of Mechanical Ventilation","History of COVID-19","Drug/Alcohol Psychosis or Dependence","Acute Coronary Syndrome","Coronary Atherosclerosis or Angina","Other and Unspecified Heart Disease","Metastatic Cancer and Acute Leukemia","Protein-Calorie Malnutrition","Peptic Ulcer, Hemorrhage, Other Specified Gastrointestinal Disorders","Dementia or Other Specified Brain Disorders","Major Psychiatric Disorders","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Respirator Dependence/Respiratory Failure","Cellulitis, Local Skin Infection","Vertebral Fractures Without Spinal Cord Injury","Lung and Other Severe Cancers","Other Digestive and Urinary Neoplasms","Chronic Pancreatitis","Severe Hematological Disorders","Stroke","Fibrosis of Lung or Other Chronic Lung Disorders","Decubitus Ulcer or Chronic Skin Ulcer","Specified Arrhythmias and Other Heart Rhythm Disorders","Other Gastrointestinal Disorders","Congestive Heart Failure","Cardio-Respiratory Failure and Shock","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Iron Deficiency or Other/Unspecified Anemias and Blood Disease","Renal Failure","Coronary Atherosclerosis or Angina","Male","Diabetes Mellitus (DM) or DM Complications","Valvular and Rheumatic Heart Disease","Vascular or Circulatory Disease","Depression","Chronic Obstructive Pulmonary Disease (COPD)","Other Psychiatric Disorders","Other and Unspecified Heart Disease","Other Urinary Tract Disorders","History of Coronary Artery Bypass Graft (CABG) Surgery","Liver or Biliary Disease","Pneumonia","Dementia or Other Specified Brain Disorders","Cancer","Drug/Alcohol Abuse/ Dependence/Psychosis","Acute Coronary Syndrome","Peptic Ulcer, Hemorrhage, Other Specified Gastrointestinal Disorders","Major Psychiatric Disorders","Stroke","Fibrosis of Lung or Other Chronic Lung Disorders","Decubitus Ulcer or Chronic Skin Ulcer","Protein-Calorie Malnutrition","Asthma","History of COVID-19","Metastatic Cancer and Acute Leukemia","Severe Hematological Disorders","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Dialysis Status","Nephritis","Hypertension","Major Symptoms, Abnormalities","Male","Diabetes Mellitus (DM) or DM Complications","Specified Arrhythmias and Other Heart Rhythm Disorders","Other Injuries","Index Admissions with an Elective THA Procedure","Renal Failure","Morbid Obesity","Polyneuropathy; Other Neuropathies","Chronic Obstructive Pulmonary Disease (COPD)","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Congestive Heart Failure","Rheumatoid Arthritis and Inflammatory Connective Tissue Disease","Coronary Atherosclerosis or Angina","Vascular or Circulatory Disease","Severe Infection; Other Infectious Diseases","Cancer","Pneumonia","Number of Procedures (two vs. one)","Metastatic Cancer and Acute Leukemia","Protein-Calorie Malnutrition","Severe Hematological Disorders","Stroke","Cellulitis, Local Skin Infection","Other Congenital Deformity of Hip (Joint)","Post Traumatic Osteoarthritis","History of COVID-19","Dementia or Other Specified Brain Disorders","Major Psychiatric Disorders","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Dialysis Status","Decubitus Ulcer or Chronic Skin Ulcer","Respiratory Arrest; Cardio-Respiratory Failure and Shock","Male","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Chronic Obstructive Pulmonary Disease (COPD)","Other Gastrointestinal Disorders","Specified Arrhythmias and Other Heart Rhythm Disorders","Iron Deficiency or Other/Unspecified Anemias and Blood Disease","Congestive Heart Failure","Other Respiratory Disorders","Diabetes Mellitus (DM) or DM Complications","Renal Failure","Other Injuries","Pneumonia","Lymphoma; Other Cancers","Vascular or Circulatory Disease","Severe Infection; Other Infectious Diseases","Dementia or Other Specified Brain Disorders","Coronary Atherosclerosis or Angina","Valvular and Rheumatic Heart Disease","Other Psychiatric Disorders","Pleural Effusion/Pneumothorax","Decubitus Ulcer or Chronic Skin Ulcer","Asthma","Urinary Tract Infection","Septicemia, Sepsis, Systemic Inflammatory Response Syndrome/Shock","Drug/Alcohol Abuse/Dependence/Psychosis","Other Urinary Tract Disorders","Protein-Calorie Malnutrition","Acute Coronary Syndrome","Metastatic Cancer and Acute Leukemia","Vertebral Fractures Without Spinal Cord Injury","History of Coronary Artery Bypass Graft (CABG) Surgery","History of COVID-19","Lung and Other Severe Cancers","Severe Hematological Disorders","Major Psychiatric Disorders","Stroke","Fibrosis of Lung or Other Chronic Lung Disorders","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Respirator Dependence/Tracheostomy Status","Dialysis Status"],"N":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32],"Count":[2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,12,10,9,9,9,8,8,8,7,6,6,6,5,4,4,3,3,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,18,17,17,16,15,14,14,13,12,12,10,9,8,8,6,6,6,5,5,5,4,3,3,3,2,2,2,2,2,1,1,0,0,0,0,0,0,29,23,19,13,12,12,10,9,7,7,7,6,4,3,3,3,2,2,2,1,1,1,1,1,1,0,0,0,0,0,0,0,0,25,24,22,19,17,16,15,13,13,11,11,11,10,9,9,8,8,8,8,7,7,6,5,5,4,4,4,3,3,2,2,1,1,1,1,1,1,1,0,0,0],"Rate":[1,1,1,1,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.833333333333333,0.666666666666667,0.555555555555556,0.5,0.5,0.5,0.444444444444444,0.444444444444444,0.444444444444444,0.388888888888889,0.333333333333333,0.333333333333333,0.333333333333333,0.277777777777778,0.222222222222222,0.222222222222222,0.166666666666667,0.166666666666667,0.111111111111111,0.111111111111111,0.111111111111111,0.111111111111111,0.111111111111111,0.111111111111111,0.0555555555555556,0.0555555555555556,0.0555555555555556,0.0555555555555556,0.0555555555555556,0.0555555555555556,0.0555555555555556,0.0555555555555556,0.0555555555555556,0,0,0,0,0,0,0,0.72,0.68,0.68,0.64,0.6,0.56,0.56,0.52,0.48,0.48,0.4,0.36,0.32,0.32,0.24,0.24,0.24,0.2,0.2,0.2,0.16,0.12,0.12,0.12,0.08,0.08,0.08,0.08,0.08,0.04,0.04,0,0,0,0,0,0,0.644444444444444,0.511111111111111,0.422222222222222,0.288888888888889,0.266666666666667,0.266666666666667,0.222222222222222,0.2,0.155555555555556,0.155555555555556,0.155555555555556,0.133333333333333,0.0888888888888889,0.0666666666666667,0.0666666666666667,0.0666666666666667,0.0444444444444444,0.0444444444444444,0.0444444444444444,0.0222222222222222,0.0222222222222222,0.0222222222222222,0.0222222222222222,0.0222222222222222,0.0222222222222222,0,0,0,0,0,0,0,0,0.78125,0.75,0.6875,0.59375,0.53125,0.5,0.46875,0.40625,0.40625,0.34375,0.34375,0.34375,0.3125,0.28125,0.28125,0.25,0.25,0.25,0.25,0.21875,0.21875,0.1875,0.15625,0.15625,0.125,0.125,0.125,0.09375,0.09375,0.0625,0.0625,0.03125,0.03125,0.03125,0.03125,0.03125,0.03125,0.03125,0,0,0]},"columns":[{"id":"Cohort","name":"Cohort","type":"character"},{"id":"Factor","name":"Risk Factor","type":"character"},{"id":"N","name":"Discharge Count","type":"numeric"},{"id":"Count","name":"Count","type":"numeric"},{"id":"Rate","name":"Percent","type":"numeric","format":{"cell":{"digits":1,"percent":true},"aggregated":{"digits":1,"percent":true}}}],"columnGroups":[{"name":"Risk Factor Prevalence","columns":["Count","Rate"]}],"groupBy":["Cohort"],"resizable":true,"filterable":true,"searchable":true,"dataKey":"517ed1869ca3b676da7ccde083b9b408"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="net-factor-influence" class="level3">
<h3 class="anchored" data-anchor-id="net-factor-influence">Net Factor Influence</h3>
<p>We can then combine the two concepts above (model weights + risk factor prevalence) to explore which factors may have the most overall impact. One way to quantify this is by computing the total weight of a risk factor by taking the number of patients with the risk factor multiplied by the model weight.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>prevalence <span class="sc">|&gt;</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join to get model weight</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> model_weights,</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> </span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Cohort"</span>,</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Factor"</span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make total weight</span></span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">NetImpact =</span> <span class="fu">abs</span>(Count <span class="sc">*</span> Value)</span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arrange</span></span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(Cohort, <span class="fu">desc</span>(NetImpact)) <span class="sc">|&gt;</span></span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(NetImpact, <span class="at">.after =</span> Factor) <span class="sc">|&gt;</span></span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make a table</span></span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reactable</span>(</span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">groupBy =</span> <span class="st">"Cohort"</span>,</span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> </span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">Factor =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Risk Factor"</span>),</span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">NetImpact =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Net Impact"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">2</span>)),</span>
<span id="cb107-29"><a href="#cb107-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">N =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Discharge Count"</span>),</span>
<span id="cb107-30"><a href="#cb107-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">Count =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Count"</span>),</span>
<span id="cb107-31"><a href="#cb107-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">Rate =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Percent"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">1</span>, <span class="at">percent =</span> <span class="cn">TRUE</span>))</span>
<span id="cb107-32"><a href="#cb107-32" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb107-33"><a href="#cb107-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">columnGroups =</span> </span>
<span id="cb107-34"><a href="#cb107-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb107-35"><a href="#cb107-35" aria-hidden="true" tabindex="-1"></a>        <span class="fu">colGroup</span>(</span>
<span id="cb107-36"><a href="#cb107-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">name =</span> <span class="st">"Risk Factor Prevalence"</span>,</span>
<span id="cb107-37"><a href="#cb107-37" aria-hidden="true" tabindex="-1"></a>          <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Count"</span>, <span class="st">"Rate"</span>)</span>
<span id="cb107-38"><a href="#cb107-38" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb107-39"><a href="#cb107-39" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb107-40"><a href="#cb107-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">searchable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb107-41"><a href="#cb107-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb107-42"><a href="#cb107-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">filterable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb107-43"><a href="#cb107-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">resizable =</span> <span class="cn">TRUE</span></span>
<span id="cb107-44"><a href="#cb107-44" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-10475ca61a11461d485d" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-10475ca61a11461d485d">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Cohort":["AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN"],"Factor":["Renal Failure","Iron Deficiency or Other/Unspecified Anemias and Blood Disease","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Congestive Heart Failure","Male","Chronic Obstructive Pulmonary Disease (COPD)","Diabetes Mellitus (DM) or DM Complications","Specified Arrhythmias and Other Heart Rhythm Disorders","Coronary Atherosclerosis/ Other Chronic Ischemic Heart Disease","Severe Infection; Other Infectious Diseases","Other Urinary Tract Disorders","History of Coronary Artery Bypass Graft (CABG) Surgery","History of Percutaneous Transluminal Coronary Angioplasty (PTCA)","Asthma","Dementia or Other Specified Brain Disorders","Anterior Myocardial Infarction ","Non-Anterior Location of Myocardial Infarction","History of COVID-19","Metastatic Cancer and Acute Leukemia","Cancer","Protein-Calorie Malnutrition","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Acute Coronary Syndrome","Angina Pectoris","Valvular and Rheumatic Heart Disease","Stroke","Cerebrovascular Disease","Vascular or Circulatory Disease","Pneumonia","Dialysis Status","Decubitus Ulcer or Chronic Skin Ulcer","Cardio-respiratory Failure and Shock","Congestive Heart Failure","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Iron Deficiency or Other/Unspecified Anemias and Blood Disease","Renal Failure","Specified Arrhythmias and Other Heart Rhythm Disorders","Other Gastrointestinal Disorders","Diabetes Mellitus (DM) or DM Complications","History of Mechanical Ventilation","Vascular or Circulatory Disease","Pneumonia","Other Psychiatric Disorders","Drug/Alcohol Psychosis or Dependence","Morbid Obesity; Other Endocrine/ Metabolic/ Nutritional Disorders","Polyneuropathy; Other Neuropathies","Anxiety Disorders","Metastatic Cancer and Acute Leukemia","Acute Coronary Syndrome","Other and Unspecified Heart Disease","Protein-Calorie Malnutrition","Depression","Sleep-Disordered Breathing","Severe Infection; Other Infectious Diseases","Coronary Atherosclerosis or Angina","Peptic Ulcer, Hemorrhage, Other Specified Gastrointestinal Disorders","Vertebral Fractures Without Spinal Cord Injury","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Major Psychiatric Disorders","Cellulitis, Local Skin Infection","History of COVID-19","Lymphatic, Head and Neck, Brain, and Other Major Cancers; Breast, Colorectal and Other Cancers and Tumors; Other Respiratory and Heart Neoplasms","Dementia or Other Specified Brain Disorders","Respirator Dependence/Respiratory Failure","Lung and Other Severe Cancers","Other Digestive and Urinary Neoplasms","Chronic Pancreatitis","Severe Hematological Disorders","Stroke","Fibrosis of Lung or Other Chronic Lung Disorders","Decubitus Ulcer or Chronic Skin Ulcer","Renal Failure","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Iron Deficiency or Other/Unspecified Anemias and Blood Disease","Specified Arrhythmias and Other Heart Rhythm Disorders","Congestive Heart Failure","Chronic Obstructive Pulmonary Disease (COPD)","Diabetes Mellitus (DM) or DM Complications","Cardio-Respiratory Failure and Shock","Other Gastrointestinal Disorders","Coronary Atherosclerosis or Angina","Valvular and Rheumatic Heart Disease","Vascular or Circulatory Disease","Pneumonia","Liver or Biliary Disease","Male","Other Psychiatric Disorders","Acute Coronary Syndrome","Drug/Alcohol Abuse/ Dependence/Psychosis","Other Urinary Tract Disorders","Decubitus Ulcer or Chronic Skin Ulcer","Other and Unspecified Heart Disease","Peptic Ulcer, Hemorrhage, Other Specified Gastrointestinal Disorders","Depression","Fibrosis of Lung or Other Chronic Lung Disorders","History of Coronary Artery Bypass Graft (CABG) Surgery","Protein-Calorie Malnutrition","Stroke","Major Psychiatric Disorders","Dementia or Other Specified Brain Disorders","Cancer","Asthma","History of COVID-19","Metastatic Cancer and Acute Leukemia","Severe Hematological Disorders","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Dialysis Status","Nephritis","Hypertension","Male","Major Symptoms, Abnormalities","Specified Arrhythmias and Other Heart Rhythm Disorders","Renal Failure","Chronic Obstructive Pulmonary Disease (COPD)","Other Injuries","Index Admissions with an Elective THA Procedure","Morbid Obesity","Diabetes Mellitus (DM) or DM Complications","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Congestive Heart Failure","Polyneuropathy; Other Neuropathies","Rheumatoid Arthritis and Inflammatory Connective Tissue Disease","Coronary Atherosclerosis or Angina","Vascular or Circulatory Disease","Severe Hematological Disorders","Pneumonia","Cellulitis, Local Skin Infection","Protein-Calorie Malnutrition","Number of Procedures (two vs. one)","Severe Infection; Other Infectious Diseases","Stroke","Metastatic Cancer and Acute Leukemia","Cancer","Other Congenital Deformity of Hip (Joint)","Post Traumatic Osteoarthritis","History of COVID-19","Dementia or Other Specified Brain Disorders","Major Psychiatric Disorders","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Dialysis Status","Decubitus Ulcer or Chronic Skin Ulcer","Iron Deficiency or Other/Unspecified Anemias and Blood Disease","Congestive Heart Failure","Chronic Obstructive Pulmonary Disease (COPD)","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Specified Arrhythmias and Other Heart Rhythm Disorders","Renal Failure","Respiratory Arrest; Cardio-Respiratory Failure and Shock","Pleural Effusion/Pneumothorax","Pneumonia","Other Gastrointestinal Disorders","Diabetes Mellitus (DM) or DM Complications","Decubitus Ulcer or Chronic Skin Ulcer","Male","Septicemia, Sepsis, Systemic Inflammatory Response Syndrome/Shock","Vascular or Circulatory Disease","Other Psychiatric Disorders","Valvular and Rheumatic Heart Disease","Protein-Calorie Malnutrition","Metastatic Cancer and Acute Leukemia","Other Respiratory Disorders","Severe Hematological Disorders","Coronary Atherosclerosis or Angina","Urinary Tract Infection","Lymphoma; Other Cancers","Severe Infection; Other Infectious Diseases","Drug/Alcohol Abuse/Dependence/Psychosis","Acute Coronary Syndrome","Other Urinary Tract Disorders","Lung and Other Severe Cancers","Fibrosis of Lung or Other Chronic Lung Disorders","Other Injuries","Vertebral Fractures Without Spinal Cord Injury","History of COVID-19","Asthma","Dementia or Other Specified Brain Disorders","History of Coronary Artery Bypass Graft (CABG) Surgery","Stroke","Major Psychiatric Disorders","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Respirator Dependence/Tracheostomy Status","Dialysis Status"],"NetImpact":[0.5235426179157,0.44931704584918,0.37457404224014,0.33957243074671,0.2675418959465,0.20889600190574,0.18363519022453,0.12834192882491,0.10175224371917,0.08324200070107,0.07545016852382,0.02331580008699,0.02178937903037,0.01695937962873,0.00703750490067,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3.3057268498572,2.1954742139943,1.7681007960757,1.64952489626271,1.12027563857762,0.96649803843576,0.74251967209893,0.7125267381168,0.58561614312928,0.4870209378212,0.47730649517424,0.45571865494295,0.32890076470614,0.28660856894856,0.25724789661704,0.24985511429454,0.20104445264549,0.16739506872294,0.1430754784877,0.14281362472359,0.13880072962548,0.13557895240552,0.11424105848721,0.09809135497948,0.08820129638075,0.08224193320365,0.05564420968061,0.04427640612473,0.04118173223991,0.04007963693594,0.0137186203552,0.01206184755198,0.01120929463448,0,0,0,0,0,0,0,3.56546721921474,2.4383505700119,2.1258534531899,1.7428735116513,1.7282357960685,1.27416604020528,1.16132577864612,0.96826138209712,0.96101538096801,0.82428417748222,0.7058646898766,0.64673166347136,0.58446602743255,0.43251107535505,0.43040705612184,0.40632600571668,0.29370833724054,0.27436647425115,0.26769028758744,0.22785324193658,0.21622359036498,0.1447041361696,0.12331229689752,0.10826897466488,0.0993201327659,0.08560777795158,0.06368060112146,0.05023391795846,0.03902193261168,0.03787959257955,0.00404853256189,0,0,0,0,0,0,4.15515357713177,2.80663141711267,2.19159538489132,2.085236576967,2.05192302232266,1.78362196987359,1.70979743927568,1.6317044297896,1.56089823750301,1.55758461575483,1.47259366374654,1.08929546199,0.59409163989952,0.41806676650431,0.39300612173646,0.32978389909893,0.29881994243779,0.29212209910216,0.13988994687991,0.13277839169882,0.1286610446364,0.0901654992735,0.08923188109521,0.0799645208149,0.042743700362,0,0,0,0,0,0,0,0,2.72920525222545,2.52488592892445,2.49645653824717,2.3597881535932,1.59646856993392,1.39794309865727,1.310220990912,1.1242112991375,1.0709471281501,1.04983932136549,0.99049161812656,0.69790924724682,0.58479638107248,0.47421530677304,0.46721989463229,0.40644881804569,0.39193175813216,0.36588714503394,0.35654133907178,0.30633742233198,0.26359064734308,0.2628246319412,0.2614979633892,0.25323892804701,0.24427408030992,0.24315227518572,0.21317320861923,0.17082178184452,0.12270154741653,0.10848046835409,0.09838461213966,0.07872272430396,0.0767024905464,0.0381856296621,0.03243113073984,0.02980557296489,0.02877533874591,0.0184252173479,0,0,0],"N":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32],"Count":[2,2,2,1,2,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,9,10,9,7,6,9,8,2,8,6,5,2,12,8,3,1,2,2,1,6,4,3,2,1,1,1,1,1,2,4,1,1,0,0,0,0,0,0,0,14,15,14,18,17,8,12,16,17,13,10,9,5,5,12,6,3,3,6,2,6,2,8,2,5,1,2,2,4,3,1,0,0,0,0,0,0,29,19,23,12,9,7,12,10,7,13,6,4,7,3,3,3,1,2,1,1,1,2,1,1,2,0,0,0,0,0,0,0,0,15,13,19,22,16,11,25,7,10,17,11,6,24,4,9,7,8,3,2,13,1,8,5,9,8,4,3,4,1,1,11,2,1,5,8,1,1,1,0,0,0],"Rate":[1,1,1,0.5,1,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.833333333333333,0.5,0.555555555555556,0.5,0.388888888888889,0.333333333333333,0.5,0.444444444444444,0.111111111111111,0.444444444444444,0.333333333333333,0.277777777777778,0.111111111111111,0.666666666666667,0.444444444444444,0.166666666666667,0.0555555555555556,0.111111111111111,0.111111111111111,0.0555555555555556,0.333333333333333,0.222222222222222,0.166666666666667,0.111111111111111,0.0555555555555556,0.0555555555555556,0.0555555555555556,0.0555555555555556,0.0555555555555556,0.111111111111111,0.222222222222222,0.0555555555555556,0.0555555555555556,0,0,0,0,0,0,0,0.56,0.6,0.56,0.72,0.68,0.32,0.48,0.64,0.68,0.52,0.4,0.36,0.2,0.2,0.48,0.24,0.12,0.12,0.24,0.08,0.24,0.08,0.32,0.08,0.2,0.04,0.08,0.08,0.16,0.12,0.04,0,0,0,0,0,0,0.644444444444444,0.422222222222222,0.511111111111111,0.266666666666667,0.2,0.155555555555556,0.266666666666667,0.222222222222222,0.155555555555556,0.288888888888889,0.133333333333333,0.0888888888888889,0.155555555555556,0.0666666666666667,0.0666666666666667,0.0666666666666667,0.0222222222222222,0.0444444444444444,0.0222222222222222,0.0222222222222222,0.0222222222222222,0.0444444444444444,0.0222222222222222,0.0222222222222222,0.0444444444444444,0,0,0,0,0,0,0,0,0.46875,0.40625,0.59375,0.6875,0.5,0.34375,0.78125,0.21875,0.3125,0.53125,0.34375,0.1875,0.75,0.125,0.28125,0.21875,0.25,0.09375,0.0625,0.40625,0.03125,0.25,0.15625,0.28125,0.25,0.125,0.09375,0.125,0.03125,0.03125,0.34375,0.0625,0.03125,0.15625,0.25,0.03125,0.03125,0.03125,0,0,0],"Value":[0.26177130895785,0.22465852292459,0.18728702112007,0.33957243074671,-0.13377094797325,0.20889600190574,0.18363519022453,0.12834192882491,0.10175224371917,0.08324200070107,0.07545016852382,0.02331580008699,-0.02178937903037,0.01695937962873,0.00703750490067,0.27100275921083,0.07120286291483,-0.0676429056577,0.22634890641462,0.04401442147305,0.14477909636915,0.14174229352292,0.0297614483081,0.02729795306472,0.09968987228144,0.04570363659622,0.05614466547329,0.09943077750067,0.16362948864226,0.25127110061188,0.11440519285484,0.22038178999048,0.2439415793327,0.17681007960757,0.18328054402919,0.16003937693966,0.16108300640596,0.08250218578877,0.0890658422646,0.29280807156464,0.06087761722765,0.07955108252904,0.09114373098859,0.16445038235307,-0.02388404741238,0.03215598707713,0.08328503809818,0.20104445264549,0.08369753436147,0.07153773924385,0.14281362472359,0.02313345493758,-0.03389473810138,0.03808035282907,0.04904567748974,0.08820129638075,0.08224193320365,0.05564420968061,0.04427640612473,0.04118173223991,-0.02003981846797,-0.0034296550888,0.01206184755198,0.01120929463448,0.15641571251929,-0.07920807606545,0.06293681682419,0.14811373057356,-0.00864104299739,0.09533030999425,0.07294989023911,0.25467622994391,0.16255670466746,0.15184667522785,0.09682630620285,0.1016609291805,0.15927075502566,0.09677714822051,0.06051633638107,0.05653031652753,0.06340647519094,0.07058646898766,0.07185907371904,0.11689320548651,0.08650221507101,-0.03586725467682,0.06772100095278,0.09790277908018,0.09145549141705,0.04461504793124,0.11392662096829,0.03603726506083,0.0723520680848,0.01541403711219,0.05413448733244,0.01986402655318,0.08560777795158,0.03184030056073,0.02511695897923,0.00975548315292,0.01262653085985,0.00404853256189,-0.00239294251728,0.14874300720604,0.23762950955586,0.0742789500502,0.15063453076202,0.05285914464513,0.14328115783213,0.14771744300593,0.09528675586484,0.17376971474725,0.22799144692474,0.25480313855337,0.14248311993964,0.16317044297896,0.22298546250043,0.11981420121191,0.24543227729109,0.2723238654975,0.08487023427136,0.13935558883477,0.13100204057882,0.10992796636631,0.29881994243779,0.14606104955108,0.13988994687991,0.13277839169882,0.1286610446364,0.04508274963675,0.08923188109521,0.0799645208149,-0.021371850181,0.28564566526498,-1.52018641e-05,-0.02583679305955,0.15538492166378,0.23494388360546,0.1224436188646,0.5978782174907,0.20960556510495,0.18194701681503,0.19422199453265,0.13139244938143,0.1072630978906,0.09977928562087,0.12708573624157,0.05240883963648,0.1606016141625,0.10709471281501,0.06175525419797,0.09004469255696,0.11631820787447,0.02436651587802,0.11855382669326,0.05191332162581,0.05806411686367,0.04899146976652,0.12196238167798,0.17827066953589,0.02356441710246,0.26359064734308,0.03285307899265,0.05229959267784,0.02813765867189,0.03053426003874,0.06078806879643,0.07105773620641,0.04270544546113,0.12270154741653,0.10848046835409,0.00894405564906,0.03936136215198,-0.0767024905464,-0.00763712593242,-0.00405389134248,-0.02980557296489,0.02877533874591,0.0184252173479,0.11023929530957,0.17600014087344,0.24009331029806]},"columns":[{"id":"Cohort","name":"Cohort","type":"character"},{"id":"Factor","name":"Risk Factor","type":"character"},{"id":"NetImpact","name":"Net Impact","type":"numeric","format":{"cell":{"digits":2},"aggregated":{"digits":2}}},{"id":"N","name":"Discharge Count","type":"numeric"},{"id":"Count","name":"Count","type":"numeric"},{"id":"Rate","name":"Percent","type":"numeric","format":{"cell":{"digits":1,"percent":true},"aggregated":{"digits":1,"percent":true}}},{"id":"Value","name":"Value","type":"numeric"}],"columnGroups":[{"name":"Risk Factor Prevalence","columns":["Count","Rate"]}],"groupBy":["Cohort"],"resizable":true,"filterable":true,"searchable":true,"dataKey":"e32991bf80ecaa70061e95ab294ab68b"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>If you scan through the table you’ll notice that the risk factors that have the highest model weight or highest prevalence are not necessarily the ones with the most net impact.</p>
<p>Finally, we could put these in a plot:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>prevalence <span class="sc">|&gt;</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join to get model weight</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> model_weights,</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> </span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Cohort"</span>,</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Factor"</span></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> Count,</span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">exp</span>(Value),</span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> Cohort</span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Cohort, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">nrow =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Risk Factor Count"</span>) <span class="sc">+</span></span>
<span id="cb108-26"><a href="#cb108-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Odds Ratio"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Points that are closer to the upper-right quadrant are the most influential. Of course, it would be useful to add interactivity to these plots (e.g., with <code>plotly</code>) as to provide the user ability to scan and view what risk factor each point represents, but you get the idea.</p>
</section>
</section>
<section id="other-analyses" class="level2">
<h2 class="anchored" data-anchor-id="other-analyses">3. Other Analyses</h2>
<p>There are many other possible questions that can be answered analyzing an HSR that can be useful for better understand HRRP program results. We’ll list a few more ideas here without actually doing them:</p>
<section id="diagnosis-comparison" class="level3">
<h3 class="anchored" data-anchor-id="diagnosis-comparison">Diagnosis Comparison</h3>
<p>In the discharge reports, CMS supplies the diagnosis code the patient received that led their index discharge to be included in the program. For those who are readmitted, also supplied in this table are the diagnosis codes received at their readmission stay. These can be accessed with the <code>hsr_discharges()</code> function and extracting the appropriate columns. Here’s an example doing this for the HF cohort:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hsr_discharges</span>(</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> my_report,</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cohort =</span> <span class="st">"HF"</span>,</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">eligible_only =</span> <span class="cn">TRUE</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Keep diagnosis columns</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(dplyr<span class="sc">::</span><span class="fu">matches</span>(<span class="st">"Diagnosis"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Aggregate</span></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> dplyr<span class="sc">::</span><span class="fu">everything</span>()</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(N))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 3
  `Principal Discharge Diagnosis of Index Stay` Principal Discharge Diag…¹     N
  &lt;chr&gt;                                         &lt;chr&gt;                      &lt;int&gt;
1 I110                                          &lt;NA&gt;                          12
2 I130                                          &lt;NA&gt;                           5
3 I5033                                         &lt;NA&gt;                           2
4 I5033                                         I130                           1
5 I130                                          A0472                          1
6 I132                                          U071                           1
7 I509                                          &lt;NA&gt;                           1
8 I5023                                         &lt;NA&gt;                           1
9 I5043                                         &lt;NA&gt;                           1
# ℹ abbreviated name: ¹​`Principal Discharge Diagnosis of Readmission`</code></pre>
</div>
</div>
<p>This can be extremely useful to understand (a) which diagnoses are leading to cohort inclusion to begin with, and (b) why the patient came back. Sometimes there may be readmissions that are completely unrelated to the index diagnosis.</p>
</section>
<section id="outside-hospital-readmissions" class="level3">
<h3 class="anchored" data-anchor-id="outside-hospital-readmissions">Outside Hospital Readmissions</h3>
<p>Since CMS enforces the HRRP, hospitals get penalized for readmissions that don’t even occur at their hospital. If a patient is discharged from your hospital and subsequently readmitted somewhere else, it still counts as <em>your</em> readmission. Thus it is useful to understand the rate of readmissions that are back in your own system versus somewhere else. This is provided the HSR as well.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hsr_discharges</span>(</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> my_report,</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cohort =</span> <span class="st">"HF"</span>,</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">eligible_only =</span> <span class="cn">TRUE</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Keep diagnosis columns</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(dplyr<span class="sc">::</span><span class="fu">matches</span>(<span class="st">"Same Hospital"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make a table</span></span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>(<span class="at">useNA =</span> <span class="st">"ifany"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Readmission to Same Hospital (Yes/No)
  No  Yes &lt;NA&gt; 
   2    1   22 </code></pre>
</div>
</div>
<p>For example, of the 22 HF discharges, three (3) were readmitted: one (1) to the same hospital as the index stay, and two (2) elsewhere (maybe within your system, or not).</p>
</section>
<section id="benchmarking-with-other-hospitals" class="level3">
<h3 class="anchored" data-anchor-id="benchmarking-with-other-hospitals">Benchmarking With Other Hospitals</h3>
<p>CMS provides access to hospital-level performance data on <a href="https://data.cms.gov/provider-data/">QualityNet</a>. You can use the <code>pdc_*</code> functions in this package to explore and import various data files to perform comparative analyses at the hospital level (see <code>pdc_read()</code>).</p>
<p><em>Don’t forget to <a href="https://dashboard.mailerlite.com/forms/1517199/154300987644839168/share">subscribe</a> to receive email updates when new articles drop!</em></p>


<!-- -->

</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/www\.zajichekstats\.com\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb113" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Investigating a Hospital-Specific Report (HSR)"</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Analysis strategies to gain insight into HRRP program results"</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Alex Zajichek"</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "12/26/2025"</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> "feature.png"</span></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="co">  - Software Development</span></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a><span class="co">  - Healthcare</span></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a>_This article is a copy of the [`readmit`](https://centralstatz.github.io/readmit/index.html) package tutorial. See it on the package website [here](https://centralstatz.github.io/readmit/articles/investigating-an-hsr.html)._</span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a>_**Note**: CMS changed the format of Hospital-Specific Reports (HSRs) for FY2026 (see [here](https://qualitynet.cms.gov/inpatient/hrrp/reports#tab2)). The current HSR functions support Excel-based formats through FY2025. However, analysis strategies are still relevant._</span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a>As part of the <span class="co">[</span><span class="ot">Hospital Readmissions Reduction Program (HRRP)</span><span class="co">](https://www.cms.gov/medicare/payment/prospective-payment-systems/acute-inpatient-pps/hospital-readmissions-reduction-program-hrrp)</span>, the <span class="co">[</span><span class="ot">Centers for Medicare &amp; Medicaid Services (CMS)</span><span class="co">](https://www.cms.gov/)</span> provides a detailed, annual program summary report (called the <span class="co">[</span><span class="ot">Hospital-Specific Report (HSR)</span><span class="co">](https://qualitynet.cms.gov/inpatient/hrrp/reports)</span>) to hospitals that includes details on the penalty calculation for the upcoming fiscal year, such as discharge-level data, dually-eligible discharge lists, cohort-level rollup, and the penalty amount. There is a defined <span class="co">[</span><span class="ot">review and correction period</span><span class="co">]</span>(https://qualitynet.cms.gov/inpatient/hrrp/resources#tab1:~:text=FY%202026%20Hospital%20Readmissions%20Reduction%20Program%20Key%20Dates%20(08/11/25)) in which hospitals can use these reports to ensure the penalty being enforced by CMS is accurate. It occurs approximately 1 month before the new fiscal year, thus it is a time-critical event (see historical date ranges below for reference with the built-in package datasets):</span>
<span id="cb113-22"><a href="#cb113-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-25"><a href="#cb113-25" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-26"><a href="#cb113-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract date ranges</span></span>
<span id="cb113-27"><a href="#cb113-27" aria-hidden="true" tabindex="-1"></a>readmit<span class="sc">::</span>hrrp_keydates <span class="sc">|&gt;</span></span>
<span id="cb113-28"><a href="#cb113-28" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb113-29"><a href="#cb113-29" aria-hidden="true" tabindex="-1"></a>    ProgramYear,</span>
<span id="cb113-30"><a href="#cb113-30" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">matches</span>(<span class="st">"^(Payment|Review)"</span>)</span>
<span id="cb113-31"><a href="#cb113-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb113-32"><a href="#cb113-32" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>()</span>
<span id="cb113-33"><a href="#cb113-33" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-34"><a href="#cb113-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-35"><a href="#cb113-35" aria-hidden="true" tabindex="-1"></a>The report file itself (through FY2025) is a large, multi-tab Microsoft Excel document where the structured part of the data is ambiguously placed throughout, thus we need tools to parse it out into a usable format. That is what some functions in the <span class="in">`readmit`</span> package are for. In this article, we go through the tools that are available, what they do, and then provide some strategies/approaches for how hospitals can use these tools to analyze their own HSR's to gain deeper insight into HRRP results and readmissions more broadly.</span>
<span id="cb113-36"><a href="#cb113-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-37"><a href="#cb113-37" aria-hidden="true" tabindex="-1"></a><span class="fu"># The Toolbox</span></span>
<span id="cb113-38"><a href="#cb113-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-39"><a href="#cb113-39" aria-hidden="true" tabindex="-1"></a>First, we'll start by taking a look at what relevant functions are available to us, what they do, and how to use them. For our purposes, these are all of the functions prefixed like <span class="in">`hsr_*`</span>. We'll do this roughly in order of how the report is laid out, and how the HRRP results roll up.</span>
<span id="cb113-40"><a href="#cb113-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-43"><a href="#cb113-43" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-44"><a href="#cb113-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readmit)</span>
<span id="cb113-45"><a href="#cb113-45" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-46"><a href="#cb113-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-47"><a href="#cb113-47" aria-hidden="true" tabindex="-1"></a><span class="fu">## 0. Mock Reports</span></span>
<span id="cb113-48"><a href="#cb113-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-49"><a href="#cb113-49" aria-hidden="true" tabindex="-1"></a>As the developer of this package, I don't have access to hospitals' actual HSR's, as they contain senstivie patient information (i.e., <span class="co">[</span><span class="ot">PHI</span><span class="co">](https://cphs.berkeley.edu/hipaa/hipaa18.html)</span>) and thus are not publicly available. So what we have to work with are _mock_ reports that <span class="co">[</span><span class="ot">CMS provides</span><span class="co">](https://qualitynet.cms.gov/inpatient/hrrp/reports#tab3)</span> to the public that are meant to mimick the format a hospital can expect their report to be in. It just includes fake data.</span>
<span id="cb113-50"><a href="#cb113-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-51"><a href="#cb113-51" aria-hidden="true" tabindex="-1"></a>_**Note**: CMS changed the format of Hospital-Specific Reports (HSRs) for FY2026 (see [here](https://qualitynet.cms.gov/inpatient/hrrp/reports#tab2)). The current HSR functions support Excel-based formats through FY2025._</span>
<span id="cb113-52"><a href="#cb113-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-53"><a href="#cb113-53" aria-hidden="true" tabindex="-1"></a>Nevertheless, these provide a useful playground to analyze the mechanics of the program. We'll start by finding a report with the <span class="in">`hsr_mock_reports()`</span> function:</span>
<span id="cb113-54"><a href="#cb113-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-55"><a href="#cb113-55" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Using no arguments lists the various mock files included in the package</span>
<span id="cb113-56"><a href="#cb113-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-59"><a href="#cb113-59" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-60"><a href="#cb113-60" aria-hidden="true" tabindex="-1"></a><span class="fu">hsr_mock_reports</span>()</span>
<span id="cb113-61"><a href="#cb113-61" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-62"><a href="#cb113-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-63"><a href="#cb113-63" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Entering one of the listed file names will return the complete path to the file in the packages location on your computer</span>
<span id="cb113-64"><a href="#cb113-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-67"><a href="#cb113-67" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-68"><a href="#cb113-68" aria-hidden="true" tabindex="-1"></a>my_report <span class="ot">&lt;-</span> <span class="fu">hsr_mock_reports</span>(<span class="st">"FY2025_HRRP_MockHSR.xlsx"</span>)</span>
<span id="cb113-69"><a href="#cb113-69" aria-hidden="true" tabindex="-1"></a>my_report</span>
<span id="cb113-70"><a href="#cb113-70" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-71"><a href="#cb113-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-72"><a href="#cb113-72" aria-hidden="true" tabindex="-1"></a>Now we can use that HSR path with other package functions. Of course, you would just point to your own HSR when analyzing your hospital's reports.</span>
<span id="cb113-73"><a href="#cb113-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-74"><a href="#cb113-74" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1. Program Summary {#programsummary}</span></span>
<span id="cb113-75"><a href="#cb113-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-76"><a href="#cb113-76" aria-hidden="true" tabindex="-1"></a>We'll start with high level program results. Ultimately, all of the moving parts in the HRRP roll up into a single number: the penalty amount applied to your hospital. This is typically the first table in your report. We can parse it out of the report with the <span class="in">`hsr_payment_summary()`</span> function:</span>
<span id="cb113-77"><a href="#cb113-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-80"><a href="#cb113-80" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-81"><a href="#cb113-81" aria-hidden="true" tabindex="-1"></a>my_payment_summary <span class="ot">&lt;-</span> <span class="fu">hsr_payment_summary</span>(my_report)</span>
<span id="cb113-82"><a href="#cb113-82" aria-hidden="true" tabindex="-1"></a>my_payment_summary</span>
<span id="cb113-83"><a href="#cb113-83" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-84"><a href="#cb113-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-85"><a href="#cb113-85" aria-hidden="true" tabindex="-1"></a>We now have this information in a data frame that we can manipulate as needed:</span>
<span id="cb113-86"><a href="#cb113-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-89"><a href="#cb113-89" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-90"><a href="#cb113-90" aria-hidden="true" tabindex="-1"></a>my_payment_summary <span class="sc">|&gt;</span></span>
<span id="cb113-91"><a href="#cb113-91" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(dplyr<span class="sc">::</span><span class="fu">everything</span>())</span>
<span id="cb113-92"><a href="#cb113-92" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-93"><a href="#cb113-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-94"><a href="#cb113-94" aria-hidden="true" tabindex="-1"></a>There are also helper functions to extract specific components from this table.</span>
<span id="cb113-95"><a href="#cb113-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-98"><a href="#cb113-98" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-99"><a href="#cb113-99" aria-hidden="true" tabindex="-1"></a><span class="fu">hsr_payment_penalty</span>(my_report)</span>
<span id="cb113-100"><a href="#cb113-100" aria-hidden="true" tabindex="-1"></a><span class="fu">hsr_dual_proportion</span>(my_report)</span>
<span id="cb113-101"><a href="#cb113-101" aria-hidden="true" tabindex="-1"></a><span class="fu">hsr_peer_group</span>(my_report)</span>
<span id="cb113-102"><a href="#cb113-102" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-103"><a href="#cb113-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-104"><a href="#cb113-104" aria-hidden="true" tabindex="-1"></a>See <span class="in">`?hsr_payment_summary`</span> for all of them.</span>
<span id="cb113-105"><a href="#cb113-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-106"><a href="#cb113-106" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2. Cohort Summary {#cohortsummary}</span></span>
<span id="cb113-107"><a href="#cb113-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-108"><a href="#cb113-108" aria-hidden="true" tabindex="-1"></a>The overall payment penalty a hospital receives is a weighted average of penalities applied to the individual cohorts. These details are typically in the second table (tab) of the HSR, which we can import with <span class="in">`hsr_cohort_summary()`</span>:</span>
<span id="cb113-109"><a href="#cb113-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-112"><a href="#cb113-112" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-113"><a href="#cb113-113" aria-hidden="true" tabindex="-1"></a>cohort_summary <span class="ot">&lt;-</span> <span class="fu">hsr_cohort_summary</span>(my_report)</span>
<span id="cb113-114"><a href="#cb113-114" aria-hidden="true" tabindex="-1"></a>cohort_summary</span>
<span id="cb113-115"><a href="#cb113-115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-116"><a href="#cb113-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-117"><a href="#cb113-117" aria-hidden="true" tabindex="-1"></a>We can then, for example, reconcile the overall penalty amount based on what is in this table:</span>
<span id="cb113-118"><a href="#cb113-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-121"><a href="#cb113-121" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-122"><a href="#cb113-122" aria-hidden="true" tabindex="-1"></a>cohort_summary <span class="sc">|&gt;</span></span>
<span id="cb113-123"><a href="#cb113-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-124"><a href="#cb113-124" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter to cohorts with a penalty</span></span>
<span id="cb113-125"><a href="#cb113-125" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="st">`</span><span class="at">Penalty Indicator (Yes/No) [h]</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">|&gt;</span></span>
<span id="cb113-126"><a href="#cb113-126" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-127"><a href="#cb113-127" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute the contribution of each penalized cohort</span></span>
<span id="cb113-128"><a href="#cb113-128" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb113-129"><a href="#cb113-129" aria-hidden="true" tabindex="-1"></a>    <span class="at">Contribution =</span> </span>
<span id="cb113-130"><a href="#cb113-130" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Ratio of DRG Payments Per Measure to Total Payments [i]</span><span class="st">`</span> <span class="sc">*</span></span>
<span id="cb113-131"><a href="#cb113-131" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb113-132"><a href="#cb113-132" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Excess Readmission Ratio (ERR) [f]</span><span class="st">`</span> <span class="sc">-</span> </span>
<span id="cb113-133"><a href="#cb113-133" aria-hidden="true" tabindex="-1"></a>          <span class="st">`</span><span class="at">Peer Group Median ERR [g]</span><span class="st">`</span></span>
<span id="cb113-134"><a href="#cb113-134" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb113-135"><a href="#cb113-135" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb113-136"><a href="#cb113-136" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-137"><a href="#cb113-137" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Roll up into final calculation</span></span>
<span id="cb113-138"><a href="#cb113-138" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(</span>
<span id="cb113-139"><a href="#cb113-139" aria-hidden="true" tabindex="-1"></a>    <span class="at">Penalty =</span> <span class="fu">sum</span>(Contribution) <span class="sc">*</span> <span class="fu">hsr_neutrality_modifier</span>(my_report)</span>
<span id="cb113-140"><a href="#cb113-140" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb113-141"><a href="#cb113-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-142"><a href="#cb113-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-143"><a href="#cb113-143" aria-hidden="true" tabindex="-1"></a>What we did here was:</span>
<span id="cb113-144"><a href="#cb113-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-145"><a href="#cb113-145" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Find cohorts who received a penalty _who were eligible_</span>
<span id="cb113-146"><a href="#cb113-146" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>A cohort must have at least 25 discharges to be eligible</span>
<span id="cb113-147"><a href="#cb113-147" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>Then, the excess readmission ratio (ERR) must be greater than the assigned peer group's median ERR</span>
<span id="cb113-148"><a href="#cb113-148" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Find the difference between the hospital's ERR compared to the peer group median ERR</span>
<span id="cb113-149"><a href="#cb113-149" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Multiply that by the ratio of DRG payments for that cohort</span>
<span id="cb113-150"><a href="#cb113-150" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>This is a measure of the volume of patients with this condition are treated at the hospital</span>
<span id="cb113-151"><a href="#cb113-151" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Sum those contributions over each cohort</span>
<span id="cb113-152"><a href="#cb113-152" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Multiply that by the neutrality modifier in the <span class="in">`hsr_payment_summary()`</span> table</span>
<span id="cb113-153"><a href="#cb113-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-154"><a href="#cb113-154" aria-hidden="true" tabindex="-1"></a>That's how the penalty is computed, from cohort summary level.</span>
<span id="cb113-155"><a href="#cb113-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-156"><a href="#cb113-156" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3. Discharges</span></span>
<span id="cb113-157"><a href="#cb113-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-158"><a href="#cb113-158" aria-hidden="true" tabindex="-1"></a>_Note: Because we are using mock reports, the dates in these files are erroneous and thus R doesn't interpret them as dates. However, your hospital report has real dates and thus R should automatically parse them as such._</span>
<span id="cb113-159"><a href="#cb113-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-160"><a href="#cb113-160" aria-hidden="true" tabindex="-1"></a>The HSR also contains discharge-level data on the individual patients that actually contributed to the program. There is a separate table/tab for each of the cohorts. We can use the <span class="in">`hsr_discharges()`</span> function to import them for a specified cohort:</span>
<span id="cb113-161"><a href="#cb113-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-164"><a href="#cb113-164" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-165"><a href="#cb113-165" aria-hidden="true" tabindex="-1"></a><span class="fu">hsr_discharges</span>(my_report, <span class="st">"COPD"</span>)</span>
<span id="cb113-166"><a href="#cb113-166" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-167"><a href="#cb113-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-168"><a href="#cb113-168" aria-hidden="true" tabindex="-1"></a>We get some patient identifying information, including the specific dates associated with the index and readmission hospitalizations, whether or not the readmission occurred at the same hospital, diagnosis codes, etc., which is all very valuable information that we can explore to gain insights from (and what we'll do <span class="co">[</span><span class="ot">later</span><span class="co">](#analysisstrategies)</span>).</span>
<span id="cb113-169"><a href="#cb113-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-170"><a href="#cb113-170" aria-hidden="true" tabindex="-1"></a>There are also options available in the function to refine the result:</span>
<span id="cb113-171"><a href="#cb113-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-172"><a href="#cb113-172" aria-hidden="true" tabindex="-1"></a><span class="fu">### Eligible Cases</span></span>
<span id="cb113-173"><a href="#cb113-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-174"><a href="#cb113-174" aria-hidden="true" tabindex="-1"></a>The <span class="in">`eligible_only`</span> argument can be used to only included discharges that were actually included in HRRP evaluation:</span>
<span id="cb113-175"><a href="#cb113-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-178"><a href="#cb113-178" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-179"><a href="#cb113-179" aria-hidden="true" tabindex="-1"></a><span class="fu">hsr_discharges</span>(</span>
<span id="cb113-180"><a href="#cb113-180" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> my_report, </span>
<span id="cb113-181"><a href="#cb113-181" aria-hidden="true" tabindex="-1"></a>  <span class="at">cohort =</span> <span class="st">"COPD"</span>,</span>
<span id="cb113-182"><a href="#cb113-182" aria-hidden="true" tabindex="-1"></a>  <span class="at">eligible_only =</span> <span class="cn">TRUE</span></span>
<span id="cb113-183"><a href="#cb113-183" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb113-184"><a href="#cb113-184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-185"><a href="#cb113-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-186"><a href="#cb113-186" aria-hidden="true" tabindex="-1"></a>Notice that this row count matches what was reported as the COPD denominator in the <span class="in">`cohort_summary`</span>:</span>
<span id="cb113-187"><a href="#cb113-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-190"><a href="#cb113-190" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-191"><a href="#cb113-191" aria-hidden="true" tabindex="-1"></a>cohort_summary <span class="sc">|&gt;</span></span>
<span id="cb113-192"><a href="#cb113-192" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="st">`</span><span class="at">Measure [a]</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"COPD"</span>) <span class="sc">|&gt;</span></span>
<span id="cb113-193"><a href="#cb113-193" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="st">`</span><span class="at">Number of Eligible Discharges [b]</span><span class="st">`</span>)</span>
<span id="cb113-194"><a href="#cb113-194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-195"><a href="#cb113-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-196"><a href="#cb113-196" aria-hidden="true" tabindex="-1"></a><span class="fu">### Risk Factors</span></span>
<span id="cb113-197"><a href="#cb113-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-198"><a href="#cb113-198" aria-hidden="true" tabindex="-1"></a>Also included in these tables are the indicators of risk factors that are used in the statistical models to estimate individual adjusted readmission risks. We can use the <span class="in">`risk_factors`</span> argument to extract those for each patient:</span>
<span id="cb113-199"><a href="#cb113-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-202"><a href="#cb113-202" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-203"><a href="#cb113-203" aria-hidden="true" tabindex="-1"></a><span class="fu">hsr_discharges</span>(</span>
<span id="cb113-204"><a href="#cb113-204" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> my_report, </span>
<span id="cb113-205"><a href="#cb113-205" aria-hidden="true" tabindex="-1"></a>  <span class="at">cohort =</span> <span class="st">"COPD"</span>,</span>
<span id="cb113-206"><a href="#cb113-206" aria-hidden="true" tabindex="-1"></a>  <span class="at">eligible_only =</span> <span class="cn">TRUE</span>,</span>
<span id="cb113-207"><a href="#cb113-207" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk_factors =</span> <span class="cn">TRUE</span>,</span>
<span id="cb113-208"><a href="#cb113-208" aria-hidden="true" tabindex="-1"></a>  <span class="at">discharge_phi =</span> <span class="cn">FALSE</span></span>
<span id="cb113-209"><a href="#cb113-209" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb113-210"><a href="#cb113-210" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-211"><a href="#cb113-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-212"><a href="#cb113-212" aria-hidden="true" tabindex="-1"></a>This data can then be explored further to understand risk factor prevalence and how that relates to model weights, etc. (again, covered <span class="co">[</span><span class="ot">later</span><span class="co">](#analysisstrategies)</span>). Notice the <span class="in">`discharge_phi`</span> argument was used to prevent the date information from being returned.</span>
<span id="cb113-213"><a href="#cb113-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-214"><a href="#cb113-214" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4. Model Coefficients {#modelcoefficients}</span></span>
<span id="cb113-215"><a href="#cb113-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-216"><a href="#cb113-216" aria-hidden="true" tabindex="-1"></a>The ERR is calculated based on an aggregated roll up of individual adjusted readmission risks derived from a random-intercept logistic regression model. The first row in the discharge table contains the coefficients for this model. We can use the <span class="in">`hsr_coefficients()`</span> function to extract them:</span>
<span id="cb113-217"><a href="#cb113-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-220"><a href="#cb113-220" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-221"><a href="#cb113-221" aria-hidden="true" tabindex="-1"></a>copd_model <span class="ot">&lt;-</span> <span class="fu">hsr_coefficients</span>(my_report, <span class="st">"COPD"</span>)</span>
<span id="cb113-222"><a href="#cb113-222" aria-hidden="true" tabindex="-1"></a>copd_model</span>
<span id="cb113-223"><a href="#cb113-223" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-224"><a href="#cb113-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-225"><a href="#cb113-225" aria-hidden="true" tabindex="-1"></a>This allows us to do things like assess the relative contribution of risk factors to the estimated readmission rates or use the risk factor dataset above to compute individual level readmission risks.</span>
<span id="cb113-226"><a href="#cb113-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-227"><a href="#cb113-227" aria-hidden="true" tabindex="-1"></a><span class="fu">### Intercept Terms</span></span>
<span id="cb113-228"><a href="#cb113-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-229"><a href="#cb113-229" aria-hidden="true" tabindex="-1"></a>The _predicted_ and _expected_ readmission rates only differ in the intercept terms applied to the prediction (thus it is a constant shift for all patients). We can see these at the end of this data frame:</span>
<span id="cb113-230"><a href="#cb113-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-233"><a href="#cb113-233" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-234"><a href="#cb113-234" aria-hidden="true" tabindex="-1"></a>copd_model <span class="sc">|&gt;</span> <span class="fu">tail</span>()</span>
<span id="cb113-235"><a href="#cb113-235" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-236"><a href="#cb113-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-237"><a href="#cb113-237" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5. Readmission Risks</span></span>
<span id="cb113-238"><a href="#cb113-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-239"><a href="#cb113-239" aria-hidden="true" tabindex="-1"></a>We could take the risk factor output from <span class="in">`hsr_discharges()`</span> combined with the coefficients from <span class="in">`hsr_coefficients()`</span> and reconcile each patient's _predicted_ and _expected_ readmission risk. But the <span class="in">`hsr_readmission_risks()`</span> function can do all of that for us:</span>
<span id="cb113-240"><a href="#cb113-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-243"><a href="#cb113-243" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-244"><a href="#cb113-244" aria-hidden="true" tabindex="-1"></a>risks <span class="ot">&lt;-</span> <span class="fu">hsr_readmission_risks</span>(my_report, <span class="st">"COPD"</span>)</span>
<span id="cb113-245"><a href="#cb113-245" aria-hidden="true" tabindex="-1"></a>risks</span>
<span id="cb113-246"><a href="#cb113-246" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-247"><a href="#cb113-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-248"><a href="#cb113-248" aria-hidden="true" tabindex="-1"></a>This just takes a weighted-sum of the risk factors and coefficients, adds the corresponding intercept, and then maps it to a probability through the logistic function.</span>
<span id="cb113-249"><a href="#cb113-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-250"><a href="#cb113-250" aria-hidden="true" tabindex="-1"></a>The cohort-level _predicted_ and _expected_ readmission rates are just the averages of these columns across all eligible patients:</span>
<span id="cb113-251"><a href="#cb113-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-254"><a href="#cb113-254" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-255"><a href="#cb113-255" aria-hidden="true" tabindex="-1"></a>risks <span class="sc">|&gt;</span></span>
<span id="cb113-256"><a href="#cb113-256" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(</span>
<span id="cb113-257"><a href="#cb113-257" aria-hidden="true" tabindex="-1"></a>    <span class="at">Discharges =</span> dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="cb113-258"><a href="#cb113-258" aria-hidden="true" tabindex="-1"></a>    <span class="at">Predicted =</span> <span class="fu">mean</span>(Predicted),</span>
<span id="cb113-259"><a href="#cb113-259" aria-hidden="true" tabindex="-1"></a>    <span class="at">Expected =</span> <span class="fu">mean</span>(Expected),</span>
<span id="cb113-260"><a href="#cb113-260" aria-hidden="true" tabindex="-1"></a>    <span class="at">ERR =</span> Predicted <span class="sc">/</span> Expected</span>
<span id="cb113-261"><a href="#cb113-261" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb113-262"><a href="#cb113-262" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-263"><a href="#cb113-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-264"><a href="#cb113-264" aria-hidden="true" tabindex="-1"></a>Again, looking at our cohort summary, we can see these match:</span>
<span id="cb113-265"><a href="#cb113-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-268"><a href="#cb113-268" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-269"><a href="#cb113-269" aria-hidden="true" tabindex="-1"></a>cohort_summary <span class="sc">|&gt;</span> </span>
<span id="cb113-270"><a href="#cb113-270" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb113-271"><a href="#cb113-271" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Measure [a]</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"COPD"</span></span>
<span id="cb113-272"><a href="#cb113-272" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb113-273"><a href="#cb113-273" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb113-274"><a href="#cb113-274" aria-hidden="true" tabindex="-1"></a>    <span class="at">Discharges =</span> <span class="st">`</span><span class="at">Number of Eligible Discharges [b]</span><span class="st">`</span>,</span>
<span id="cb113-275"><a href="#cb113-275" aria-hidden="true" tabindex="-1"></a>    <span class="at">Predicted =</span> <span class="st">`</span><span class="at">Predicted Readmission Rate [d]</span><span class="st">`</span>,</span>
<span id="cb113-276"><a href="#cb113-276" aria-hidden="true" tabindex="-1"></a>    <span class="at">Expected =</span> <span class="st">`</span><span class="at">Expected Readmission Rate [e]</span><span class="st">`</span>,</span>
<span id="cb113-277"><a href="#cb113-277" aria-hidden="true" tabindex="-1"></a>    <span class="at">ERR =</span> <span class="st">`</span><span class="at">Excess Readmission Ratio (ERR) [f]</span><span class="st">`</span></span>
<span id="cb113-278"><a href="#cb113-278" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb113-279"><a href="#cb113-279" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-280"><a href="#cb113-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-281"><a href="#cb113-281" aria-hidden="true" tabindex="-1"></a><span class="fu">## 6. Dual Stays</span></span>
<span id="cb113-282"><a href="#cb113-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-283"><a href="#cb113-283" aria-hidden="true" tabindex="-1"></a>CMS puts hospitals into peer groups based on the relative proportion of Medicare patients who are also eligible for Medicaid. This is a measure of socioeconomic status for the hospital population so hospitals are being compared only against other hospitals that are similar (in this regard). These aggregated quantities were found in <span class="in">`hsr_payment_summary()`</span> result:</span>
<span id="cb113-284"><a href="#cb113-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-287"><a href="#cb113-287" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-288"><a href="#cb113-288" aria-hidden="true" tabindex="-1"></a>my_payment_summary</span>
<span id="cb113-289"><a href="#cb113-289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-290"><a href="#cb113-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-291"><a href="#cb113-291" aria-hidden="true" tabindex="-1"></a>The <span class="in">`hsr_dual_stays()`</span> function extracts the discharge-level data corresponding to the numerator of the ratio:</span>
<span id="cb113-292"><a href="#cb113-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-295"><a href="#cb113-295" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-296"><a href="#cb113-296" aria-hidden="true" tabindex="-1"></a><span class="fu">hsr_dual_stays</span>(my_report)</span>
<span id="cb113-297"><a href="#cb113-297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-298"><a href="#cb113-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-299"><a href="#cb113-299" aria-hidden="true" tabindex="-1"></a>We can see that the row count of this discharge level data matches the first number in the preceding table.</span>
<span id="cb113-300"><a href="#cb113-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-301"><a href="#cb113-301" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analysis Strategies {#analysisstrategies}</span></span>
<span id="cb113-302"><a href="#cb113-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-303"><a href="#cb113-303" aria-hidden="true" tabindex="-1"></a>In this section we'll go through a collection data analyses that can be conducted, using functions in <span class="in">`readmit`</span> as support, to validate HSR calculations and/or to gain deeper insights into HRRP results.</span>
<span id="cb113-304"><a href="#cb113-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-305"><a href="#cb113-305" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1. Validating the Penalty Calculation</span></span>
<span id="cb113-306"><a href="#cb113-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-307"><a href="#cb113-307" aria-hidden="true" tabindex="-1"></a>We <span class="co">[</span><span class="ot">previously calculated</span><span class="co">](#cohortsummary)</span> the payment penalty starting from the cohort-level results. However, as an initial validation step, it is important to go through the mechanics of reconciling the penalty calculation from the discharge-level data to ensure comprehension of how it works. </span>
<span id="cb113-308"><a href="#cb113-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-309"><a href="#cb113-309" aria-hidden="true" tabindex="-1"></a>_Note: We'll go the slower, more tedious way to do this in the steps below in order to capture all intermediate details for understanding, but will callout where certain steps can be more efficient._</span>
<span id="cb113-310"><a href="#cb113-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-311"><a href="#cb113-311" aria-hidden="true" tabindex="-1"></a>Let's extract the <span class="in">`cohort`</span> strings we need to plug into various function arguments:</span>
<span id="cb113-312"><a href="#cb113-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-315"><a href="#cb113-315" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-316"><a href="#cb113-316" aria-hidden="true" tabindex="-1"></a>cohorts <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">names</span>(hrrp_cohort_inclusion), <span class="st">"ProgramYear"</span>)</span>
<span id="cb113-317"><a href="#cb113-317" aria-hidden="true" tabindex="-1"></a>cohorts</span>
<span id="cb113-318"><a href="#cb113-318" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-319"><a href="#cb113-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-320"><a href="#cb113-320" aria-hidden="true" tabindex="-1"></a><span class="fu">### i. Extract Discharges</span></span>
<span id="cb113-321"><a href="#cb113-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-322"><a href="#cb113-322" aria-hidden="true" tabindex="-1"></a>The first thing we need to is extract the set of discharges (i.e., the _denominator_) that contribute to program for each cohort. To do this, we'll iterate through the different cohorts and sequentially use the <span class="in">`hsr_discharges()`</span> function to get the row identifiers that should be included:</span>
<span id="cb113-323"><a href="#cb113-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-326"><a href="#cb113-326" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-327"><a href="#cb113-327" aria-hidden="true" tabindex="-1"></a>eligible_discharges <span class="ot">&lt;-</span></span>
<span id="cb113-328"><a href="#cb113-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setdiff</span>(cohorts, <span class="st">"CABG"</span>) <span class="sc">|&gt;</span></span>
<span id="cb113-329"><a href="#cb113-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-330"><a href="#cb113-330" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Iterate each cohort</span></span>
<span id="cb113-331"><a href="#cb113-331" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">map_df</span>(</span>
<span id="cb113-332"><a href="#cb113-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-333"><a href="#cb113-333" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Import eligible discharges</span></span>
<span id="cb113-334"><a href="#cb113-334" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span><span class="fu">hsr_discharges</span>(</span>
<span id="cb113-335"><a href="#cb113-335" aria-hidden="true" tabindex="-1"></a>        <span class="at">file =</span> my_report,</span>
<span id="cb113-336"><a href="#cb113-336" aria-hidden="true" tabindex="-1"></a>        <span class="at">cohort =</span> .x,</span>
<span id="cb113-337"><a href="#cb113-337" aria-hidden="true" tabindex="-1"></a>        <span class="at">eligible_only =</span> <span class="cn">TRUE</span></span>
<span id="cb113-338"><a href="#cb113-338" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span></span>
<span id="cb113-339"><a href="#cb113-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-340"><a href="#cb113-340" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Keep the row identifiers</span></span>
<span id="cb113-341"><a href="#cb113-341" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">`</span><span class="at">ID Number</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb113-342"><a href="#cb113-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-343"><a href="#cb113-343" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Add cohort identifier</span></span>
<span id="cb113-344"><a href="#cb113-344" aria-hidden="true" tabindex="-1"></a>      tibble<span class="sc">::</span><span class="fu">add_column</span>(<span class="at">Cohort =</span> .x)</span>
<span id="cb113-345"><a href="#cb113-345" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb113-346"><a href="#cb113-346" aria-hidden="true" tabindex="-1"></a>eligible_discharges</span>
<span id="cb113-347"><a href="#cb113-347" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-348"><a href="#cb113-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-349"><a href="#cb113-349" aria-hidden="true" tabindex="-1"></a>We can check the counts of these:</span>
<span id="cb113-350"><a href="#cb113-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-353"><a href="#cb113-353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-354"><a href="#cb113-354" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(eligible_discharges<span class="sc">$</span>Cohort)</span>
<span id="cb113-355"><a href="#cb113-355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-356"><a href="#cb113-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-357"><a href="#cb113-357" aria-hidden="true" tabindex="-1"></a>You can validate that we obtained the correct counts by looking at the <span class="co">[</span><span class="ot">cohort summary</span><span class="co">](#cohortsummary)</span> we previously created.</span>
<span id="cb113-358"><a href="#cb113-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-361"><a href="#cb113-361" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-362"><a href="#cb113-362" aria-hidden="true" tabindex="-1"></a>cohort_summary</span>
<span id="cb113-363"><a href="#cb113-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-364"><a href="#cb113-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-365"><a href="#cb113-365" aria-hidden="true" tabindex="-1"></a>One caveat was that we already knew there weren't any <span class="in">`CABG`</span> discharges (via the <span class="in">`NA`</span> in the <span class="in">`cohort_summary`</span> table), so we pre-excluded this from our cohort list we iterated through (as it would have caused an error otherwise).</span>
<span id="cb113-366"><a href="#cb113-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-367"><a href="#cb113-367" aria-hidden="true" tabindex="-1"></a><span class="fu">### ii. Extract Risk Factors {#riskfactors}</span></span>
<span id="cb113-368"><a href="#cb113-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-369"><a href="#cb113-369" aria-hidden="true" tabindex="-1"></a>Next we need to extract the sets of risk factors for each cohort that go into the readmission risk model. We can again do this by iterating through the <span class="in">`cohort`</span> list with <span class="in">`hsr_discharges`</span>, but extracting the risk factors as well with <span class="in">`risk_factors=TRUE`</span>:</span>
<span id="cb113-370"><a href="#cb113-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-373"><a href="#cb113-373" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-374"><a href="#cb113-374" aria-hidden="true" tabindex="-1"></a><span class="fu">setdiff</span>(cohorts, <span class="st">"CABG"</span>) <span class="sc">|&gt;</span></span>
<span id="cb113-375"><a href="#cb113-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-376"><a href="#cb113-376" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Iterate each cohort</span></span>
<span id="cb113-377"><a href="#cb113-377" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">map</span>(</span>
<span id="cb113-378"><a href="#cb113-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-379"><a href="#cb113-379" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Import eligible discharges</span></span>
<span id="cb113-380"><a href="#cb113-380" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span><span class="fu">hsr_discharges</span>(</span>
<span id="cb113-381"><a href="#cb113-381" aria-hidden="true" tabindex="-1"></a>        <span class="at">file =</span> my_report,</span>
<span id="cb113-382"><a href="#cb113-382" aria-hidden="true" tabindex="-1"></a>        <span class="at">cohort =</span> .x,</span>
<span id="cb113-383"><a href="#cb113-383" aria-hidden="true" tabindex="-1"></a>        <span class="at">risk_factors =</span> <span class="cn">TRUE</span>,</span>
<span id="cb113-384"><a href="#cb113-384" aria-hidden="true" tabindex="-1"></a>        <span class="at">discharge_phi =</span> <span class="cn">FALSE</span></span>
<span id="cb113-385"><a href="#cb113-385" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb113-386"><a href="#cb113-386" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb113-387"><a href="#cb113-387" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-388"><a href="#cb113-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-389"><a href="#cb113-389" aria-hidden="true" tabindex="-1"></a>Notice that we get the risk factors for each cohort, but all of the columns are different since each cohort has a different model. So one thing we can do is pivot the data with <span class="in">`tidyr::pivot_longer()`</span> to make a long and narrow data frame so that it can all be binded together.</span>
<span id="cb113-390"><a href="#cb113-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-393"><a href="#cb113-393" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-394"><a href="#cb113-394" aria-hidden="true" tabindex="-1"></a>risk_factors <span class="ot">&lt;-</span></span>
<span id="cb113-395"><a href="#cb113-395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setdiff</span>(cohorts, <span class="st">"CABG"</span>) <span class="sc">|&gt;</span></span>
<span id="cb113-396"><a href="#cb113-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-397"><a href="#cb113-397" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Iterate each cohort</span></span>
<span id="cb113-398"><a href="#cb113-398" aria-hidden="true" tabindex="-1"></a>      purrr<span class="sc">::</span><span class="fu">map_df</span>(</span>
<span id="cb113-399"><a href="#cb113-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-400"><a href="#cb113-400" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Import eligible discharges</span></span>
<span id="cb113-401"><a href="#cb113-401" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span><span class="fu">hsr_discharges</span>(</span>
<span id="cb113-402"><a href="#cb113-402" aria-hidden="true" tabindex="-1"></a>          <span class="at">file =</span> my_report,</span>
<span id="cb113-403"><a href="#cb113-403" aria-hidden="true" tabindex="-1"></a>          <span class="at">cohort =</span> .x,</span>
<span id="cb113-404"><a href="#cb113-404" aria-hidden="true" tabindex="-1"></a>          <span class="at">risk_factors =</span> <span class="cn">TRUE</span>,</span>
<span id="cb113-405"><a href="#cb113-405" aria-hidden="true" tabindex="-1"></a>          <span class="at">discharge_phi =</span> <span class="cn">FALSE</span></span>
<span id="cb113-406"><a href="#cb113-406" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span></span>
<span id="cb113-407"><a href="#cb113-407" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb113-408"><a href="#cb113-408" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Send risk factors down the rows</span></span>
<span id="cb113-409"><a href="#cb113-409" aria-hidden="true" tabindex="-1"></a>        tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb113-410"><a href="#cb113-410" aria-hidden="true" tabindex="-1"></a>          <span class="at">cols =</span> <span class="sc">-</span><span class="st">`</span><span class="at">ID Number</span><span class="st">`</span>,</span>
<span id="cb113-411"><a href="#cb113-411" aria-hidden="true" tabindex="-1"></a>          <span class="at">names_to =</span> <span class="st">"Factor"</span>,</span>
<span id="cb113-412"><a href="#cb113-412" aria-hidden="true" tabindex="-1"></a>          <span class="at">values_to =</span> <span class="st">"Value"</span></span>
<span id="cb113-413"><a href="#cb113-413" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span></span>
<span id="cb113-414"><a href="#cb113-414" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb113-415"><a href="#cb113-415" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Indicate cohort</span></span>
<span id="cb113-416"><a href="#cb113-416" aria-hidden="true" tabindex="-1"></a>        tibble<span class="sc">::</span><span class="fu">add_column</span>(<span class="at">Cohort =</span> .x)</span>
<span id="cb113-417"><a href="#cb113-417" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb113-418"><a href="#cb113-418" aria-hidden="true" tabindex="-1"></a>risk_factors</span>
<span id="cb113-419"><a href="#cb113-419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-420"><a href="#cb113-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-421"><a href="#cb113-421" aria-hidden="true" tabindex="-1"></a>We can then merge these (using <span class="in">`dplyr::inner_join()`</span>) with the eligilble discharges we previously identified to get the set of risk factors for each eligible discharge:</span>
<span id="cb113-422"><a href="#cb113-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-425"><a href="#cb113-425" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-426"><a href="#cb113-426" aria-hidden="true" tabindex="-1"></a>risk_factors <span class="ot">&lt;-</span></span>
<span id="cb113-427"><a href="#cb113-427" aria-hidden="true" tabindex="-1"></a>  risk_factors <span class="sc">|&gt;</span></span>
<span id="cb113-428"><a href="#cb113-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-429"><a href="#cb113-429" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Join to get eligible only</span></span>
<span id="cb113-430"><a href="#cb113-430" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb113-431"><a href="#cb113-431" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> eligible_discharges,</span>
<span id="cb113-432"><a href="#cb113-432" aria-hidden="true" tabindex="-1"></a>      <span class="at">by =</span> </span>
<span id="cb113-433"><a href="#cb113-433" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(</span>
<span id="cb113-434"><a href="#cb113-434" aria-hidden="true" tabindex="-1"></a>          <span class="st">"ID Number"</span>,</span>
<span id="cb113-435"><a href="#cb113-435" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Cohort"</span></span>
<span id="cb113-436"><a href="#cb113-436" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb113-437"><a href="#cb113-437" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb113-438"><a href="#cb113-438" aria-hidden="true" tabindex="-1"></a>risk_factors</span>
<span id="cb113-439"><a href="#cb113-439" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-440"><a href="#cb113-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-441"><a href="#cb113-441" aria-hidden="true" tabindex="-1"></a>Of course, we didn't _have_ to do this step separately from step (i), as we could have just used the <span class="in">`eligible_only`</span> argument simultaneously, and ended up in the same place.</span>
<span id="cb113-442"><a href="#cb113-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-445"><a href="#cb113-445" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-446"><a href="#cb113-446" aria-hidden="true" tabindex="-1"></a>risk_factors <span class="ot">&lt;-</span></span>
<span id="cb113-447"><a href="#cb113-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setdiff</span>(cohorts, <span class="st">"CABG"</span>) <span class="sc">|&gt;</span></span>
<span id="cb113-448"><a href="#cb113-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-449"><a href="#cb113-449" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Iterate each cohort</span></span>
<span id="cb113-450"><a href="#cb113-450" aria-hidden="true" tabindex="-1"></a>      purrr<span class="sc">::</span><span class="fu">map_df</span>(</span>
<span id="cb113-451"><a href="#cb113-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-452"><a href="#cb113-452" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Import eligible discharges</span></span>
<span id="cb113-453"><a href="#cb113-453" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span><span class="fu">hsr_discharges</span>(</span>
<span id="cb113-454"><a href="#cb113-454" aria-hidden="true" tabindex="-1"></a>          <span class="at">file =</span> my_report,</span>
<span id="cb113-455"><a href="#cb113-455" aria-hidden="true" tabindex="-1"></a>          <span class="at">cohort =</span> .x,</span>
<span id="cb113-456"><a href="#cb113-456" aria-hidden="true" tabindex="-1"></a>          <span class="at">risk_factors =</span> <span class="cn">TRUE</span>,</span>
<span id="cb113-457"><a href="#cb113-457" aria-hidden="true" tabindex="-1"></a>          <span class="at">discharge_phi =</span> <span class="cn">FALSE</span>,</span>
<span id="cb113-458"><a href="#cb113-458" aria-hidden="true" tabindex="-1"></a>          <span class="at">eligible_only =</span> <span class="cn">TRUE</span></span>
<span id="cb113-459"><a href="#cb113-459" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span></span>
<span id="cb113-460"><a href="#cb113-460" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb113-461"><a href="#cb113-461" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Send risk factors down the rows</span></span>
<span id="cb113-462"><a href="#cb113-462" aria-hidden="true" tabindex="-1"></a>        tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb113-463"><a href="#cb113-463" aria-hidden="true" tabindex="-1"></a>          <span class="at">cols =</span> <span class="sc">-</span><span class="st">`</span><span class="at">ID Number</span><span class="st">`</span>,</span>
<span id="cb113-464"><a href="#cb113-464" aria-hidden="true" tabindex="-1"></a>          <span class="at">names_to =</span> <span class="st">"Factor"</span>,</span>
<span id="cb113-465"><a href="#cb113-465" aria-hidden="true" tabindex="-1"></a>          <span class="at">values_to =</span> <span class="st">"Value"</span></span>
<span id="cb113-466"><a href="#cb113-466" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span></span>
<span id="cb113-467"><a href="#cb113-467" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb113-468"><a href="#cb113-468" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Indicate cohort</span></span>
<span id="cb113-469"><a href="#cb113-469" aria-hidden="true" tabindex="-1"></a>        tibble<span class="sc">::</span><span class="fu">add_column</span>(<span class="at">Cohort =</span> .x)</span>
<span id="cb113-470"><a href="#cb113-470" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb113-471"><a href="#cb113-471" aria-hidden="true" tabindex="-1"></a>risk_factors</span>
<span id="cb113-472"><a href="#cb113-472" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-473"><a href="#cb113-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-474"><a href="#cb113-474" aria-hidden="true" tabindex="-1"></a><span class="fu">### iii. Compute Individual Readmission Risks {#individualreadmissionrisk}</span></span>
<span id="cb113-475"><a href="#cb113-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-476"><a href="#cb113-476" aria-hidden="true" tabindex="-1"></a>The _predicted_ and _expected_ readmission rates are computed for each discharge by plugging in each patient's set of risk factors into risk models developed by CMS. We can use the <span class="in">`hsr_coefficients()`</span> function to extract these:</span>
<span id="cb113-477"><a href="#cb113-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-480"><a href="#cb113-480" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-481"><a href="#cb113-481" aria-hidden="true" tabindex="-1"></a>model_weights <span class="ot">&lt;-</span></span>
<span id="cb113-482"><a href="#cb113-482" aria-hidden="true" tabindex="-1"></a>  cohorts <span class="sc">|&gt;</span></span>
<span id="cb113-483"><a href="#cb113-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-484"><a href="#cb113-484" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Iterate each cohort</span></span>
<span id="cb113-485"><a href="#cb113-485" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map_df</span>(</span>
<span id="cb113-486"><a href="#cb113-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-487"><a href="#cb113-487" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Import eligible discharges</span></span>
<span id="cb113-488"><a href="#cb113-488" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span><span class="fu">hsr_coefficients</span>(</span>
<span id="cb113-489"><a href="#cb113-489" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> my_report,</span>
<span id="cb113-490"><a href="#cb113-490" aria-hidden="true" tabindex="-1"></a>      <span class="at">cohort =</span> .x</span>
<span id="cb113-491"><a href="#cb113-491" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb113-492"><a href="#cb113-492" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb113-493"><a href="#cb113-493" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Indicate cohort</span></span>
<span id="cb113-494"><a href="#cb113-494" aria-hidden="true" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">add_column</span>(<span class="at">Cohort =</span> .x)</span>
<span id="cb113-495"><a href="#cb113-495" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb113-496"><a href="#cb113-496" aria-hidden="true" tabindex="-1"></a>model_weights</span>
<span id="cb113-497"><a href="#cb113-497" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-498"><a href="#cb113-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-499"><a href="#cb113-499" aria-hidden="true" tabindex="-1"></a>To use these in our calculations, we need to attach the model weights for each cohort to our current <span class="in">`risk_factors`</span> dataset using <span class="in">`dplyr::inner_join()`</span>:</span>
<span id="cb113-500"><a href="#cb113-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-503"><a href="#cb113-503" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-504"><a href="#cb113-504" aria-hidden="true" tabindex="-1"></a>risk_factors <span class="ot">&lt;-</span></span>
<span id="cb113-505"><a href="#cb113-505" aria-hidden="true" tabindex="-1"></a>  risk_factors <span class="sc">|&gt;</span></span>
<span id="cb113-506"><a href="#cb113-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-507"><a href="#cb113-507" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Join to get weights</span></span>
<span id="cb113-508"><a href="#cb113-508" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb113-509"><a href="#cb113-509" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> </span>
<span id="cb113-510"><a href="#cb113-510" aria-hidden="true" tabindex="-1"></a>        model_weights <span class="sc">|&gt;</span> </span>
<span id="cb113-511"><a href="#cb113-511" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb113-512"><a href="#cb113-512" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Rename the column</span></span>
<span id="cb113-513"><a href="#cb113-513" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">rename</span>(</span>
<span id="cb113-514"><a href="#cb113-514" aria-hidden="true" tabindex="-1"></a>          <span class="at">Weight =</span> Value</span>
<span id="cb113-515"><a href="#cb113-515" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb113-516"><a href="#cb113-516" aria-hidden="true" tabindex="-1"></a>      <span class="at">by =</span> </span>
<span id="cb113-517"><a href="#cb113-517" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(</span>
<span id="cb113-518"><a href="#cb113-518" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Cohort"</span>,</span>
<span id="cb113-519"><a href="#cb113-519" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Factor"</span></span>
<span id="cb113-520"><a href="#cb113-520" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb113-521"><a href="#cb113-521" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb113-522"><a href="#cb113-522" aria-hidden="true" tabindex="-1"></a>risk_factors</span>
<span id="cb113-523"><a href="#cb113-523" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-524"><a href="#cb113-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-525"><a href="#cb113-525" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Compute the Linear Predictor {#linearpredictor}</span></span>
<span id="cb113-526"><a href="#cb113-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-527"><a href="#cb113-527" aria-hidden="true" tabindex="-1"></a>These are <span class="co">[</span><span class="ot">logistic regression</span><span class="co">](https://en.wikipedia.org/wiki/Logistic_regression)</span> models, so to convert to a risk estimate, we need to take the _weighted-sum_ of each factor weight with the risk factor value for each discharge.</span>
<span id="cb113-528"><a href="#cb113-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-531"><a href="#cb113-531" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-532"><a href="#cb113-532" aria-hidden="true" tabindex="-1"></a>linear_predictors <span class="ot">&lt;-</span></span>
<span id="cb113-533"><a href="#cb113-533" aria-hidden="true" tabindex="-1"></a>  risk_factors <span class="sc">|&gt;</span></span>
<span id="cb113-534"><a href="#cb113-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-535"><a href="#cb113-535" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute weighted sum</span></span>
<span id="cb113-536"><a href="#cb113-536" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarize</span>(</span>
<span id="cb113-537"><a href="#cb113-537" aria-hidden="true" tabindex="-1"></a>      <span class="at">LP =</span> <span class="fu">sum</span>(Weight <span class="sc">*</span> Value),</span>
<span id="cb113-538"><a href="#cb113-538" aria-hidden="true" tabindex="-1"></a>      <span class="at">.by =</span> </span>
<span id="cb113-539"><a href="#cb113-539" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(</span>
<span id="cb113-540"><a href="#cb113-540" aria-hidden="true" tabindex="-1"></a>          Cohort,</span>
<span id="cb113-541"><a href="#cb113-541" aria-hidden="true" tabindex="-1"></a>          <span class="st">`</span><span class="at">ID Number</span><span class="st">`</span></span>
<span id="cb113-542"><a href="#cb113-542" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb113-543"><a href="#cb113-543" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb113-544"><a href="#cb113-544" aria-hidden="true" tabindex="-1"></a>linear_predictors</span>
<span id="cb113-545"><a href="#cb113-545" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-546"><a href="#cb113-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-547"><a href="#cb113-547" aria-hidden="true" tabindex="-1"></a>You can think of this as the "risk-adjustment" part, where we've adjusted each patient's readmission risk based on their own clinical history. These are on the <span class="co">[</span><span class="ot">logit</span><span class="co">](https://en.wikipedia.org/wiki/Logit)</span> scale (so not yet probability/risk estimates), but it is what we assume to be linearly related to the outcome, thus we call it the "linear predictor". However, we are still missing something: **the intercept terms**.</span>
<span id="cb113-548"><a href="#cb113-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-549"><a href="#cb113-549" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Add In the Intercepts</span></span>
<span id="cb113-550"><a href="#cb113-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-551"><a href="#cb113-551" aria-hidden="true" tabindex="-1"></a>The _predicted_ and _expected_ readmission risks are derived from the same risk-adjusted model, the only difference being in the intercept term that is added to complete the linear predictor. We can see those in our model weight list:</span>
<span id="cb113-552"><a href="#cb113-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-555"><a href="#cb113-555" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-556"><a href="#cb113-556" aria-hidden="true" tabindex="-1"></a>model_weights <span class="sc">|&gt;</span></span>
<span id="cb113-557"><a href="#cb113-557" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb113-558"><a href="#cb113-558" aria-hidden="true" tabindex="-1"></a>    stringr<span class="sc">::</span><span class="fu">str_detect</span>(</span>
<span id="cb113-559"><a href="#cb113-559" aria-hidden="true" tabindex="-1"></a>      Factor,</span>
<span id="cb113-560"><a href="#cb113-560" aria-hidden="true" tabindex="-1"></a>      <span class="at">pattern =</span> <span class="st">"EFFECT$"</span></span>
<span id="cb113-561"><a href="#cb113-561" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb113-562"><a href="#cb113-562" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb113-563"><a href="#cb113-563" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-564"><a href="#cb113-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-565"><a href="#cb113-565" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The <span class="in">`AVG_EFFECT`</span> corresponds to the risk-shift (intercept) associated with being treated at the "average" hospital</span>
<span id="cb113-566"><a href="#cb113-566" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The <span class="in">`HOSP_EFFECT`</span> corresponds to the risk-shift (intercept) associated with being treated at _your_ hospital</span>
<span id="cb113-567"><a href="#cb113-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-568"><a href="#cb113-568" aria-hidden="true" tabindex="-1"></a>These are estimated by CMS using your discharge lists. They are done so _after_ accounting for all of the risk factors, so by comparing them we get a measure of how much more or less likely a patient is to be readmitted at your hospital versus the average hospital, after risk-adjustment.</span>
<span id="cb113-569"><a href="#cb113-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-570"><a href="#cb113-570" aria-hidden="true" tabindex="-1"></a>We can add each one into our current <span class="in">`linear_predictors`</span> to get the complete linear predictors for the predicted and expected readmission rates:</span>
<span id="cb113-571"><a href="#cb113-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-574"><a href="#cb113-574" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-575"><a href="#cb113-575" aria-hidden="true" tabindex="-1"></a>linear_predictors <span class="ot">&lt;-</span></span>
<span id="cb113-576"><a href="#cb113-576" aria-hidden="true" tabindex="-1"></a>  linear_predictors <span class="sc">|&gt;</span></span>
<span id="cb113-577"><a href="#cb113-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-578"><a href="#cb113-578" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Join to get intercepts</span></span>
<span id="cb113-579"><a href="#cb113-579" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb113-580"><a href="#cb113-580" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> </span>
<span id="cb113-581"><a href="#cb113-581" aria-hidden="true" tabindex="-1"></a>        model_weights <span class="sc">|&gt;</span></span>
<span id="cb113-582"><a href="#cb113-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-583"><a href="#cb113-583" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Filter to intercepts</span></span>
<span id="cb113-584"><a href="#cb113-584" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb113-585"><a href="#cb113-585" aria-hidden="true" tabindex="-1"></a>          stringr<span class="sc">::</span><span class="fu">str_detect</span>(</span>
<span id="cb113-586"><a href="#cb113-586" aria-hidden="true" tabindex="-1"></a>            Factor,</span>
<span id="cb113-587"><a href="#cb113-587" aria-hidden="true" tabindex="-1"></a>            <span class="at">pattern =</span> <span class="st">"_EFFECT$"</span></span>
<span id="cb113-588"><a href="#cb113-588" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb113-589"><a href="#cb113-589" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span></span>
<span id="cb113-590"><a href="#cb113-590" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb113-591"><a href="#cb113-591" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Send over columns</span></span>
<span id="cb113-592"><a href="#cb113-592" aria-hidden="true" tabindex="-1"></a>        tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(</span>
<span id="cb113-593"><a href="#cb113-593" aria-hidden="true" tabindex="-1"></a>          <span class="at">names_from =</span> Factor,</span>
<span id="cb113-594"><a href="#cb113-594" aria-hidden="true" tabindex="-1"></a>          <span class="at">values_from =</span> Value</span>
<span id="cb113-595"><a href="#cb113-595" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb113-596"><a href="#cb113-596" aria-hidden="true" tabindex="-1"></a>      <span class="at">by =</span> <span class="st">"Cohort"</span></span>
<span id="cb113-597"><a href="#cb113-597" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb113-598"><a href="#cb113-598" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb113-599"><a href="#cb113-599" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Finish LP's</span></span>
<span id="cb113-600"><a href="#cb113-600" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb113-601"><a href="#cb113-601" aria-hidden="true" tabindex="-1"></a>      <span class="at">LP_Predicted =</span> LP <span class="sc">+</span> HOSP_EFFECT,</span>
<span id="cb113-602"><a href="#cb113-602" aria-hidden="true" tabindex="-1"></a>      <span class="at">LP_Expected =</span> LP <span class="sc">+</span> AVG_EFFECT</span>
<span id="cb113-603"><a href="#cb113-603" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb113-604"><a href="#cb113-604" aria-hidden="true" tabindex="-1"></a>linear_predictors</span>
<span id="cb113-605"><a href="#cb113-605" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-606"><a href="#cb113-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-607"><a href="#cb113-607" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Transform to Probability Scale</span></span>
<span id="cb113-608"><a href="#cb113-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-609"><a href="#cb113-609" aria-hidden="true" tabindex="-1"></a>The last thing we need to do is transform the linear predictors to the probabilty scale using the <span class="co">[</span><span class="ot">logistic function</span><span class="co">](https://en.wikipedia.org/wiki/Logistic_function)</span> in order for our result to be a risk (i.e., a percentage between 0%-100%). </span>
<span id="cb113-610"><a href="#cb113-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-613"><a href="#cb113-613" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-614"><a href="#cb113-614" aria-hidden="true" tabindex="-1"></a>readmission_risks <span class="ot">&lt;-</span></span>
<span id="cb113-615"><a href="#cb113-615" aria-hidden="true" tabindex="-1"></a>  linear_predictors <span class="sc">|&gt;</span></span>
<span id="cb113-616"><a href="#cb113-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-617"><a href="#cb113-617" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Transform LP's</span></span>
<span id="cb113-618"><a href="#cb113-618" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb113-619"><a href="#cb113-619" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb113-620"><a href="#cb113-620" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(LP_Predicted, LP_Expected),</span>
<span id="cb113-621"><a href="#cb113-621" aria-hidden="true" tabindex="-1"></a>        \(x) <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>x))</span>
<span id="cb113-622"><a href="#cb113-622" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb113-623"><a href="#cb113-623" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb113-624"><a href="#cb113-624" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb113-625"><a href="#cb113-625" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep a few columns</span></span>
<span id="cb113-626"><a href="#cb113-626" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb113-627"><a href="#cb113-627" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">ID Number</span><span class="st">`</span>,</span>
<span id="cb113-628"><a href="#cb113-628" aria-hidden="true" tabindex="-1"></a>      <span class="at">Predicted =</span> LP_Predicted,</span>
<span id="cb113-629"><a href="#cb113-629" aria-hidden="true" tabindex="-1"></a>      <span class="at">Expected =</span> LP_Expected,</span>
<span id="cb113-630"><a href="#cb113-630" aria-hidden="true" tabindex="-1"></a>      Cohort</span>
<span id="cb113-631"><a href="#cb113-631" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb113-632"><a href="#cb113-632" aria-hidden="true" tabindex="-1"></a>readmission_risks</span>
<span id="cb113-633"><a href="#cb113-633" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-634"><a href="#cb113-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-635"><a href="#cb113-635" aria-hidden="true" tabindex="-1"></a>Now we have the _predicted_ and _expected_ readmission risk for each discharge.</span>
<span id="cb113-636"><a href="#cb113-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-637"><a href="#cb113-637" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Doing it Easier {#readmissionrisks}</span></span>
<span id="cb113-638"><a href="#cb113-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-639"><a href="#cb113-639" aria-hidden="true" tabindex="-1"></a>We went through those computations to see how deriving the readmission risks works starting with the discharges. However, we can get this automatically by using the <span class="in">`hsr_readmission_risks()`</span> function:</span>
<span id="cb113-640"><a href="#cb113-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-643"><a href="#cb113-643" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-644"><a href="#cb113-644" aria-hidden="true" tabindex="-1"></a>readmission_risks <span class="ot">&lt;-</span></span>
<span id="cb113-645"><a href="#cb113-645" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setdiff</span>(cohorts, <span class="st">"CABG"</span>) <span class="sc">|&gt;</span></span>
<span id="cb113-646"><a href="#cb113-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-647"><a href="#cb113-647" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Iterate each cohort</span></span>
<span id="cb113-648"><a href="#cb113-648" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">map_df</span>(</span>
<span id="cb113-649"><a href="#cb113-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-650"><a href="#cb113-650" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Import eligible discharges</span></span>
<span id="cb113-651"><a href="#cb113-651" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span><span class="fu">hsr_readmission_risks</span>(</span>
<span id="cb113-652"><a href="#cb113-652" aria-hidden="true" tabindex="-1"></a>        <span class="at">file =</span> my_report,</span>
<span id="cb113-653"><a href="#cb113-653" aria-hidden="true" tabindex="-1"></a>        <span class="at">cohort =</span> .x</span>
<span id="cb113-654"><a href="#cb113-654" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span></span>
<span id="cb113-655"><a href="#cb113-655" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb113-656"><a href="#cb113-656" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Indicate cohort</span></span>
<span id="cb113-657"><a href="#cb113-657" aria-hidden="true" tabindex="-1"></a>      tibble<span class="sc">::</span><span class="fu">add_column</span>(<span class="at">Cohort =</span> .x)</span>
<span id="cb113-658"><a href="#cb113-658" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb113-659"><a href="#cb113-659" aria-hidden="true" tabindex="-1"></a>readmission_risks</span>
<span id="cb113-660"><a href="#cb113-660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-661"><a href="#cb113-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-662"><a href="#cb113-662" aria-hidden="true" tabindex="-1"></a>This function extracts eligible discharges and computes the readmission risk, so it captures everything we just did up to this point.</span>
<span id="cb113-663"><a href="#cb113-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-664"><a href="#cb113-664" aria-hidden="true" tabindex="-1"></a><span class="fu">### iv. Compute Cohort-Level Results</span></span>
<span id="cb113-665"><a href="#cb113-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-666"><a href="#cb113-666" aria-hidden="true" tabindex="-1"></a>Now that we have <span class="co">[</span><span class="ot">individual level readmission risks</span><span class="co">](#readmissionrisks)</span>, we can roll these up to get cohort-level results. The main calculation we need to do is compute the cohort-level predicted and expected readmission rates, which is just the _average_ of the individual ones.</span>
<span id="cb113-667"><a href="#cb113-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-670"><a href="#cb113-670" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-671"><a href="#cb113-671" aria-hidden="true" tabindex="-1"></a>cohort_rates <span class="ot">&lt;-</span></span>
<span id="cb113-672"><a href="#cb113-672" aria-hidden="true" tabindex="-1"></a>  readmission_risks <span class="sc">|&gt;</span></span>
<span id="cb113-673"><a href="#cb113-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-674"><a href="#cb113-674" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute cohort-level stats</span></span>
<span id="cb113-675"><a href="#cb113-675" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarize</span>(</span>
<span id="cb113-676"><a href="#cb113-676" aria-hidden="true" tabindex="-1"></a>      <span class="at">Discharges =</span> dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="cb113-677"><a href="#cb113-677" aria-hidden="true" tabindex="-1"></a>      <span class="at">Predicted =</span> <span class="fu">mean</span>(Predicted),</span>
<span id="cb113-678"><a href="#cb113-678" aria-hidden="true" tabindex="-1"></a>      <span class="at">Expected =</span> <span class="fu">mean</span>(Expected),</span>
<span id="cb113-679"><a href="#cb113-679" aria-hidden="true" tabindex="-1"></a>      <span class="at">.by =</span> Cohort</span>
<span id="cb113-680"><a href="#cb113-680" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb113-681"><a href="#cb113-681" aria-hidden="true" tabindex="-1"></a>cohort_rates</span>
<span id="cb113-682"><a href="#cb113-682" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-683"><a href="#cb113-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-684"><a href="#cb113-684" aria-hidden="true" tabindex="-1"></a>We can compare this to our <span class="co">[</span><span class="ot">previous cohort summary</span><span class="co">](#cohortsummary)</span> and see that it matches what was already in the table:</span>
<span id="cb113-685"><a href="#cb113-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-688"><a href="#cb113-688" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-689"><a href="#cb113-689" aria-hidden="true" tabindex="-1"></a>cohort_summary <span class="sc">|&gt;</span></span>
<span id="cb113-690"><a href="#cb113-690" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb113-691"><a href="#cb113-691" aria-hidden="true" tabindex="-1"></a>      <span class="at">Cohort =</span> <span class="st">`</span><span class="at">Measure [a]</span><span class="st">`</span>,</span>
<span id="cb113-692"><a href="#cb113-692" aria-hidden="true" tabindex="-1"></a>      <span class="at">Discharges =</span> <span class="st">`</span><span class="at">Number of Eligible Discharges [b]</span><span class="st">`</span>,</span>
<span id="cb113-693"><a href="#cb113-693" aria-hidden="true" tabindex="-1"></a>      <span class="at">Predicted =</span> <span class="st">`</span><span class="at">Predicted Readmission Rate [d]</span><span class="st">`</span>,</span>
<span id="cb113-694"><a href="#cb113-694" aria-hidden="true" tabindex="-1"></a>      <span class="at">Expected =</span> <span class="st">`</span><span class="at">Expected Readmission Rate [e]</span><span class="st">`</span></span>
<span id="cb113-695"><a href="#cb113-695" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb113-696"><a href="#cb113-696" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-697"><a href="#cb113-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-698"><a href="#cb113-698" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Pulling in Additional Info {#cohortcontributions}</span></span>
<span id="cb113-699"><a href="#cb113-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-700"><a href="#cb113-700" aria-hidden="true" tabindex="-1"></a>Recall <span class="co">[</span><span class="ot">earlier</span><span class="co">](#cohortsummary)</span> how we calculated the payment penalty from the cohort-level data. It was done by computing the:</span>
<span id="cb113-701"><a href="#cb113-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-702"><a href="#cb113-702" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Excess readmission ratio (ERR) for each cohort</span>
<span id="cb113-703"><a href="#cb113-703" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Difference between (1) and the peer group median ERR for each cohort</span>
<span id="cb113-704"><a href="#cb113-704" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Sum (2) across cohorts, weighted by DRG ratios</span>
<span id="cb113-705"><a href="#cb113-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-706"><a href="#cb113-706" aria-hidden="true" tabindex="-1"></a>We can do (1) right away with our current <span class="in">`cohort_rates`</span> dataset:</span>
<span id="cb113-707"><a href="#cb113-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-710"><a href="#cb113-710" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-711"><a href="#cb113-711" aria-hidden="true" tabindex="-1"></a>cohort_rates <span class="ot">&lt;-</span></span>
<span id="cb113-712"><a href="#cb113-712" aria-hidden="true" tabindex="-1"></a>  cohort_rates <span class="sc">|&gt;</span></span>
<span id="cb113-713"><a href="#cb113-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-714"><a href="#cb113-714" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute the ERR</span></span>
<span id="cb113-715"><a href="#cb113-715" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb113-716"><a href="#cb113-716" aria-hidden="true" tabindex="-1"></a>      <span class="at">ERR =</span> Predicted <span class="sc">/</span> Expected</span>
<span id="cb113-717"><a href="#cb113-717" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb113-718"><a href="#cb113-718" aria-hidden="true" tabindex="-1"></a>cohort_rates</span>
<span id="cb113-719"><a href="#cb113-719" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-720"><a href="#cb113-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-721"><a href="#cb113-721" aria-hidden="true" tabindex="-1"></a>For the rest, we need to add the peer group medians and DRG ratios to our <span class="in">`cohort_rates`</span> dataset, which we can get from our existing <span class="in">`cohort_summary`</span> dataset that we <span class="co">[</span><span class="ot">extracted earlier</span><span class="co">](#cohortsummary)</span>:</span>
<span id="cb113-722"><a href="#cb113-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-725"><a href="#cb113-725" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-726"><a href="#cb113-726" aria-hidden="true" tabindex="-1"></a>cohort_rates <span class="ot">&lt;-</span></span>
<span id="cb113-727"><a href="#cb113-727" aria-hidden="true" tabindex="-1"></a>  cohort_rates <span class="sc">|&gt;</span></span>
<span id="cb113-728"><a href="#cb113-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-729"><a href="#cb113-729" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Join to get reference info</span></span>
<span id="cb113-730"><a href="#cb113-730" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb113-731"><a href="#cb113-731" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> </span>
<span id="cb113-732"><a href="#cb113-732" aria-hidden="true" tabindex="-1"></a>        cohort_summary <span class="sc">|&gt;</span></span>
<span id="cb113-733"><a href="#cb113-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-734"><a href="#cb113-734" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Make matching names</span></span>
<span id="cb113-735"><a href="#cb113-735" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb113-736"><a href="#cb113-736" aria-hidden="true" tabindex="-1"></a>          <span class="at">Cohort =</span> <span class="st">`</span><span class="at">Measure [a]</span><span class="st">`</span>,</span>
<span id="cb113-737"><a href="#cb113-737" aria-hidden="true" tabindex="-1"></a>          <span class="at">Cohort =</span> </span>
<span id="cb113-738"><a href="#cb113-738" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb113-739"><a href="#cb113-739" aria-hidden="true" tabindex="-1"></a>              Cohort <span class="sc">==</span> <span class="st">"Pneumonia"</span> <span class="sc">~</span> <span class="st">"PN"</span>,</span>
<span id="cb113-740"><a href="#cb113-740" aria-hidden="true" tabindex="-1"></a>              Cohort <span class="sc">==</span> <span class="st">"THA/TKA"</span> <span class="sc">~</span> <span class="st">"HK"</span>,</span>
<span id="cb113-741"><a href="#cb113-741" aria-hidden="true" tabindex="-1"></a>              <span class="cn">TRUE</span> <span class="sc">~</span> Cohort</span>
<span id="cb113-742"><a href="#cb113-742" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb113-743"><a href="#cb113-743" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span></span>
<span id="cb113-744"><a href="#cb113-744" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb113-745"><a href="#cb113-745" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Keep a few columns</span></span>
<span id="cb113-746"><a href="#cb113-746" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb113-747"><a href="#cb113-747" aria-hidden="true" tabindex="-1"></a>          Cohort,</span>
<span id="cb113-748"><a href="#cb113-748" aria-hidden="true" tabindex="-1"></a>          <span class="at">PeerGroupERR =</span> <span class="st">`</span><span class="at">Peer Group Median ERR [g]</span><span class="st">`</span>,</span>
<span id="cb113-749"><a href="#cb113-749" aria-hidden="true" tabindex="-1"></a>          <span class="at">DRGRatio =</span> <span class="st">`</span><span class="at">Ratio of DRG Payments Per Measure to Total Payments [i]</span><span class="st">`</span></span>
<span id="cb113-750"><a href="#cb113-750" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb113-751"><a href="#cb113-751" aria-hidden="true" tabindex="-1"></a>      <span class="at">by =</span> <span class="st">"Cohort"</span></span>
<span id="cb113-752"><a href="#cb113-752" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb113-753"><a href="#cb113-753" aria-hidden="true" tabindex="-1"></a>cohort_rates</span>
<span id="cb113-754"><a href="#cb113-754" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-755"><a href="#cb113-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-756"><a href="#cb113-756" aria-hidden="true" tabindex="-1"></a>Finally, we can indicate which cohorts received penalty and how much they contributed. Recall, a cohort is only eligible to receive penalty if:</span>
<span id="cb113-757"><a href="#cb113-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-758"><a href="#cb113-758" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>They have at least 25 discharges</span>
<span id="cb113-759"><a href="#cb113-759" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>The ERR is greater than the peer group median ERR</span>
<span id="cb113-760"><a href="#cb113-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-761"><a href="#cb113-761" aria-hidden="true" tabindex="-1"></a>Thus, we can see, for example, that the COPD group had an ERR greater than the peer group median, but won't actually contribute penalty because there were too few cases. Let's compute the actual contribution for each cohort:</span>
<span id="cb113-762"><a href="#cb113-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-765"><a href="#cb113-765" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-766"><a href="#cb113-766" aria-hidden="true" tabindex="-1"></a>cohort_rates <span class="ot">&lt;-</span></span>
<span id="cb113-767"><a href="#cb113-767" aria-hidden="true" tabindex="-1"></a>  cohort_rates <span class="sc">|&gt;</span></span>
<span id="cb113-768"><a href="#cb113-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-769"><a href="#cb113-769" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute penalty contribution</span></span>
<span id="cb113-770"><a href="#cb113-770" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb113-771"><a href="#cb113-771" aria-hidden="true" tabindex="-1"></a>      <span class="at">IsPenalized =</span> <span class="fu">as.numeric</span>(ERR <span class="sc">&gt;</span> PeerGroupERR <span class="sc">&amp;</span> Discharges <span class="sc">&gt;=</span> <span class="dv">25</span>),</span>
<span id="cb113-772"><a href="#cb113-772" aria-hidden="true" tabindex="-1"></a>      <span class="at">PenaltyContribution =</span> (ERR <span class="sc">-</span> PeerGroupERR) <span class="sc">*</span> DRGRatio,</span>
<span id="cb113-773"><a href="#cb113-773" aria-hidden="true" tabindex="-1"></a>      <span class="at">PenaltyContribution =</span> IsPenalized <span class="sc">*</span> PenaltyContribution</span>
<span id="cb113-774"><a href="#cb113-774" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb113-775"><a href="#cb113-775" aria-hidden="true" tabindex="-1"></a>cohort_rates</span>
<span id="cb113-776"><a href="#cb113-776" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-777"><a href="#cb113-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-778"><a href="#cb113-778" aria-hidden="true" tabindex="-1"></a>Ultimately, based on these criteria, this hospital is only penalized in the Pneumonia cohort. </span>
<span id="cb113-779"><a href="#cb113-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-780"><a href="#cb113-780" aria-hidden="true" tabindex="-1"></a><span class="fu">### v. Aggregate to the Program Result</span></span>
<span id="cb113-781"><a href="#cb113-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-782"><a href="#cb113-782" aria-hidden="true" tabindex="-1"></a>Now that we have the <span class="co">[</span><span class="ot">contributions of each cohort</span><span class="co">](#cohortcontributions)</span>, we can aggregate them into our final penalty amount. We'll do this step by step:</span>
<span id="cb113-783"><a href="#cb113-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-784"><a href="#cb113-784" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Add up the cohort contributions</span>
<span id="cb113-785"><a href="#cb113-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-786"><a href="#cb113-786" aria-hidden="true" tabindex="-1"></a>We just computed these in the prior step.</span>
<span id="cb113-787"><a href="#cb113-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-790"><a href="#cb113-790" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-791"><a href="#cb113-791" aria-hidden="true" tabindex="-1"></a>temp_penalty <span class="ot">&lt;-</span> <span class="fu">sum</span>(cohort_rates<span class="sc">$</span>PenaltyContribution)</span>
<span id="cb113-792"><a href="#cb113-792" aria-hidden="true" tabindex="-1"></a>temp_penalty</span>
<span id="cb113-793"><a href="#cb113-793" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-794"><a href="#cb113-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-795"><a href="#cb113-795" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Multiply (1) by the neutrality modifier</span>
<span id="cb113-796"><a href="#cb113-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-797"><a href="#cb113-797" aria-hidden="true" tabindex="-1"></a>The neutrality modifier was found in our <span class="co">[</span><span class="ot">program summary</span><span class="co">](#programsummary)</span> earlier. We can just extract from there.</span>
<span id="cb113-798"><a href="#cb113-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-801"><a href="#cb113-801" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-802"><a href="#cb113-802" aria-hidden="true" tabindex="-1"></a>penalty <span class="ot">&lt;-</span> temp_penalty <span class="sc">*</span> my_payment_summary<span class="sc">$</span><span class="st">`</span><span class="at">Neutrality Modifier [e]</span><span class="st">`</span></span>
<span id="cb113-803"><a href="#cb113-803" aria-hidden="true" tabindex="-1"></a>penalty</span>
<span id="cb113-804"><a href="#cb113-804" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-805"><a href="#cb113-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-806"><a href="#cb113-806" aria-hidden="true" tabindex="-1"></a>We can see that matches what was reported in the <span class="co">[</span><span class="ot">program summary</span><span class="co">](#programsummary)</span>:</span>
<span id="cb113-807"><a href="#cb113-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-810"><a href="#cb113-810" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-811"><a href="#cb113-811" aria-hidden="true" tabindex="-1"></a>my_payment_summary<span class="sc">$</span><span class="st">`</span><span class="at">Payment Reduction Percentage [f]</span><span class="st">`</span></span>
<span id="cb113-812"><a href="#cb113-812" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-813"><a href="#cb113-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-814"><a href="#cb113-814" aria-hidden="true" tabindex="-1"></a>This is the final penalty amount.</span>
<span id="cb113-815"><a href="#cb113-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-816"><a href="#cb113-816" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Implication</span></span>
<span id="cb113-817"><a href="#cb113-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-818"><a href="#cb113-818" aria-hidden="true" tabindex="-1"></a>Recall that the (mock) report we've been working with is from FY2025.</span>
<span id="cb113-819"><a href="#cb113-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-822"><a href="#cb113-822" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-823"><a href="#cb113-823" aria-hidden="true" tabindex="-1"></a>my_report</span>
<span id="cb113-824"><a href="#cb113-824" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-825"><a href="#cb113-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-826"><a href="#cb113-826" aria-hidden="true" tabindex="-1"></a>Let's remind ourselves of the payment period for this program year:</span>
<span id="cb113-827"><a href="#cb113-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-830"><a href="#cb113-830" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-831"><a href="#cb113-831" aria-hidden="true" tabindex="-1"></a>my_payment_period <span class="ot">&lt;-</span></span>
<span id="cb113-832"><a href="#cb113-832" aria-hidden="true" tabindex="-1"></a>  hrrp_payment_periods <span class="sc">|&gt;</span></span>
<span id="cb113-833"><a href="#cb113-833" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(ProgramYear <span class="sc">==</span> <span class="dv">2025</span>)</span>
<span id="cb113-834"><a href="#cb113-834" aria-hidden="true" tabindex="-1"></a>my_payment_period</span>
<span id="cb113-835"><a href="#cb113-835" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-836"><a href="#cb113-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-837"><a href="#cb113-837" aria-hidden="true" tabindex="-1"></a>So from <span class="in">`r format(my_payment_period$StartDate, "%m/%d/%Y")`</span> through <span class="in">`r format(my_payment_period$EndDate, "%m/%d/%Y")`</span>, all Medicare payments for this hospital were reduced by <span class="in">`r paste0(round(penalty * 100, 3), "%")`</span>.</span>
<span id="cb113-838"><a href="#cb113-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-839"><a href="#cb113-839" aria-hidden="true" tabindex="-1"></a><span class="fu">### Key Observations</span></span>
<span id="cb113-840"><a href="#cb113-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-841"><a href="#cb113-841" aria-hidden="true" tabindex="-1"></a>Some important things to note about the penalty calculation:</span>
<span id="cb113-842"><a href="#cb113-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-843"><a href="#cb113-843" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Readmissions Themselves Don't Compute Penalty</span></span>
<span id="cb113-844"><a href="#cb113-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-845"><a href="#cb113-845" aria-hidden="true" tabindex="-1"></a>Notice that in the calculation of the penalty, we never explicity used or pulled out the actual discharges that readmitted, or used an "observed" readmission rate (i.e., the simple fraction of discharges that were readmitted). Instead, _all_ discharges were fed into a statistical model to compute the predicted and expected readmission rates for the whole group, and then were aggregated. The actual readmission cases at your hospital were used upstream to fit that statistical model, in a pool along with data from all other hospitals. Thus, the readmissions from your hospital only contribute in an indirect way: they inform the resulting _hospital effect_ estimated from the statistical model, after adjusting for clinical history, which in turn is built into the calculated _predicted_ readmission rate that is computed on each discharge and used downstream in the penalty calculation.</span>
<span id="cb113-846"><a href="#cb113-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-847"><a href="#cb113-847" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Cohorts Aren't Weighted Equally</span></span>
<span id="cb113-848"><a href="#cb113-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-849"><a href="#cb113-849" aria-hidden="true" tabindex="-1"></a>First, remember that even if a cohort has excessive readmissions, they may not contribute to the penalty if there aren't enough discharges. But beyond that point: the cohort-level contribution to the penalty is not necessarily proportional to how many readmissions they had. It also has to do with how many of those patients are seen at the hospital. Recall that we took the penalty contribution amount and multiplied it by the ratio of DRG's relevant to that cohort out of all payments. This means that it is possible that a cohort with a slight excess in readmissions can contribute much more to the overall penalty amount than another cohort with huge excess, if the former is a much more high-volume diagnosis at your hospital. So you must consider the full picture.</span>
<span id="cb113-850"><a href="#cb113-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-851"><a href="#cb113-851" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Statistical Models Aren't Perfect</span></span>
<span id="cb113-852"><a href="#cb113-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-853"><a href="#cb113-853" aria-hidden="true" tabindex="-1"></a>Recall that CMS fits random-intercept logistic regression models on a combined dataset from all participating hospitals for each cohort. There are tons of assumptions and nuances that go into these models that make them far from perfect arbitors of truth. For example, each risk factor is added to the model as an independent factor, so no interactions between them are assumed. Additionally, effects are estimated on a combined dataset for all hospitals, which therefore assumes the effect of each clinical factor for risk adjustment is the same for all hospitals. On top of that, each of these risk factors is defined by claims documentation, and, specifically, groupings of ICD codes that may be inconsistent across hospitals. Then, these models are used to estimate individual level readmission risks, leading to group-level excess readmission ratios, that are then compared to a peer group _median_ value to indicate penalty--so by definition, half of hospitals are getting flagged no matter what, even if everyone is doing well. We could keep going down the list of nuances, but it's important to at least acknowledge and understand the mechanics of how these things work. </span>
<span id="cb113-854"><a href="#cb113-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-855"><a href="#cb113-855" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2. Understanding Model Weights</span></span>
<span id="cb113-856"><a href="#cb113-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-857"><a href="#cb113-857" aria-hidden="true" tabindex="-1"></a>As described <span class="co">[</span><span class="ot">previously</span><span class="co">](#modelcoefficients)</span>, the _predicted_ and _expected_ readmission rates are based on risk models developed by CMS that estimate hospital-level effects so that individual hospitals can be compared to an "average" hospital for penalty determination. Additionally, these models _risk-adjust_ for individual patient clinical history as to tease out impacts due to the _hospital_ itself instead of the overall morbidity of the population it serves. Thus, each model contains a long list of covariates (risk factors) which can be explored to gain further insight into the mechanics of the program. You can find more details about the model methodology <span class="co">[</span><span class="ot">here</span><span class="co">](https://qualitynet.cms.gov/inpatient/measures/readmission/methodology)</span>.</span>
<span id="cb113-858"><a href="#cb113-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-859"><a href="#cb113-859" aria-hidden="true" tabindex="-1"></a><span class="fu">### What Do They Mean?</span></span>
<span id="cb113-860"><a href="#cb113-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-861"><a href="#cb113-861" aria-hidden="true" tabindex="-1"></a>The first thing worth understanding are what the model estimates mean and how to interpret them. Recall from <span class="co">[</span><span class="ot">above</span><span class="co">](#modelcoefficients)</span> that we can extract the model coefficients, which are found in the first row of the discharge-level data for each cohort, from the HSR with the <span class="in">`hsr_coefficients()`</span> function, which we previously extracted <span class="co">[</span><span class="ot">above</span><span class="co">](#individualreadmissionrisk)</span>:</span>
<span id="cb113-862"><a href="#cb113-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-865"><a href="#cb113-865" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-866"><a href="#cb113-866" aria-hidden="true" tabindex="-1"></a>model_weights</span>
<span id="cb113-867"><a href="#cb113-867" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-868"><a href="#cb113-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-869"><a href="#cb113-869" aria-hidden="true" tabindex="-1"></a>These are the weights (coefficients) of the regression equation that we use to weight individual patient risk factors. Remember that these are currently on the scale of the <span class="co">[</span><span class="ot">linear predictor</span><span class="co">](#linearpredictor)</span>. To make them intuitive and interpretable. we can _exponentiate_ them to put them on the _[odds ratio](https://en.wikipedia.org/wiki/Odds_ratio)_ scale.</span>
<span id="cb113-870"><a href="#cb113-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-873"><a href="#cb113-873" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-874"><a href="#cb113-874" aria-hidden="true" tabindex="-1"></a>model_weights <span class="sc">|&gt;</span></span>
<span id="cb113-875"><a href="#cb113-875" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb113-876"><a href="#cb113-876" aria-hidden="true" tabindex="-1"></a>    <span class="at">OR =</span> <span class="fu">exp</span>(Value)</span>
<span id="cb113-877"><a href="#cb113-877" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb113-878"><a href="#cb113-878" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-879"><a href="#cb113-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-880"><a href="#cb113-880" aria-hidden="true" tabindex="-1"></a>For example, according to these estimates, the odds of a readmission for males are <span class="in">`r paste0(round(100 * (1-exp(model_weights$Value[model_weights$Factor == "Male" &amp; model_weights$Cohort == "AMI"])), 1), "%")`</span> lower than females on average for the AMI cohort. So one thing we can do is assess these across all factors to better understand how each risk factor is weighted, by which direction, and how much.</span>
<span id="cb113-881"><a href="#cb113-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-882"><a href="#cb113-882" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Relative Importance </span></span>
<span id="cb113-883"><a href="#cb113-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-884"><a href="#cb113-884" aria-hidden="true" tabindex="-1"></a>A more tractable way to organize them for understanding is to rank them by the magnitude of their effects to get a sense of which factors have the most impact on the readmission risk calculation. Here we'll make a plot of the top five (5) most heavily-weighted factors for each cohort:</span>
<span id="cb113-885"><a href="#cb113-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-888"><a href="#cb113-888" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-889"><a href="#cb113-889" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb113-890"><a href="#cb113-890" aria-hidden="true" tabindex="-1"></a>model_weights <span class="sc">|&gt;</span></span>
<span id="cb113-891"><a href="#cb113-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-892"><a href="#cb113-892" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove intercepts</span></span>
<span id="cb113-893"><a href="#cb113-893" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>stringr<span class="sc">::</span><span class="fu">str_detect</span>(Factor, <span class="st">"_EFFECT$"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb113-894"><a href="#cb113-894" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-895"><a href="#cb113-895" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rank by group</span></span>
<span id="cb113-896"><a href="#cb113-896" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb113-897"><a href="#cb113-897" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rank =</span> <span class="fu">order</span>(<span class="fu">order</span>(<span class="fu">abs</span>(Value), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb113-898"><a href="#cb113-898" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="st">"Cohort"</span></span>
<span id="cb113-899"><a href="#cb113-899" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb113-900"><a href="#cb113-900" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-901"><a href="#cb113-901" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter to top 10</span></span>
<span id="cb113-902"><a href="#cb113-902" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Rank <span class="sc">&lt;=</span> <span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb113-903"><a href="#cb113-903" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-904"><a href="#cb113-904" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make a plot</span></span>
<span id="cb113-905"><a href="#cb113-905" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb113-906"><a href="#cb113-906" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(</span>
<span id="cb113-907"><a href="#cb113-907" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb113-908"><a href="#cb113-908" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> stringr<span class="sc">::</span><span class="fu">str_sub</span>(Factor, <span class="dv">1</span>, <span class="dv">20</span>),</span>
<span id="cb113-909"><a href="#cb113-909" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> <span class="dv">1</span>,</span>
<span id="cb113-910"><a href="#cb113-910" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> <span class="fu">exp</span>(Value),</span>
<span id="cb113-911"><a href="#cb113-911" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> stringr<span class="sc">::</span><span class="fu">str_sub</span>(Factor, <span class="dv">1</span>, <span class="dv">20</span>)</span>
<span id="cb113-912"><a href="#cb113-912" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb113-913"><a href="#cb113-913" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb113-914"><a href="#cb113-914" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb113-915"><a href="#cb113-915" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb113-916"><a href="#cb113-916" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb113-917"><a href="#cb113-917" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Cohort, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">nrow =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb113-918"><a href="#cb113-918" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb113-919"><a href="#cb113-919" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb113-920"><a href="#cb113-920" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Risk Factor"</span>) <span class="sc">+</span></span>
<span id="cb113-921"><a href="#cb113-921" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Odds Ratio"</span>)</span>
<span id="cb113-922"><a href="#cb113-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-923"><a href="#cb113-923" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-924"><a href="#cb113-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-925"><a href="#cb113-925" aria-hidden="true" tabindex="-1"></a>We can see, for example, that _Dialysis Status_ is an important factor that shows up across multiple cohort models, thus having heavy impact on program results.</span>
<span id="cb113-926"><a href="#cb113-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-927"><a href="#cb113-927" aria-hidden="true" tabindex="-1"></a>We can create the full listing in a table format:</span>
<span id="cb113-928"><a href="#cb113-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-931"><a href="#cb113-931" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-932"><a href="#cb113-932" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reactable)</span>
<span id="cb113-933"><a href="#cb113-933" aria-hidden="true" tabindex="-1"></a>model_weights <span class="sc">|&gt;</span></span>
<span id="cb113-934"><a href="#cb113-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-935"><a href="#cb113-935" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove intercepts</span></span>
<span id="cb113-936"><a href="#cb113-936" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>stringr<span class="sc">::</span><span class="fu">str_detect</span>(Factor, <span class="st">"_EFFECT$"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb113-937"><a href="#cb113-937" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-938"><a href="#cb113-938" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rank by group</span></span>
<span id="cb113-939"><a href="#cb113-939" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb113-940"><a href="#cb113-940" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rank =</span> <span class="fu">order</span>(<span class="fu">order</span>(<span class="fu">abs</span>(Value), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb113-941"><a href="#cb113-941" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="st">"Cohort"</span></span>
<span id="cb113-942"><a href="#cb113-942" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb113-943"><a href="#cb113-943" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-944"><a href="#cb113-944" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute odds ratio</span></span>
<span id="cb113-945"><a href="#cb113-945" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb113-946"><a href="#cb113-946" aria-hidden="true" tabindex="-1"></a>    <span class="at">OR =</span> <span class="fu">exp</span>(Value)</span>
<span id="cb113-947"><a href="#cb113-947" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb113-948"><a href="#cb113-948" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-949"><a href="#cb113-949" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rearrange</span></span>
<span id="cb113-950"><a href="#cb113-950" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb113-951"><a href="#cb113-951" aria-hidden="true" tabindex="-1"></a>    Cohort,</span>
<span id="cb113-952"><a href="#cb113-952" aria-hidden="true" tabindex="-1"></a>    Factor,</span>
<span id="cb113-953"><a href="#cb113-953" aria-hidden="true" tabindex="-1"></a>    Rank,</span>
<span id="cb113-954"><a href="#cb113-954" aria-hidden="true" tabindex="-1"></a>    Value,</span>
<span id="cb113-955"><a href="#cb113-955" aria-hidden="true" tabindex="-1"></a>    OR</span>
<span id="cb113-956"><a href="#cb113-956" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb113-957"><a href="#cb113-957" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(</span>
<span id="cb113-958"><a href="#cb113-958" aria-hidden="true" tabindex="-1"></a>    Cohort,</span>
<span id="cb113-959"><a href="#cb113-959" aria-hidden="true" tabindex="-1"></a>    Rank</span>
<span id="cb113-960"><a href="#cb113-960" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb113-961"><a href="#cb113-961" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-962"><a href="#cb113-962" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make a table</span></span>
<span id="cb113-963"><a href="#cb113-963" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reactable</span>(</span>
<span id="cb113-964"><a href="#cb113-964" aria-hidden="true" tabindex="-1"></a>    <span class="at">groupBy =</span> <span class="st">"Cohort"</span>,</span>
<span id="cb113-965"><a href="#cb113-965" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> </span>
<span id="cb113-966"><a href="#cb113-966" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb113-967"><a href="#cb113-967" aria-hidden="true" tabindex="-1"></a>        <span class="at">Factor =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Risk Factor"</span>),</span>
<span id="cb113-968"><a href="#cb113-968" aria-hidden="true" tabindex="-1"></a>        <span class="at">Value =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Coefficient"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">2</span>)),</span>
<span id="cb113-969"><a href="#cb113-969" aria-hidden="true" tabindex="-1"></a>        <span class="at">OR =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Odds-Ratio"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">2</span>))</span>
<span id="cb113-970"><a href="#cb113-970" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb113-971"><a href="#cb113-971" aria-hidden="true" tabindex="-1"></a>      <span class="at">searchable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb113-972"><a href="#cb113-972" aria-hidden="true" tabindex="-1"></a>      <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb113-973"><a href="#cb113-973" aria-hidden="true" tabindex="-1"></a>      <span class="at">filterable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb113-974"><a href="#cb113-974" aria-hidden="true" tabindex="-1"></a>      <span class="at">resizable =</span> <span class="cn">TRUE</span></span>
<span id="cb113-975"><a href="#cb113-975" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb113-976"><a href="#cb113-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-977"><a href="#cb113-977" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-978"><a href="#cb113-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-979"><a href="#cb113-979" aria-hidden="true" tabindex="-1"></a><span class="fu">### Risk Factor Prevalence</span></span>
<span id="cb113-980"><a href="#cb113-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-981"><a href="#cb113-981" aria-hidden="true" tabindex="-1"></a>We now understand the model output, but how can we incorporate the risk factors in our discharge datasets to gain additional insight?</span>
<span id="cb113-982"><a href="#cb113-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-983"><a href="#cb113-983" aria-hidden="true" tabindex="-1"></a>Recall, the way we calculated the readmission risks was by taking a weighted-sum of the risk factors in our dataset with the model weights (and then doing some transformations to turn it into a probability). We just established that different factors yield different effects (weight) on the readmission risks from the model side and how that can be useful for understanding how CMS weights different clinical history factors. </span>
<span id="cb113-984"><a href="#cb113-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-985"><a href="#cb113-985" aria-hidden="true" tabindex="-1"></a>The next thing we can seek to understand is how prevalent each of the risk factors are for your cohort. This is useful for a few reasons:</span>
<span id="cb113-986"><a href="#cb113-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-987"><a href="#cb113-987" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>You can compare to see if the rates of various risk factors are similar for your hospital versus peer group hospitals</span>
<span id="cb113-988"><a href="#cb113-988" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>It gives insight into the difference between model importance for readmission risk vs. how prevalent the risk factor is</span>
<span id="cb113-989"><a href="#cb113-989" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>We can use the combination of model weights and prevalence of risk factors to understand overall impact. For example, a risk factor that has an average impact in terms of odds-ratio but has very high prevalence at your hospital may have more overall net impact on your HRRP readmission metrics than the most important factor according to the model but has very few patients with it at your hospital.</span>
<span id="cb113-990"><a href="#cb113-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-991"><a href="#cb113-991" aria-hidden="true" tabindex="-1"></a>The first step get at this analysis is to compute these from your datasets. We can do this by manipulating the output of <span class="in">`hsr_discharges()`</span> after using the <span class="in">`risk_factors=TRUE`</span> argument. Here is an example of how we'd do this for AMI:</span>
<span id="cb113-992"><a href="#cb113-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-995"><a href="#cb113-995" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-996"><a href="#cb113-996" aria-hidden="true" tabindex="-1"></a><span class="fu">hsr_discharges</span>(</span>
<span id="cb113-997"><a href="#cb113-997" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> my_report,</span>
<span id="cb113-998"><a href="#cb113-998" aria-hidden="true" tabindex="-1"></a>  <span class="at">cohort =</span> <span class="st">"AMI"</span>,</span>
<span id="cb113-999"><a href="#cb113-999" aria-hidden="true" tabindex="-1"></a>  <span class="at">discharge_phi =</span> <span class="cn">FALSE</span>,</span>
<span id="cb113-1000"><a href="#cb113-1000" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk_factors =</span> <span class="cn">TRUE</span>,</span>
<span id="cb113-1001"><a href="#cb113-1001" aria-hidden="true" tabindex="-1"></a>  <span class="at">eligible_only =</span> <span class="cn">TRUE</span></span>
<span id="cb113-1002"><a href="#cb113-1002" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb113-1003"><a href="#cb113-1003" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1004"><a href="#cb113-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1005"><a href="#cb113-1005" aria-hidden="true" tabindex="-1"></a>However, we've already <span class="co">[</span><span class="ot">done this earlier</span><span class="co">](#riskfactors)</span> in our exercises, so we'll use that <span class="in">`risk_factors`</span> dataset:</span>
<span id="cb113-1006"><a href="#cb113-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1009"><a href="#cb113-1009" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-1010"><a href="#cb113-1010" aria-hidden="true" tabindex="-1"></a>risk_factors</span>
<span id="cb113-1011"><a href="#cb113-1011" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1012"><a href="#cb113-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1013"><a href="#cb113-1013" aria-hidden="true" tabindex="-1"></a>Now we can compute the prevalence for each risk factor (in each cohort) by simply taking the average <span class="in">`Value`</span>, because all of these are binary factors (except for Age):</span>
<span id="cb113-1014"><a href="#cb113-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1017"><a href="#cb113-1017" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-1018"><a href="#cb113-1018" aria-hidden="true" tabindex="-1"></a>prevalence <span class="ot">&lt;-</span></span>
<span id="cb113-1019"><a href="#cb113-1019" aria-hidden="true" tabindex="-1"></a>  risk_factors <span class="sc">|&gt;</span></span>
<span id="cb113-1020"><a href="#cb113-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1021"><a href="#cb113-1021" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove age (for demo purposes)</span></span>
<span id="cb113-1022"><a href="#cb113-1022" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>stringr<span class="sc">::</span><span class="fu">str_detect</span>(Factor, <span class="st">"^Years"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb113-1023"><a href="#cb113-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1024"><a href="#cb113-1024" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute average</span></span>
<span id="cb113-1025"><a href="#cb113-1025" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarize</span>(</span>
<span id="cb113-1026"><a href="#cb113-1026" aria-hidden="true" tabindex="-1"></a>      <span class="at">N =</span> dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="cb113-1027"><a href="#cb113-1027" aria-hidden="true" tabindex="-1"></a>      <span class="at">Count =</span> <span class="fu">sum</span>(Value),</span>
<span id="cb113-1028"><a href="#cb113-1028" aria-hidden="true" tabindex="-1"></a>      <span class="at">Rate =</span> Count <span class="sc">/</span> N,</span>
<span id="cb113-1029"><a href="#cb113-1029" aria-hidden="true" tabindex="-1"></a>      <span class="at">.by =</span> </span>
<span id="cb113-1030"><a href="#cb113-1030" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(</span>
<span id="cb113-1031"><a href="#cb113-1031" aria-hidden="true" tabindex="-1"></a>          Cohort,</span>
<span id="cb113-1032"><a href="#cb113-1032" aria-hidden="true" tabindex="-1"></a>          Factor</span>
<span id="cb113-1033"><a href="#cb113-1033" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb113-1034"><a href="#cb113-1034" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb113-1035"><a href="#cb113-1035" aria-hidden="true" tabindex="-1"></a>prevalence</span>
<span id="cb113-1036"><a href="#cb113-1036" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1037"><a href="#cb113-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1038"><a href="#cb113-1038" aria-hidden="true" tabindex="-1"></a>Then we could put all of these into a navigatable table:</span>
<span id="cb113-1039"><a href="#cb113-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1042"><a href="#cb113-1042" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-1043"><a href="#cb113-1043" aria-hidden="true" tabindex="-1"></a>prevalence <span class="sc">|&gt;</span></span>
<span id="cb113-1044"><a href="#cb113-1044" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-1045"><a href="#cb113-1045" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Arrange</span></span>
<span id="cb113-1046"><a href="#cb113-1046" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(Cohort, <span class="fu">desc</span>(Rate)) <span class="sc">|&gt;</span></span>
<span id="cb113-1047"><a href="#cb113-1047" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb113-1048"><a href="#cb113-1048" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make a table</span></span>
<span id="cb113-1049"><a href="#cb113-1049" aria-hidden="true" tabindex="-1"></a>    <span class="fu">reactable</span>(</span>
<span id="cb113-1050"><a href="#cb113-1050" aria-hidden="true" tabindex="-1"></a>      <span class="at">groupBy =</span> <span class="st">"Cohort"</span>,</span>
<span id="cb113-1051"><a href="#cb113-1051" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> </span>
<span id="cb113-1052"><a href="#cb113-1052" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(</span>
<span id="cb113-1053"><a href="#cb113-1053" aria-hidden="true" tabindex="-1"></a>          <span class="at">Factor =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Risk Factor"</span>),</span>
<span id="cb113-1054"><a href="#cb113-1054" aria-hidden="true" tabindex="-1"></a>          <span class="at">N =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Discharge Count"</span>),</span>
<span id="cb113-1055"><a href="#cb113-1055" aria-hidden="true" tabindex="-1"></a>          <span class="at">Count =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Count"</span>),</span>
<span id="cb113-1056"><a href="#cb113-1056" aria-hidden="true" tabindex="-1"></a>          <span class="at">Rate =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Percent"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">1</span>, <span class="at">percent =</span> <span class="cn">TRUE</span>))</span>
<span id="cb113-1057"><a href="#cb113-1057" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb113-1058"><a href="#cb113-1058" aria-hidden="true" tabindex="-1"></a>      <span class="at">columnGroups =</span> </span>
<span id="cb113-1059"><a href="#cb113-1059" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(</span>
<span id="cb113-1060"><a href="#cb113-1060" aria-hidden="true" tabindex="-1"></a>          <span class="fu">colGroup</span>(</span>
<span id="cb113-1061"><a href="#cb113-1061" aria-hidden="true" tabindex="-1"></a>            <span class="at">name =</span> <span class="st">"Risk Factor Prevalence"</span>,</span>
<span id="cb113-1062"><a href="#cb113-1062" aria-hidden="true" tabindex="-1"></a>            <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Count"</span>, <span class="st">"Rate"</span>)</span>
<span id="cb113-1063"><a href="#cb113-1063" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb113-1064"><a href="#cb113-1064" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb113-1065"><a href="#cb113-1065" aria-hidden="true" tabindex="-1"></a>      <span class="at">searchable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb113-1066"><a href="#cb113-1066" aria-hidden="true" tabindex="-1"></a>      <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb113-1067"><a href="#cb113-1067" aria-hidden="true" tabindex="-1"></a>      <span class="at">filterable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb113-1068"><a href="#cb113-1068" aria-hidden="true" tabindex="-1"></a>      <span class="at">resizable =</span> <span class="cn">TRUE</span></span>
<span id="cb113-1069"><a href="#cb113-1069" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb113-1070"><a href="#cb113-1070" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1071"><a href="#cb113-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1072"><a href="#cb113-1072" aria-hidden="true" tabindex="-1"></a><span class="fu">### Net Factor Influence</span></span>
<span id="cb113-1073"><a href="#cb113-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1074"><a href="#cb113-1074" aria-hidden="true" tabindex="-1"></a>We can then combine the two concepts above (model weights + risk factor prevalence) to explore which factors may have the most overall impact. One way to quantify this is by computing the total weight of a risk factor by taking the number of patients with the risk factor multiplied by the model weight.</span>
<span id="cb113-1075"><a href="#cb113-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1078"><a href="#cb113-1078" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-1079"><a href="#cb113-1079" aria-hidden="true" tabindex="-1"></a>prevalence <span class="sc">|&gt;</span></span>
<span id="cb113-1080"><a href="#cb113-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1081"><a href="#cb113-1081" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join to get model weight</span></span>
<span id="cb113-1082"><a href="#cb113-1082" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb113-1083"><a href="#cb113-1083" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> model_weights,</span>
<span id="cb113-1084"><a href="#cb113-1084" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> </span>
<span id="cb113-1085"><a href="#cb113-1085" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(</span>
<span id="cb113-1086"><a href="#cb113-1086" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Cohort"</span>,</span>
<span id="cb113-1087"><a href="#cb113-1087" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Factor"</span></span>
<span id="cb113-1088"><a href="#cb113-1088" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb113-1089"><a href="#cb113-1089" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb113-1090"><a href="#cb113-1090" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-1091"><a href="#cb113-1091" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make total weight</span></span>
<span id="cb113-1092"><a href="#cb113-1092" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb113-1093"><a href="#cb113-1093" aria-hidden="true" tabindex="-1"></a>    <span class="at">NetImpact =</span> <span class="fu">abs</span>(Count <span class="sc">*</span> Value)</span>
<span id="cb113-1094"><a href="#cb113-1094" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb113-1095"><a href="#cb113-1095" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-1096"><a href="#cb113-1096" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arrange</span></span>
<span id="cb113-1097"><a href="#cb113-1097" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(Cohort, <span class="fu">desc</span>(NetImpact)) <span class="sc">|&gt;</span></span>
<span id="cb113-1098"><a href="#cb113-1098" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(NetImpact, <span class="at">.after =</span> Factor) <span class="sc">|&gt;</span></span>
<span id="cb113-1099"><a href="#cb113-1099" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb113-1100"><a href="#cb113-1100" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make a table</span></span>
<span id="cb113-1101"><a href="#cb113-1101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reactable</span>(</span>
<span id="cb113-1102"><a href="#cb113-1102" aria-hidden="true" tabindex="-1"></a>    <span class="at">groupBy =</span> <span class="st">"Cohort"</span>,</span>
<span id="cb113-1103"><a href="#cb113-1103" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> </span>
<span id="cb113-1104"><a href="#cb113-1104" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb113-1105"><a href="#cb113-1105" aria-hidden="true" tabindex="-1"></a>        <span class="at">Factor =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Risk Factor"</span>),</span>
<span id="cb113-1106"><a href="#cb113-1106" aria-hidden="true" tabindex="-1"></a>        <span class="at">NetImpact =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Net Impact"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">2</span>)),</span>
<span id="cb113-1107"><a href="#cb113-1107" aria-hidden="true" tabindex="-1"></a>        <span class="at">N =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Discharge Count"</span>),</span>
<span id="cb113-1108"><a href="#cb113-1108" aria-hidden="true" tabindex="-1"></a>        <span class="at">Count =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Count"</span>),</span>
<span id="cb113-1109"><a href="#cb113-1109" aria-hidden="true" tabindex="-1"></a>        <span class="at">Rate =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Percent"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">1</span>, <span class="at">percent =</span> <span class="cn">TRUE</span>))</span>
<span id="cb113-1110"><a href="#cb113-1110" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb113-1111"><a href="#cb113-1111" aria-hidden="true" tabindex="-1"></a>    <span class="at">columnGroups =</span> </span>
<span id="cb113-1112"><a href="#cb113-1112" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb113-1113"><a href="#cb113-1113" aria-hidden="true" tabindex="-1"></a>        <span class="fu">colGroup</span>(</span>
<span id="cb113-1114"><a href="#cb113-1114" aria-hidden="true" tabindex="-1"></a>          <span class="at">name =</span> <span class="st">"Risk Factor Prevalence"</span>,</span>
<span id="cb113-1115"><a href="#cb113-1115" aria-hidden="true" tabindex="-1"></a>          <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Count"</span>, <span class="st">"Rate"</span>)</span>
<span id="cb113-1116"><a href="#cb113-1116" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb113-1117"><a href="#cb113-1117" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb113-1118"><a href="#cb113-1118" aria-hidden="true" tabindex="-1"></a>    <span class="at">searchable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb113-1119"><a href="#cb113-1119" aria-hidden="true" tabindex="-1"></a>    <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb113-1120"><a href="#cb113-1120" aria-hidden="true" tabindex="-1"></a>    <span class="at">filterable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb113-1121"><a href="#cb113-1121" aria-hidden="true" tabindex="-1"></a>    <span class="at">resizable =</span> <span class="cn">TRUE</span></span>
<span id="cb113-1122"><a href="#cb113-1122" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb113-1123"><a href="#cb113-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1124"><a href="#cb113-1124" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1125"><a href="#cb113-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1126"><a href="#cb113-1126" aria-hidden="true" tabindex="-1"></a>If you scan through the table you'll notice that the risk factors that have the highest model weight or highest prevalence are not necessarily the ones with the most net impact.</span>
<span id="cb113-1127"><a href="#cb113-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1128"><a href="#cb113-1128" aria-hidden="true" tabindex="-1"></a>Finally, we could put these in a plot:</span>
<span id="cb113-1129"><a href="#cb113-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1132"><a href="#cb113-1132" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-1133"><a href="#cb113-1133" aria-hidden="true" tabindex="-1"></a>prevalence <span class="sc">|&gt;</span></span>
<span id="cb113-1134"><a href="#cb113-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1135"><a href="#cb113-1135" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join to get model weight</span></span>
<span id="cb113-1136"><a href="#cb113-1136" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb113-1137"><a href="#cb113-1137" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> model_weights,</span>
<span id="cb113-1138"><a href="#cb113-1138" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> </span>
<span id="cb113-1139"><a href="#cb113-1139" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(</span>
<span id="cb113-1140"><a href="#cb113-1140" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Cohort"</span>,</span>
<span id="cb113-1141"><a href="#cb113-1141" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Factor"</span></span>
<span id="cb113-1142"><a href="#cb113-1142" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb113-1143"><a href="#cb113-1143" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb113-1144"><a href="#cb113-1144" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-1145"><a href="#cb113-1145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb113-1146"><a href="#cb113-1146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb113-1147"><a href="#cb113-1147" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb113-1148"><a href="#cb113-1148" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> Count,</span>
<span id="cb113-1149"><a href="#cb113-1149" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">exp</span>(Value),</span>
<span id="cb113-1150"><a href="#cb113-1150" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> Cohort</span>
<span id="cb113-1151"><a href="#cb113-1151" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb113-1152"><a href="#cb113-1152" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb113-1153"><a href="#cb113-1153" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb113-1154"><a href="#cb113-1154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb113-1155"><a href="#cb113-1155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Cohort, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">nrow =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb113-1156"><a href="#cb113-1156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb113-1157"><a href="#cb113-1157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Risk Factor Count"</span>) <span class="sc">+</span></span>
<span id="cb113-1158"><a href="#cb113-1158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Odds Ratio"</span>) </span>
<span id="cb113-1159"><a href="#cb113-1159" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1160"><a href="#cb113-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1161"><a href="#cb113-1161" aria-hidden="true" tabindex="-1"></a>Points that are closer to the upper-right quadrant are the most influential. Of course, it would be useful to add interactivity to these plots (e.g., with <span class="in">`plotly`</span>) as to provide the user ability to scan and view what risk factor each point represents, but you get the idea.</span>
<span id="cb113-1162"><a href="#cb113-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1163"><a href="#cb113-1163" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3. Other Analyses</span></span>
<span id="cb113-1164"><a href="#cb113-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1165"><a href="#cb113-1165" aria-hidden="true" tabindex="-1"></a>There are many other possible questions that can be answered analyzing an HSR that can be useful for better understand HRRP program results. We'll list a few more ideas here without actually doing them:</span>
<span id="cb113-1166"><a href="#cb113-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1167"><a href="#cb113-1167" aria-hidden="true" tabindex="-1"></a><span class="fu">### Diagnosis Comparison</span></span>
<span id="cb113-1168"><a href="#cb113-1168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1169"><a href="#cb113-1169" aria-hidden="true" tabindex="-1"></a>In the discharge reports, CMS supplies the diagnosis code the patient received that led their index discharge to be included in the program. For those who are readmitted, also supplied in this table are the diagnosis codes received at their readmission stay. These can be accessed with the <span class="in">`hsr_discharges()`</span> function and extracting the appropriate columns. Here's an example doing this for the HF cohort:</span>
<span id="cb113-1170"><a href="#cb113-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1173"><a href="#cb113-1173" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-1174"><a href="#cb113-1174" aria-hidden="true" tabindex="-1"></a><span class="fu">hsr_discharges</span>(</span>
<span id="cb113-1175"><a href="#cb113-1175" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> my_report,</span>
<span id="cb113-1176"><a href="#cb113-1176" aria-hidden="true" tabindex="-1"></a>  <span class="at">cohort =</span> <span class="st">"HF"</span>,</span>
<span id="cb113-1177"><a href="#cb113-1177" aria-hidden="true" tabindex="-1"></a>  <span class="at">eligible_only =</span> <span class="cn">TRUE</span></span>
<span id="cb113-1178"><a href="#cb113-1178" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb113-1179"><a href="#cb113-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1180"><a href="#cb113-1180" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Keep diagnosis columns</span></span>
<span id="cb113-1181"><a href="#cb113-1181" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(dplyr<span class="sc">::</span><span class="fu">matches</span>(<span class="st">"Diagnosis"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb113-1182"><a href="#cb113-1182" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-1183"><a href="#cb113-1183" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Aggregate</span></span>
<span id="cb113-1184"><a href="#cb113-1184" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(</span>
<span id="cb113-1185"><a href="#cb113-1185" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="cb113-1186"><a href="#cb113-1186" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> dplyr<span class="sc">::</span><span class="fu">everything</span>()</span>
<span id="cb113-1187"><a href="#cb113-1187" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb113-1188"><a href="#cb113-1188" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(N))</span>
<span id="cb113-1189"><a href="#cb113-1189" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1190"><a href="#cb113-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1191"><a href="#cb113-1191" aria-hidden="true" tabindex="-1"></a>This can be extremely useful to understand (a) which diagnoses are leading to cohort inclusion to begin with, and (b) why the patient came back. Sometimes there may be readmissions that are completely unrelated to the index diagnosis. </span>
<span id="cb113-1192"><a href="#cb113-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1193"><a href="#cb113-1193" aria-hidden="true" tabindex="-1"></a><span class="fu">### Outside Hospital Readmissions</span></span>
<span id="cb113-1194"><a href="#cb113-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1195"><a href="#cb113-1195" aria-hidden="true" tabindex="-1"></a>Since CMS enforces the HRRP, hospitals get penalized for readmissions that don't even occur at their hospital. If a patient is discharged from your hospital and subsequently readmitted somewhere else, it still counts as _your_ readmission. Thus it is useful to understand the rate of readmissions that are back in your own system versus somewhere else. This is provided the HSR as well.</span>
<span id="cb113-1196"><a href="#cb113-1196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1199"><a href="#cb113-1199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-1200"><a href="#cb113-1200" aria-hidden="true" tabindex="-1"></a><span class="fu">hsr_discharges</span>(</span>
<span id="cb113-1201"><a href="#cb113-1201" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> my_report,</span>
<span id="cb113-1202"><a href="#cb113-1202" aria-hidden="true" tabindex="-1"></a>  <span class="at">cohort =</span> <span class="st">"HF"</span>,</span>
<span id="cb113-1203"><a href="#cb113-1203" aria-hidden="true" tabindex="-1"></a>  <span class="at">eligible_only =</span> <span class="cn">TRUE</span></span>
<span id="cb113-1204"><a href="#cb113-1204" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb113-1205"><a href="#cb113-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1206"><a href="#cb113-1206" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Keep diagnosis columns</span></span>
<span id="cb113-1207"><a href="#cb113-1207" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(dplyr<span class="sc">::</span><span class="fu">matches</span>(<span class="st">"Same Hospital"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb113-1208"><a href="#cb113-1208" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-1209"><a href="#cb113-1209" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make a table</span></span>
<span id="cb113-1210"><a href="#cb113-1210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>(<span class="at">useNA =</span> <span class="st">"ifany"</span>)</span>
<span id="cb113-1211"><a href="#cb113-1211" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1212"><a href="#cb113-1212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1213"><a href="#cb113-1213" aria-hidden="true" tabindex="-1"></a>For example, of the 22 HF discharges, three (3) were readmitted: one (1) to the same hospital as the index stay, and two (2) elsewhere (maybe within your system, or not).</span>
<span id="cb113-1214"><a href="#cb113-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1215"><a href="#cb113-1215" aria-hidden="true" tabindex="-1"></a><span class="fu">### Benchmarking With Other Hospitals</span></span>
<span id="cb113-1216"><a href="#cb113-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1217"><a href="#cb113-1217" aria-hidden="true" tabindex="-1"></a>CMS provides access to hospital-level performance data on <span class="co">[</span><span class="ot">QualityNet</span><span class="co">](https://data.cms.gov/provider-data/)</span>. You can use the <span class="in">`pdc_*`</span> functions in this package to explore and import various data files to perform comparative analyses at the hospital level (see <span class="in">`pdc_read()`</span>).</span>
<span id="cb113-1218"><a href="#cb113-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1219"><a href="#cb113-1219" aria-hidden="true" tabindex="-1"></a>_Don't forget to [subscribe](https://dashboard.mailerlite.com/forms/1517199/154300987644839168/share) to receive email updates when new articles drop!_</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>© 2025 Zajichek Stats</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>