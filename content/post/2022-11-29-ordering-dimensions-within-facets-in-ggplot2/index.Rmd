---
title: Ordering dimensions within facets with {ggplot2}
subtitle: A look at Medicare spending in WI counties
author: R package build
date: '2022-11-29'
slug: ordering-dimensions-within-facets-in-ggplot2
categories: []
tags: []
summary: ''
authors: []
lastmod: '2022-11-29T11:09:28-06:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
---

**In progress**

Over the years I've found myself frequently wanting to rank a dimension _within_ facets in a single [`ggplot`](https://ggplot2.tidyverse.org/). The `reorder_within` function (a [`ggplot`](https://ggplot2.tidyverse.org/) add-on) is a hidden gem within the [`tidytext`](https://cran.r-project.org/web/packages/tidytext/index.html) package and has been my go-to solution for this task. This article goes through an example of creating such a plot for Medicare spending in Wisconsin counties. First, lets load some packages:

```{r}
require(tidyverse)
```

# Table of Contents

* [Building the dataset](#buildingthedataset)
  1. [Import Medicare spending data](#extractspending)
  2. [Retrieve hospital counties](#extracthospital)
  3. [Synthesize for plotting](#synthesize)

# Building the dataset {#buildingthedataset}

The objective here is going to be to display the top and bottom five (5) Wisconsin counties in terms of relative [Medicare](https://www.cms.gov/) hospital spending for a few different types of claims. The source for all data used is the [CMS Provider Data Catalog](https://data.cms.gov/provider-data/).

## 1. Import Medicare spending data {#extractspending}

The core dataset (described [here](https://data.cms.gov/provider-data/dataset/nrth-mfg3)) contains a listing of Medicare spending for U.S. hospitals by various claim types. We can import it directly with [`readr::read_csv`](https://readr.tidyverse.org/reference/read_delim.html):

```{r}
# Link copied from 'Download full dataset'
medicare_spend <-
  read_csv(
    file = "https://data.cms.gov/provider-data/sites/default/files/resources/baae89c939191d1ccb76feb4f9382234_1665414667/Medicare_Hospital_Spending_by_Claim.csv"
  )
medicare_spend
```

## 2. Retrieve hospital counties {#extracthospital}

The county that the hospital resides is not located in the [spending file](#extractspending). Therefore, we'll need an additional look-up table (described [here](https://data.cms.gov/provider-data/dataset/xubh-q36u)) containing that field.

```{r}
# Link copied from 'Download full dataset'
hospital_information <-
  read_csv(
    file = "https://data.cms.gov/provider-data/sites/default/files/resources/092256becd267d9eeccf73bf7d16c46b_1666224317/Hospital_General_Information.csv"
  )
hospital_information
```

## 3. Synthesize for plotting {#synthesize}

We have all of the data elements we need. We'll just need to get them into plot-ready format by taking the following steps:

1. Filter to Wisconsin hospitals, keeping the County of residence for the hospital
2. 



